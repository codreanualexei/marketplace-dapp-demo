{"ast":null,"code":"import _objectSpread from \"/Users/alex.codreanu/Desktop/marketplace-dapp/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";\nimport { proxy, ref, snapshot, subscribe as sub } from 'valtio/vanilla';\nimport { subscribeKey as subKey } from 'valtio/vanilla/utils';\nimport { AVAILABLE_NAMESPACES, ConstantsUtil, getW3mThemeVariables } from '@reown/appkit-common';\nimport { W3mFrameRpcConstants } from '@reown/appkit-wallet/utils';\nimport { getPreferredAccountType } from '../utils/ChainControllerUtil.js';\nimport { MobileWalletUtil } from '../utils/MobileWallet.js';\nimport { StorageUtil } from '../utils/StorageUtil.js';\nimport { withErrorBoundary } from '../utils/withErrorBoundary.js';\nimport { ApiController } from './ApiController.js';\nimport { ChainController } from './ChainController.js';\nimport { OptionsController } from './OptionsController.js';\nimport { RouterController } from './RouterController.js';\nimport { ThemeController } from './ThemeController.js';\nconst defaultActiveConnectors = Object.fromEntries(AVAILABLE_NAMESPACES.map(namespace => [namespace, undefined]));\nconst defaultFilterByNamespaceMap = Object.fromEntries(AVAILABLE_NAMESPACES.map(namespace => [namespace, true]));\n// -- State --------------------------------------------- //\nconst state = proxy({\n  allConnectors: [],\n  connectors: [],\n  activeConnector: undefined,\n  filterByNamespace: undefined,\n  activeConnectorIds: defaultActiveConnectors,\n  filterByNamespaceMap: defaultFilterByNamespaceMap\n});\n// -- Controller ---------------------------------------- //\nconst controller = {\n  state,\n  subscribe(callback) {\n    return sub(state, () => {\n      callback(state);\n    });\n  },\n  subscribeKey(key, callback) {\n    return subKey(state, key, callback);\n  },\n  initialize(namespaces) {\n    namespaces.forEach(namespace => {\n      const connectorId = StorageUtil.getConnectedConnectorId(namespace);\n      if (connectorId) {\n        ConnectorController.setConnectorId(connectorId, namespace);\n      }\n    });\n  },\n  setActiveConnector(connector) {\n    if (connector) {\n      state.activeConnector = ref(connector);\n    }\n  },\n  setConnectors(connectors) {\n    const newConnectors = connectors.filter(newConnector => !state.allConnectors.some(existingConnector => existingConnector.id === newConnector.id && ConnectorController.getConnectorName(existingConnector.name) === ConnectorController.getConnectorName(newConnector.name) && existingConnector.chain === newConnector.chain));\n    /**\n     * We are reassigning the state of the proxy to a new array of new objects, ConnectorController can cause issues. So it is better to use ref in ConnectorController case.\n     * Check more about proxy on https://valtio.dev/docs/api/basic/proxy#Gotchas\n     * Check more about ref on https://valtio.dev/docs/api/basic/ref\n     */\n    newConnectors.forEach(connector => {\n      if (connector.type !== 'MULTI_CHAIN') {\n        state.allConnectors.push(ref(connector));\n      }\n    });\n    const enabledNamespaces = ConnectorController.getEnabledNamespaces();\n    const connectorsFilteredByNamespaces = ConnectorController.getEnabledConnectors(enabledNamespaces);\n    state.connectors = ConnectorController.mergeMultiChainConnectors(connectorsFilteredByNamespaces);\n  },\n  filterByNamespaces(enabledNamespaces) {\n    Object.keys(state.filterByNamespaceMap).forEach(namespace => {\n      state.filterByNamespaceMap[namespace] = false;\n    });\n    enabledNamespaces.forEach(namespace => {\n      state.filterByNamespaceMap[namespace] = true;\n    });\n    ConnectorController.updateConnectorsForEnabledNamespaces();\n  },\n  filterByNamespace(namespace, enabled) {\n    state.filterByNamespaceMap[namespace] = enabled;\n    ConnectorController.updateConnectorsForEnabledNamespaces();\n  },\n  updateConnectorsForEnabledNamespaces() {\n    const enabledNamespaces = ConnectorController.getEnabledNamespaces();\n    const enabledConnectors = ConnectorController.getEnabledConnectors(enabledNamespaces);\n    const areAllNamespacesEnabled = ConnectorController.areAllNamespacesEnabled();\n    state.connectors = ConnectorController.mergeMultiChainConnectors(enabledConnectors);\n    if (areAllNamespacesEnabled) {\n      ApiController.clearFilterByNamespaces();\n    } else {\n      ApiController.filterByNamespaces(enabledNamespaces);\n    }\n  },\n  getEnabledNamespaces() {\n    return Object.entries(state.filterByNamespaceMap).filter(_ref => {\n      let [_, enabled] = _ref;\n      return enabled;\n    }).map(_ref2 => {\n      let [namespace] = _ref2;\n      return namespace;\n    });\n  },\n  getEnabledConnectors(enabledNamespaces) {\n    return state.allConnectors.filter(connector => enabledNamespaces.includes(connector.chain));\n  },\n  areAllNamespacesEnabled() {\n    return Object.values(state.filterByNamespaceMap).every(enabled => enabled);\n  },\n  mergeMultiChainConnectors(connectors) {\n    const connectorsByNameMap = ConnectorController.generateConnectorMapByName(connectors);\n    const mergedConnectors = [];\n    connectorsByNameMap.forEach(keyConnectors => {\n      const firstItem = keyConnectors[0];\n      const isAuthConnector = (firstItem === null || firstItem === void 0 ? void 0 : firstItem.id) === ConstantsUtil.CONNECTOR_ID.AUTH;\n      if (keyConnectors.length > 1 && firstItem) {\n        mergedConnectors.push({\n          name: firstItem.name,\n          imageUrl: firstItem.imageUrl,\n          imageId: firstItem.imageId,\n          connectors: [...keyConnectors],\n          type: isAuthConnector ? 'AUTH' : 'MULTI_CHAIN',\n          // These values are just placeholders, we don't use them in multi-chain connector select screen\n          chain: 'eip155',\n          id: (firstItem === null || firstItem === void 0 ? void 0 : firstItem.id) || ''\n        });\n      } else if (firstItem) {\n        mergedConnectors.push(firstItem);\n      }\n    });\n    return mergedConnectors;\n  },\n  generateConnectorMapByName(connectors) {\n    const connectorsByNameMap = new Map();\n    connectors.forEach(connector => {\n      const {\n        name\n      } = connector;\n      const connectorName = ConnectorController.getConnectorName(name);\n      if (!connectorName) {\n        return;\n      }\n      const connectorsByName = connectorsByNameMap.get(connectorName) || [];\n      const haveSameConnector = connectorsByName.find(c => c.chain === connector.chain);\n      if (!haveSameConnector) {\n        connectorsByName.push(connector);\n      }\n      connectorsByNameMap.set(connectorName, connectorsByName);\n    });\n    return connectorsByNameMap;\n  },\n  getConnectorName(name) {\n    if (!name) {\n      return name;\n    }\n    const nameOverrideMap = {\n      'Trust Wallet': 'Trust'\n    };\n    return nameOverrideMap[name] || name;\n  },\n  getUniqueConnectorsByName(connectors) {\n    const uniqueConnectors = [];\n    connectors.forEach(c => {\n      if (!uniqueConnectors.find(uc => uc.chain === c.chain)) {\n        uniqueConnectors.push(c);\n      }\n    });\n    return uniqueConnectors;\n  },\n  addConnector(connector) {\n    if (connector.id === ConstantsUtil.CONNECTOR_ID.AUTH) {\n      var _authConnector$provid, _authConnector$provid2, _authConnector$provid3;\n      const authConnector = connector;\n      const optionsState = snapshot(OptionsController.state);\n      const themeMode = ThemeController.getSnapshot().themeMode;\n      const themeVariables = ThemeController.getSnapshot().themeVariables;\n      authConnector === null || authConnector === void 0 || (_authConnector$provid = authConnector.provider) === null || _authConnector$provid === void 0 || (_authConnector$provid2 = _authConnector$provid.syncDappData) === null || _authConnector$provid2 === void 0 || _authConnector$provid2.call(_authConnector$provid, {\n        metadata: optionsState.metadata,\n        sdkVersion: optionsState.sdkVersion,\n        projectId: optionsState.projectId,\n        sdkType: optionsState.sdkType\n      });\n      authConnector === null || authConnector === void 0 || (_authConnector$provid3 = authConnector.provider) === null || _authConnector$provid3 === void 0 || _authConnector$provid3.syncTheme({\n        themeMode,\n        themeVariables,\n        w3mThemeVariables: getW3mThemeVariables(themeVariables, themeMode)\n      });\n      ConnectorController.setConnectors([connector]);\n    } else {\n      ConnectorController.setConnectors([connector]);\n    }\n  },\n  getAuthConnector(chainNamespace) {\n    var _authConnector$connec;\n    const activeNamespace = chainNamespace || ChainController.state.activeChain;\n    const authConnector = state.connectors.find(c => c.id === ConstantsUtil.CONNECTOR_ID.AUTH);\n    if (!authConnector) {\n      return undefined;\n    }\n    if (authConnector !== null && authConnector !== void 0 && (_authConnector$connec = authConnector.connectors) !== null && _authConnector$connec !== void 0 && _authConnector$connec.length) {\n      const connector = authConnector.connectors.find(c => c.chain === activeNamespace);\n      return connector;\n    }\n    return authConnector;\n  },\n  getAnnouncedConnectorRdns() {\n    return state.connectors.filter(c => c.type === 'ANNOUNCED').map(c => {\n      var _c$info;\n      return (_c$info = c.info) === null || _c$info === void 0 ? void 0 : _c$info.rdns;\n    });\n  },\n  getConnectorById(id) {\n    return state.allConnectors.find(c => c.id === id);\n  },\n  getConnector(_ref3) {\n    let {\n      id,\n      rdns,\n      namespace\n    } = _ref3;\n    const namespaceToUse = namespace || ChainController.state.activeChain;\n    const connectorsByNamespace = state.allConnectors.filter(c => c.chain === namespaceToUse);\n    return connectorsByNamespace.find(c => {\n      var _c$info2;\n      return c.explorerId === id || ((_c$info2 = c.info) === null || _c$info2 === void 0 ? void 0 : _c$info2.rdns) === rdns;\n    });\n  },\n  syncIfAuthConnector(connector) {\n    var _authConnector$provid4, _authConnector$provid5;\n    if (connector.id !== 'ID_AUTH') {\n      return;\n    }\n    const authConnector = connector;\n    const optionsState = snapshot(OptionsController.state);\n    const themeMode = ThemeController.getSnapshot().themeMode;\n    const themeVariables = ThemeController.getSnapshot().themeVariables;\n    authConnector === null || authConnector === void 0 || (_authConnector$provid4 = authConnector.provider) === null || _authConnector$provid4 === void 0 || (_authConnector$provid5 = _authConnector$provid4.syncDappData) === null || _authConnector$provid5 === void 0 || _authConnector$provid5.call(_authConnector$provid4, {\n      metadata: optionsState.metadata,\n      sdkVersion: optionsState.sdkVersion,\n      sdkType: optionsState.sdkType,\n      projectId: optionsState.projectId\n    });\n    authConnector.provider.syncTheme({\n      themeMode,\n      themeVariables,\n      w3mThemeVariables: getW3mThemeVariables(themeVariables, themeMode)\n    });\n  },\n  /**\n   * Returns the connectors filtered by namespace.\n   * @param namespace - The namespace to filter the connectors by.\n   * @returns ConnectorWithProviders[].\n   */\n  getConnectorsByNamespace(namespace) {\n    const namespaceConnectors = state.allConnectors.filter(connector => connector.chain === namespace);\n    return ConnectorController.mergeMultiChainConnectors(namespaceConnectors);\n  },\n  canSwitchToSmartAccount(namespace) {\n    const isSmartAccountEnabled = ChainController.checkIfSmartAccountEnabled();\n    return isSmartAccountEnabled && getPreferredAccountType(namespace) === W3mFrameRpcConstants.ACCOUNT_TYPES.EOA;\n  },\n  selectWalletConnector(wallet) {\n    var _RouterController$sta;\n    const redirectView = (_RouterController$sta = RouterController.state.data) === null || _RouterController$sta === void 0 ? void 0 : _RouterController$sta.redirectView;\n    const connector = ConnectorController.getConnector({\n      id: wallet.id,\n      rdns: wallet.rdns\n    });\n    MobileWalletUtil.handleMobileDeeplinkRedirect((connector === null || connector === void 0 ? void 0 : connector.explorerId) || wallet.id, ChainController.state.activeChain);\n    if (connector) {\n      RouterController.push('ConnectingExternal', {\n        connector,\n        wallet,\n        redirectView\n      });\n    } else {\n      RouterController.push('ConnectingWalletConnect', {\n        wallet,\n        redirectView\n      });\n    }\n  },\n  /**\n   * Returns the connectors. If a namespace is provided, the connectors are filtered by namespace.\n   * @param namespace - The namespace to filter the connectors by. If not provided, all connectors are returned.\n   * @returns ConnectorWithProviders[].\n   */\n  getConnectors(namespace) {\n    if (namespace) {\n      return ConnectorController.getConnectorsByNamespace(namespace);\n    }\n    return ConnectorController.mergeMultiChainConnectors(state.allConnectors);\n  },\n  /**\n   * Sets the filter by namespace and updates the connectors.\n   * @param namespace - The namespace to filter the connectors by.\n   */\n  setFilterByNamespace(namespace) {\n    state.filterByNamespace = namespace;\n    state.connectors = ConnectorController.getConnectors(namespace);\n    ApiController.setFilterByNamespace(namespace);\n  },\n  setConnectorId(connectorId, namespace) {\n    if (connectorId) {\n      state.activeConnectorIds = _objectSpread(_objectSpread({}, state.activeConnectorIds), {}, {\n        [namespace]: connectorId\n      });\n      StorageUtil.setConnectedConnectorId(namespace, connectorId);\n    }\n  },\n  removeConnectorId(namespace) {\n    state.activeConnectorIds = _objectSpread(_objectSpread({}, state.activeConnectorIds), {}, {\n      [namespace]: undefined\n    });\n    StorageUtil.deleteConnectedConnectorId(namespace);\n  },\n  getConnectorId(namespace) {\n    if (!namespace) {\n      return undefined;\n    }\n    return state.activeConnectorIds[namespace];\n  },\n  isConnected(namespace) {\n    if (!namespace) {\n      return Object.values(state.activeConnectorIds).some(id => Boolean(id));\n    }\n    return Boolean(state.activeConnectorIds[namespace]);\n  },\n  resetConnectorIds() {\n    state.activeConnectorIds = _objectSpread({}, defaultActiveConnectors);\n  }\n};\n// Export the controller wrapped with our error boundary\nexport const ConnectorController = withErrorBoundary(controller);","map":{"version":3,"names":["proxy","ref","snapshot","subscribe","sub","subscribeKey","subKey","AVAILABLE_NAMESPACES","ConstantsUtil","getW3mThemeVariables","W3mFrameRpcConstants","getPreferredAccountType","MobileWalletUtil","StorageUtil","withErrorBoundary","ApiController","ChainController","OptionsController","RouterController","ThemeController","defaultActiveConnectors","Object","fromEntries","map","namespace","undefined","defaultFilterByNamespaceMap","state","allConnectors","connectors","activeConnector","filterByNamespace","activeConnectorIds","filterByNamespaceMap","controller","callback","key","initialize","namespaces","forEach","connectorId","getConnectedConnectorId","ConnectorController","setConnectorId","setActiveConnector","connector","setConnectors","newConnectors","filter","newConnector","some","existingConnector","id","getConnectorName","name","chain","type","push","enabledNamespaces","getEnabledNamespaces","connectorsFilteredByNamespaces","getEnabledConnectors","mergeMultiChainConnectors","filterByNamespaces","keys","updateConnectorsForEnabledNamespaces","enabled","enabledConnectors","areAllNamespacesEnabled","clearFilterByNamespaces","entries","_ref","_","_ref2","includes","values","every","connectorsByNameMap","generateConnectorMapByName","mergedConnectors","keyConnectors","firstItem","isAuthConnector","CONNECTOR_ID","AUTH","length","imageUrl","imageId","Map","connectorName","connectorsByName","get","haveSameConnector","find","c","set","nameOverrideMap","getUniqueConnectorsByName","uniqueConnectors","uc","addConnector","_authConnector$provid","_authConnector$provid2","_authConnector$provid3","authConnector","optionsState","themeMode","getSnapshot","themeVariables","provider","syncDappData","call","metadata","sdkVersion","projectId","sdkType","syncTheme","w3mThemeVariables","getAuthConnector","chainNamespace","_authConnector$connec","activeNamespace","activeChain","getAnnouncedConnectorRdns","_c$info","info","rdns","getConnectorById","getConnector","_ref3","namespaceToUse","connectorsByNamespace","_c$info2","explorerId","syncIfAuthConnector","_authConnector$provid4","_authConnector$provid5","getConnectorsByNamespace","namespaceConnectors","canSwitchToSmartAccount","isSmartAccountEnabled","checkIfSmartAccountEnabled","ACCOUNT_TYPES","EOA","selectWalletConnector","wallet","_RouterController$sta","redirectView","data","handleMobileDeeplinkRedirect","getConnectors","setFilterByNamespace","_objectSpread","setConnectedConnectorId","removeConnectorId","deleteConnectedConnectorId","getConnectorId","isConnected","Boolean","resetConnectorIds"],"sources":["../../../../src/controllers/ConnectorController.ts"],"sourcesContent":[null],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}