{"ast":null,"code":"import '@reown/appkit-common';\nimport { ConnectionController } from '../controllers/ConnectionController.js';\nimport { ConnectorController } from '../controllers/ConnectorController.js';\nimport { OptionsController } from '../controllers/OptionsController.js';\n// -- Utils ------------------------------------------ //\nexport const ConnectionControllerUtil = {\n  getConnectionStatus(connection, namespace) {\n    const connectedConnectorId = ConnectorController.state.activeConnectorIds[namespace];\n    const connections = ConnectionController.getConnections(namespace);\n    const isConnectorConnected = Boolean(connectedConnectorId) && connection.connectorId === connectedConnectorId;\n    if (isConnectorConnected) {\n      return 'connected';\n    }\n    const isConnectionConnected = connections.some(c => c.connectorId.toLowerCase() === connection.connectorId.toLowerCase());\n    if (isConnectionConnected) {\n      return 'active';\n    }\n    return 'disconnected';\n  },\n  excludeConnectorAddressFromConnections({\n    connections,\n    connectorId,\n    addresses\n  }) {\n    return connections.map(connection => {\n      const isConnectorMatch = connectorId ? connection.connectorId.toLowerCase() === connectorId.toLowerCase() : false;\n      if (isConnectorMatch && addresses) {\n        const filteredAccounts = connection.accounts.filter(account => {\n          const isAddressIncluded = addresses.some(address => address.toLowerCase() === account.address.toLowerCase());\n          return !isAddressIncluded;\n        });\n        return {\n          ...connection,\n          accounts: filteredAccounts\n        };\n      }\n      return connection;\n    });\n  },\n  excludeExistingConnections(connectorIds, newConnections) {\n    const existingConnectorIds = new Set(connectorIds);\n    return newConnections.filter(c => !existingConnectorIds.has(c.connectorId));\n  },\n  getConnectionsByConnectorId(connections, connectorId) {\n    return connections.filter(c => c.connectorId.toLowerCase() === connectorId.toLowerCase());\n  },\n  getConnectionsData(namespace) {\n    const isMultiWalletEnabled = Boolean(OptionsController.state.remoteFeatures?.multiWallet);\n    const activeConnectorId = ConnectorController.state.activeConnectorIds[namespace];\n    const connections = ConnectionController.getConnections(namespace);\n    const recentConnections = ConnectionController.state.recentConnections.get(namespace) ?? [];\n    const recentConnectionsWithCurrentActiveConnectors = recentConnections.filter(connection => ConnectorController.getConnectorById(connection.connectorId));\n    const dedupedRecentConnections = ConnectionControllerUtil.excludeExistingConnections([...connections.map(c => c.connectorId), ...(activeConnectorId ? [activeConnectorId] : [])], recentConnectionsWithCurrentActiveConnectors);\n    if (!isMultiWalletEnabled) {\n      return {\n        connections: connections.filter(c => c.connectorId.toLowerCase() === activeConnectorId?.toLowerCase()),\n        recentConnections: []\n      };\n    }\n    return {\n      connections,\n      recentConnections: dedupedRecentConnections\n    };\n  }\n};","map":{"version":3,"names":["ConnectionController","ConnectorController","OptionsController","ConnectionControllerUtil","getConnectionStatus","connection","namespace","connectedConnectorId","state","activeConnectorIds","connections","getConnections","isConnectorConnected","Boolean","connectorId","isConnectionConnected","some","c","toLowerCase","excludeConnectorAddressFromConnections","addresses","map","isConnectorMatch","filteredAccounts","accounts","filter","account","isAddressIncluded","address","excludeExistingConnections","connectorIds","newConnections","existingConnectorIds","Set","has","getConnectionsByConnectorId","getConnectionsData","isMultiWalletEnabled","remoteFeatures","multiWallet","activeConnectorId","recentConnections","get","recentConnectionsWithCurrentActiveConnectors","getConnectorById","dedupedRecentConnections"],"sources":["../../../../src/utils/ConnectionControllerUtil.ts"],"sourcesContent":[null],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}