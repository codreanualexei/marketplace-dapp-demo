{"ast":null,"code":"export const fees = {\n  /*\n   * Estimates the fees per gas for a transaction.\n      * If the transaction is to be paid in a token (feeCurrency is present) then the fees\n   * are estimated in the value of the token. Otherwise falls back to the default\n   * estimation by returning null.\n   *\n   * @param params fee estimation function parameters\n   */\n  estimateFeesPerGas: async params => {\n    var _params$request;\n    if (!((_params$request = params.request) !== null && _params$request !== void 0 && _params$request.feeCurrency)) return null;\n    const [gasPrice, maxPriorityFeePerGas] = await Promise.all([estimateFeePerGasInFeeCurrency(params.client, params.request.feeCurrency), estimateMaxPriorityFeePerGasInFeeCurrency(params.client, params.request.feeCurrency)]);\n    // eth_gasPrice for cel2 returns baseFeePerGas + maxPriorityFeePerGas\n    const maxFeePerGas = params.multiply(gasPrice - maxPriorityFeePerGas) + maxPriorityFeePerGas;\n    return {\n      maxFeePerGas,\n      maxPriorityFeePerGas\n    };\n  }\n};\n/*\n * Estimate the fee per gas in the value of the fee token\n\n *\n * @param client - Client to use\n * @param feeCurrency -  Address of a whitelisted fee token\n * @returns The fee per gas in wei in the value of the  fee token\n *\n */\nasync function estimateFeePerGasInFeeCurrency(client, feeCurrency) {\n  const fee = await client.request({\n    method: 'eth_gasPrice',\n    params: [feeCurrency]\n  });\n  return BigInt(fee);\n}\n/*\n * Estimate the max priority fee per gas in the value of the fee token\n\n *\n * @param client - Client to use\n * @param feeCurrency -  Address of a whitelisted fee token\n * @returns The fee per gas in wei in the value of the  fee token\n *\n */\nasync function estimateMaxPriorityFeePerGasInFeeCurrency(client, feeCurrency) {\n  const feesPerGas = await client.request({\n    method: 'eth_maxPriorityFeePerGas',\n    params: [feeCurrency]\n  });\n  return BigInt(feesPerGas);\n}","map":{"version":3,"names":["fees","estimateFeesPerGas","params","_params$request","request","feeCurrency","gasPrice","maxPriorityFeePerGas","Promise","all","estimateFeePerGasInFeeCurrency","client","estimateMaxPriorityFeePerGasInFeeCurrency","maxFeePerGas","multiply","fee","method","BigInt","feesPerGas"],"sources":["/Users/alex.codreanu/Desktop/marketplace-dapp/node_modules/viem/celo/fees.ts"],"sourcesContent":["import type { Client } from '../clients/createClient.js'\nimport type {\n  Address,\n  ChainEstimateFeesPerGasFnParameters,\n  ChainFees,\n  Hex,\n} from '../index.js'\nimport type { formatters } from './formatters.js'\n\nexport const fees: ChainFees<typeof formatters> = {\n  /*\n   * Estimates the fees per gas for a transaction.\n\n   * If the transaction is to be paid in a token (feeCurrency is present) then the fees \n   * are estimated in the value of the token. Otherwise falls back to the default\n   * estimation by returning null.\n   * \n   * @param params fee estimation function parameters\n   */\n  estimateFeesPerGas: async (\n    params: ChainEstimateFeesPerGasFnParameters<typeof formatters>,\n  ) => {\n    if (!params.request?.feeCurrency) return null\n\n    const [gasPrice, maxPriorityFeePerGas] = await Promise.all([\n      estimateFeePerGasInFeeCurrency(params.client, params.request.feeCurrency),\n      estimateMaxPriorityFeePerGasInFeeCurrency(\n        params.client,\n        params.request.feeCurrency,\n      ),\n    ])\n\n    // eth_gasPrice for cel2 returns baseFeePerGas + maxPriorityFeePerGas\n    const maxFeePerGas =\n      params.multiply(gasPrice - maxPriorityFeePerGas) + maxPriorityFeePerGas\n\n    return {\n      maxFeePerGas,\n      maxPriorityFeePerGas,\n    }\n  },\n}\n\ntype RequestGasPriceInFeeCurrencyParams = {\n  Method: 'eth_gasPrice'\n  Parameters: [Address]\n  ReturnType: Hex\n}\n\n/*\n * Estimate the fee per gas in the value of the fee token\n\n *\n * @param client - Client to use\n * @param feeCurrency -  Address of a whitelisted fee token\n * @returns The fee per gas in wei in the value of the  fee token\n *\n */\nasync function estimateFeePerGasInFeeCurrency(\n  client: Client,\n  feeCurrency: Address,\n) {\n  const fee = await client.request<RequestGasPriceInFeeCurrencyParams>({\n    method: 'eth_gasPrice',\n    params: [feeCurrency],\n  })\n  return BigInt(fee)\n}\n\ntype RequestMaxGasPriceInFeeCurrencyParams = {\n  Method: 'eth_maxPriorityFeePerGas'\n  Parameters: [Address]\n  ReturnType: Hex\n}\n\n/*\n * Estimate the max priority fee per gas in the value of the fee token\n\n *\n * @param client - Client to use\n * @param feeCurrency -  Address of a whitelisted fee token\n * @returns The fee per gas in wei in the value of the  fee token\n *\n */\nasync function estimateMaxPriorityFeePerGasInFeeCurrency(\n  client: Client,\n  feeCurrency: Address,\n) {\n  const feesPerGas =\n    await client.request<RequestMaxGasPriceInFeeCurrencyParams>({\n      method: 'eth_maxPriorityFeePerGas',\n      params: [feeCurrency],\n    })\n  return BigInt(feesPerGas)\n}\n"],"mappings":"AASA,OAAO,MAAMA,IAAI,GAAiC;EAChD;;;;;;;;EASAC,kBAAkB,EAAE,MAClBC,MAA8D,IAC5D;IAAA,IAAAC,eAAA;IACF,IAAI,GAAAA,eAAA,GAACD,MAAM,CAACE,OAAO,cAAAD,eAAA,eAAdA,eAAA,CAAgBE,WAAW,GAAE,OAAO,IAAI;IAE7C,MAAM,CAACC,QAAQ,EAAEC,oBAAoB,CAAC,GAAG,MAAMC,OAAO,CAACC,GAAG,CAAC,CACzDC,8BAA8B,CAACR,MAAM,CAACS,MAAM,EAAET,MAAM,CAACE,OAAO,CAACC,WAAW,CAAC,EACzEO,yCAAyC,CACvCV,MAAM,CAACS,MAAM,EACbT,MAAM,CAACE,OAAO,CAACC,WAAW,CAC3B,CACF,CAAC;IAEF;IACA,MAAMQ,YAAY,GAChBX,MAAM,CAACY,QAAQ,CAACR,QAAQ,GAAGC,oBAAoB,CAAC,GAAGA,oBAAoB;IAEzE,OAAO;MACLM,YAAY;MACZN;KACD;EACH;CACD;AAQD;;;;;;;;;AASA,eAAeG,8BAA8BA,CAC3CC,MAAc,EACdN,WAAoB;EAEpB,MAAMU,GAAG,GAAG,MAAMJ,MAAM,CAACP,OAAO,CAAqC;IACnEY,MAAM,EAAE,cAAc;IACtBd,MAAM,EAAE,CAACG,WAAW;GACrB,CAAC;EACF,OAAOY,MAAM,CAACF,GAAG,CAAC;AACpB;AAQA;;;;;;;;;AASA,eAAeH,yCAAyCA,CACtDD,MAAc,EACdN,WAAoB;EAEpB,MAAMa,UAAU,GACd,MAAMP,MAAM,CAACP,OAAO,CAAwC;IAC1DY,MAAM,EAAE,0BAA0B;IAClCd,MAAM,EAAE,CAACG,WAAW;GACrB,CAAC;EACJ,OAAOY,MAAM,CAACC,UAAU,CAAC;AAC3B","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}