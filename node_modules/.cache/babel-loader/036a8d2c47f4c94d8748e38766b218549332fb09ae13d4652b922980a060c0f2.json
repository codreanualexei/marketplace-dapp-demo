{"ast":null,"code":"import UniversalProvider from '@walletconnect/universal-provider';\nimport { ConstantsUtil, NetworkUtil, ParseUtil } from '@reown/appkit-common';\nimport { AlertController, ApiController, AssetUtil, BlockchainApiController, ChainController, ConnectionController, ConnectionControllerUtil, ConnectorController, ConstantsUtil as CoreConstantsUtil, CoreHelperUtil, EnsController, EventsController, ModalController, OnRampController, OptionsController, ProviderController, PublicStateController, RouterController, SIWXUtil, SendController, SnackController, StorageUtil, ThemeController, getPreferredAccountType } from '@reown/appkit-controllers';\nimport { WalletUtil } from '@reown/appkit-scaffold-ui/utils';\nimport { setColorTheme, setThemeVariables } from '@reown/appkit-ui';\nimport { CaipNetworksUtil, ErrorUtil, HelpersUtil, LoggerUtil, SemVerUtils, TokenUtil, ConstantsUtil as UtilConstantsUtil } from '@reown/appkit-utils';\nimport { UniversalAdapter } from '../universal-adapter/client.js';\nimport { ConfigUtil } from '../utils/ConfigUtil.js';\nimport { WcConstantsUtil, WcHelpersUtil } from '../utils/index.js';\nexport class AppKitBaseClient {\n  constructor(options) {\n    this.chainNamespaces = [];\n    this.features = {};\n    this.remoteFeatures = {};\n    this.reportedAlertErrors = {};\n    // -- Public Internal ---------------------------------------------------\n    this.getCaipNetwork = (chainNamespace, id) => {\n      if (chainNamespace) {\n        const caipNetworkWithId = ChainController.getCaipNetworks(chainNamespace)?.find(c => c.id === id);\n        if (caipNetworkWithId) {\n          return caipNetworkWithId;\n        }\n        const namespaceCaipNetwork = ChainController.getNetworkData(chainNamespace)?.caipNetwork;\n        if (namespaceCaipNetwork) {\n          return namespaceCaipNetwork;\n        }\n        const requestedCaipNetworks = ChainController.getRequestedCaipNetworks(chainNamespace);\n        return requestedCaipNetworks.filter(c => c.chainNamespace === chainNamespace)?.[0];\n      }\n      return ChainController.state.activeCaipNetwork || this.defaultCaipNetwork;\n    };\n    this.getCaipNetworkId = () => {\n      const network = this.getCaipNetwork();\n      if (network) {\n        return network.id;\n      }\n      return undefined;\n    };\n    this.getCaipNetworks = namespace => ChainController.getCaipNetworks(namespace);\n    this.getActiveChainNamespace = () => ChainController.state.activeChain;\n    this.setRequestedCaipNetworks = (requestedCaipNetworks, chain) => {\n      ChainController.setRequestedCaipNetworks(requestedCaipNetworks, chain);\n    };\n    this.getApprovedCaipNetworkIds = () => ChainController.getAllApprovedCaipNetworkIds();\n    this.getCaipAddress = chainNamespace => {\n      if (ChainController.state.activeChain === chainNamespace || !chainNamespace) {\n        return ChainController.state.activeCaipAddress;\n      }\n      return ChainController.state.chains.get(chainNamespace)?.accountState?.caipAddress;\n    };\n    this.setClientId = clientId => {\n      BlockchainApiController.setClientId(clientId);\n    };\n    this.getProvider = namespace => ProviderController.getProvider(namespace);\n    this.getProviderType = namespace => ProviderController.getProviderId(namespace);\n    this.getPreferredAccountType = namespace => getPreferredAccountType(namespace);\n    this.setCaipAddress = (caipAddress, chain, shouldRefresh = false) => {\n      ChainController.setAccountProp('caipAddress', caipAddress, chain, shouldRefresh);\n      ChainController.setAccountProp('address', CoreHelperUtil.getPlainAddress(caipAddress), chain, shouldRefresh);\n    };\n    this.setBalance = (balance, balanceSymbol, chain) => {\n      ChainController.setAccountProp('balance', balance, chain);\n      ChainController.setAccountProp('balanceSymbol', balanceSymbol, chain);\n    };\n    this.setProfileName = (profileName, chain) => {\n      ChainController.setAccountProp('profileName', profileName, chain);\n    };\n    this.setProfileImage = (profileImage, chain) => {\n      ChainController.setAccountProp('profileImage', profileImage, chain);\n    };\n    this.setUser = (user, chain) => {\n      ChainController.setAccountProp('user', user, chain);\n    };\n    this.resetAccount = chain => {\n      ChainController.resetAccount(chain);\n    };\n    this.setCaipNetwork = caipNetwork => {\n      ChainController.setActiveCaipNetwork(caipNetwork);\n    };\n    this.setCaipNetworkOfNamespace = (caipNetwork, chainNamespace) => {\n      ChainController.setChainNetworkData(chainNamespace, {\n        caipNetwork\n      });\n    };\n    this.setStatus = (status, chain) => {\n      ChainController.setAccountProp('status', status, chain);\n      // If at least one namespace is connected, set the connection status\n      if (ConnectorController.isConnected()) {\n        StorageUtil.setConnectionStatus('connected');\n      } else {\n        StorageUtil.setConnectionStatus('disconnected');\n      }\n    };\n    this.getAddressByChainNamespace = chainNamespace => ChainController.getAccountData(chainNamespace)?.address;\n    this.setConnectors = connectors => {\n      const allConnectors = [...ConnectorController.state.allConnectors, ...connectors];\n      ConnectorController.setConnectors(allConnectors);\n    };\n    this.setConnections = (connections, chainNamespace) => {\n      StorageUtil.setConnections(connections, chainNamespace);\n      ConnectionController.setConnections(connections, chainNamespace);\n    };\n    this.fetchIdentity = request => BlockchainApiController.fetchIdentity(request);\n    this.getReownName = address => EnsController.getNamesForAddress(address);\n    this.getConnectors = () => ConnectorController.getConnectors();\n    this.getConnectorImage = connector => AssetUtil.getConnectorImage(connector);\n    this.getConnections = namespace => {\n      if (!this.remoteFeatures.multiWallet) {\n        AlertController.open(ConstantsUtil.REMOTE_FEATURES_ALERTS.MULTI_WALLET_NOT_ENABLED.DEFAULT, 'info');\n        return [];\n      }\n      return ConnectionControllerUtil.getConnectionsData(namespace).connections;\n    };\n    this.getRecentConnections = namespace => {\n      if (!this.remoteFeatures.multiWallet) {\n        AlertController.open(ConstantsUtil.REMOTE_FEATURES_ALERTS.MULTI_WALLET_NOT_ENABLED.DEFAULT, 'info');\n        return [];\n      }\n      return ConnectionControllerUtil.getConnectionsData(namespace).recentConnections;\n    };\n    this.switchConnection = async params => {\n      if (!this.remoteFeatures.multiWallet) {\n        AlertController.open(ConstantsUtil.REMOTE_FEATURES_ALERTS.MULTI_WALLET_NOT_ENABLED.DEFAULT, 'info');\n        return;\n      }\n      await ConnectionController.switchConnection(params);\n    };\n    this.deleteConnection = params => {\n      if (!this.remoteFeatures.multiWallet) {\n        AlertController.open(ConstantsUtil.REMOTE_FEATURES_ALERTS.MULTI_WALLET_NOT_ENABLED.DEFAULT, 'info');\n        return;\n      }\n      StorageUtil.deleteAddressFromConnection(params);\n      ConnectionController.syncStorageConnections();\n    };\n    this.setConnectedWalletInfo = (connectedWalletInfo, chain) => {\n      const type = ProviderController.getProviderId(chain);\n      const walletInfo = connectedWalletInfo ? {\n        ...connectedWalletInfo,\n        type\n      } : undefined;\n      ChainController.setAccountProp('connectedWalletInfo', walletInfo, chain);\n    };\n    this.getIsConnectedState = () => Boolean(ChainController.state.activeCaipAddress);\n    this.addAddressLabel = (address, label, chain) => {\n      const addressLabels = ChainController.getAccountData(chain)?.addressLabels || {};\n      ChainController.setAccountProp('addressLabels', {\n        ...addressLabels,\n        [address]: label\n      }, chain);\n    };\n    this.removeAddressLabel = (address, chain) => {\n      const addressLabels = ChainController.getAccountData(chain)?.addressLabels || {};\n      ChainController.setAccountProp('addressLabels', {\n        ...addressLabels,\n        [address]: undefined\n      }, chain);\n    };\n    this.getAddress = chainNamespace => {\n      const namespace = chainNamespace || ChainController.state.activeChain;\n      return ChainController.getAccountData(namespace)?.address;\n    };\n    this.setApprovedCaipNetworksData = namespace => ChainController.setApprovedCaipNetworksData(namespace);\n    this.resetNetwork = namespace => {\n      ChainController.resetNetwork(namespace);\n    };\n    this.addConnector = connector => {\n      ConnectorController.addConnector(connector);\n    };\n    this.resetWcConnection = () => {\n      ConnectionController.resetWcConnection();\n    };\n    this.setAddressExplorerUrl = (addressExplorerUrl, chain) => {\n      ChainController.setAccountProp('addressExplorerUrl', addressExplorerUrl, chain);\n    };\n    this.setSmartAccountDeployed = (isDeployed, chain) => {\n      ChainController.setAccountProp('smartAccountDeployed', isDeployed, chain);\n    };\n    this.setPreferredAccountType = (preferredAccountType, chain) => {\n      ChainController.setAccountProp('preferredAccountType', preferredAccountType, chain);\n    };\n    this.setEIP6963Enabled = enabled => {\n      OptionsController.setEIP6963Enabled(enabled);\n    };\n    this.handleUnsafeRPCRequest = () => {\n      if (this.isOpen()) {\n        // If we are on the modal but there is no transaction stack, close the modal\n        if (this.isTransactionStackEmpty()) {\n          return;\n        }\n        // Check if we need to replace or redirect\n        this.redirect('ApproveTransaction');\n      } else {\n        // If called from outside the modal, open ApproveTransaction\n        this.open({\n          view: 'ApproveTransaction'\n        });\n      }\n    };\n    this.options = options;\n    this.version = options.sdkVersion;\n    this.caipNetworks = this.extendCaipNetworks(options);\n    this.chainNamespaces = this.getChainNamespacesSet(options.adapters, this.caipNetworks);\n    this.defaultCaipNetwork = this.extendDefaultCaipNetwork(options);\n    this.chainAdapters = this.createAdapters(options.adapters);\n    this.readyPromise = this.initialize(options);\n    SemVerUtils.checkSDKVersion(options.sdkVersion);\n  }\n  getChainNamespacesSet(adapters, caipNetworks) {\n    const adapterNamespaces = adapters?.map(adapter => adapter.namespace).filter(namespace => Boolean(namespace));\n    if (adapterNamespaces?.length) {\n      return [...new Set(adapterNamespaces)];\n    }\n    const networkNamespaces = caipNetworks?.map(network => network.chainNamespace);\n    return [...new Set(networkNamespaces)];\n  }\n  async initialize(options) {\n    this.initializeProjectSettings(options);\n    this.initControllers(options);\n    await this.initChainAdapters();\n    this.sendInitializeEvent(options);\n    if (OptionsController.state.enableReconnect) {\n      await this.syncExistingConnection();\n      await this.syncAdapterConnections();\n    } else {\n      await this.unSyncExistingConnection();\n    }\n    this.remoteFeatures = await ConfigUtil.fetchRemoteFeatures(options);\n    OptionsController.setRemoteFeatures(this.remoteFeatures);\n    if (this.remoteFeatures.onramp) {\n      OnRampController.setOnrampProviders(this.remoteFeatures.onramp);\n    }\n    // Check allowed origins only if email or social features are enabled\n    if (OptionsController.state.remoteFeatures?.email || Array.isArray(OptionsController.state.remoteFeatures?.socials) && OptionsController.state.remoteFeatures?.socials.length > 0) {\n      await this.checkAllowedOrigins();\n    }\n    if (OptionsController.state.features?.reownAuthentication || OptionsController.state.remoteFeatures?.reownAuthentication) {\n      const {\n        ReownAuthentication\n      } = await import('@reown/appkit-controllers/features');\n      const currentSIWX = OptionsController.state.siwx;\n      if (!(currentSIWX instanceof ReownAuthentication)) {\n        if (currentSIWX) {\n          console.warn('ReownAuthentication option is enabled, SIWX configuration will be overridden.');\n        }\n        OptionsController.setSIWX(new ReownAuthentication());\n      }\n      // If siwx is already configured for ReownAuthentication we keep the current instance\n    }\n  }\n  async openSend(args) {\n    const namespaceToUse = args.namespace || ChainController.state.activeChain;\n    const caipAddress = this.getCaipAddress(namespaceToUse);\n    const chainId = this.getCaipNetwork(namespaceToUse)?.id;\n    if (!caipAddress) {\n      throw new Error('openSend: caipAddress not found');\n    }\n    if (chainId?.toString() !== args.chainId.toString()) {\n      const caipNetwork = ChainController.getCaipNetworkById(args.chainId, namespaceToUse);\n      if (!caipNetwork) {\n        throw new Error(`openSend: caipNetwork with chainId ${args.chainId} not found`);\n      }\n      await this.switchNetwork(caipNetwork, {\n        throwOnFailure: true\n      });\n    }\n    try {\n      const symbol = TokenUtil.getTokenSymbolByAddress(args.assetAddress);\n      if (symbol) {\n        await ApiController.fetchTokenImages([symbol]);\n      }\n    } catch {\n      /* Ignore */\n    }\n    await ModalController.open({\n      view: 'WalletSend',\n      data: {\n        send: args\n      }\n    });\n    return new Promise((resolve, reject) => {\n      const unsubscribe = SendController.subscribeKey('hash', hash => {\n        if (hash) {\n          cleanup();\n          resolve({\n            hash\n          });\n        }\n      });\n      const unsubscribeModal = ModalController.subscribe(modal => {\n        if (!modal.open) {\n          cleanup();\n          reject(new Error('Modal closed'));\n        }\n      });\n      const cleanup = this.createCleanupHandler([unsubscribe, unsubscribeModal]);\n    });\n  }\n  toModalOptions() {\n    function isSwap(options) {\n      return options?.view === 'Swap';\n    }\n    function isSend(options) {\n      return options?.view === 'WalletSend';\n    }\n    return {\n      isSwap,\n      isSend\n    };\n  }\n  async checkAllowedOrigins() {\n    try {\n      const allowedOrigins = await ApiController.fetchAllowedOrigins();\n      if (!CoreHelperUtil.isClient()) {\n        return;\n      }\n      const currentOrigin = window.location.origin;\n      const isOriginAllowed = WcHelpersUtil.isOriginAllowed(currentOrigin, allowedOrigins, WcConstantsUtil.DEFAULT_ALLOWED_ANCESTORS);\n      if (!isOriginAllowed) {\n        AlertController.open(ErrorUtil.ALERT_ERRORS.ORIGIN_NOT_ALLOWED, 'error');\n      }\n    } catch (error) {\n      if (!(error instanceof Error)) {\n        return;\n      }\n      switch (error.message) {\n        case 'RATE_LIMITED':\n          AlertController.open(ErrorUtil.ALERT_ERRORS.RATE_LIMITED_APP_CONFIGURATION, 'error');\n          break;\n        case 'SERVER_ERROR':\n          {\n            const originalError = error.cause instanceof Error ? error.cause : error;\n            AlertController.open({\n              displayMessage: ErrorUtil.ALERT_ERRORS.SERVER_ERROR_APP_CONFIGURATION.displayMessage,\n              debugMessage: ErrorUtil.ALERT_ERRORS.SERVER_ERROR_APP_CONFIGURATION.debugMessage(originalError.message)\n            }, 'error');\n            break;\n          }\n        default:\n          break;\n      }\n    }\n  }\n  createCleanupHandler(unsubscribeFunctions) {\n    return () => {\n      unsubscribeFunctions.forEach(unsubscribe => {\n        try {\n          unsubscribe();\n        } catch {\n          // Ignore cleanup errors\n        }\n      });\n    };\n  }\n  sendInitializeEvent(options) {\n    const {\n      ...optionsCopy\n    } = options;\n    delete optionsCopy.adapters;\n    delete optionsCopy.universalProvider;\n    EventsController.sendEvent({\n      type: 'track',\n      event: 'INITIALIZE',\n      properties: {\n        ...optionsCopy,\n        networks: options.networks.map(n => n.id),\n        siweConfig: {\n          options: options.siweConfig?.options || {}\n        }\n      }\n    });\n  }\n  // -- Controllers initialization ---------------------------------------------------\n  initControllers(options) {\n    this.initializeOptionsController(options);\n    this.initializeChainController(options);\n    this.initializeThemeController(options);\n    this.initializeConnectionController(options);\n    this.initializeConnectorController();\n  }\n  initializeThemeController(options) {\n    if (options.themeMode) {\n      ThemeController.setThemeMode(options.themeMode);\n    }\n    if (options.themeVariables) {\n      ThemeController.setThemeVariables(options.themeVariables);\n    }\n  }\n  initializeChainController(options) {\n    if (!this.connectionControllerClient || !this.networkControllerClient) {\n      throw new Error('ConnectionControllerClient and NetworkControllerClient must be set');\n    }\n    ChainController.initialize(options.adapters ?? [], this.caipNetworks, {\n      connectionControllerClient: this.connectionControllerClient,\n      networkControllerClient: this.networkControllerClient\n    });\n    const network = this.getDefaultNetwork();\n    if (network) {\n      ChainController.setActiveCaipNetwork(network);\n    }\n  }\n  initializeConnectionController(options) {\n    ConnectionController.initialize(options.adapters ?? []);\n    ConnectionController.setWcBasic(options.basic ?? false);\n  }\n  initializeConnectorController() {\n    ConnectorController.initialize(this.chainNamespaces);\n  }\n  initializeProjectSettings(options) {\n    OptionsController.setProjectId(options.projectId);\n    OptionsController.setSdkVersion(options.sdkVersion);\n  }\n  initializeOptionsController(options) {\n    OptionsController.setDebug(options.debug !== false);\n    // On by default\n    OptionsController.setEnableWalletGuide(options.enableWalletGuide !== false);\n    OptionsController.setEnableWallets(options.enableWallets !== false);\n    OptionsController.setEIP6963Enabled(options.enableEIP6963 !== false);\n    OptionsController.setEnableNetworkSwitch(options.enableNetworkSwitch !== false);\n    OptionsController.setEnableReconnect(options.enableReconnect !== false);\n    OptionsController.setEnableMobileFullScreen(options.enableMobileFullScreen === true);\n    OptionsController.setEnableAuthLogger(options.enableAuthLogger !== false);\n    OptionsController.setCustomRpcUrls(options.customRpcUrls);\n    OptionsController.setEnableEmbedded(options.enableEmbedded);\n    OptionsController.setAllWallets(options.allWallets);\n    OptionsController.setIncludeWalletIds(options.includeWalletIds);\n    OptionsController.setExcludeWalletIds(options.excludeWalletIds);\n    OptionsController.setFeaturedWalletIds(options.featuredWalletIds);\n    OptionsController.setTokens(options.tokens);\n    OptionsController.setTermsConditionsUrl(options.termsConditionsUrl);\n    OptionsController.setPrivacyPolicyUrl(options.privacyPolicyUrl);\n    OptionsController.setCustomWallets(options.customWallets);\n    OptionsController.setFeatures(options.features);\n    OptionsController.setAllowUnsupportedChain(options.allowUnsupportedChain);\n    OptionsController.setUniversalProviderConfigOverride(options.universalProviderConfigOverride);\n    OptionsController.setPreferUniversalLinks(options.experimental_preferUniversalLinks);\n    // Save option in controller\n    OptionsController.setDefaultAccountTypes(options.defaultAccountTypes);\n    const defaultMetaData = this.getDefaultMetaData();\n    if (!options.metadata && defaultMetaData) {\n      options.metadata = defaultMetaData;\n    }\n    OptionsController.setMetadata(options.metadata);\n    OptionsController.setDisableAppend(options.disableAppend);\n    OptionsController.setEnableEmbedded(options.enableEmbedded);\n    OptionsController.setSIWX(options.siwx);\n    this.features = OptionsController.state.features ?? {};\n    if (!options.projectId) {\n      AlertController.open(ErrorUtil.ALERT_ERRORS.PROJECT_ID_NOT_CONFIGURED, 'error');\n      return;\n    }\n    const evmAdapter = options.adapters?.find(adapter => adapter.namespace === ConstantsUtil.CHAIN.EVM);\n    // Set the SIWE client for EVM chains\n    if (evmAdapter) {\n      if (options.siweConfig) {\n        if (options.siwx) {\n          throw new Error('Cannot set both `siweConfig` and `siwx` options');\n        }\n        OptionsController.setSIWX(options.siweConfig.mapToSIWX());\n      }\n    }\n  }\n  getDefaultMetaData() {\n    if (CoreHelperUtil.isClient()) {\n      return {\n        name: document.getElementsByTagName('title')?.[0]?.textContent || '',\n        description: document.querySelector('meta[property=\"og:description\"]')?.content || '',\n        url: window.location.origin,\n        icons: [document.querySelector('link[rel~=\"icon\"]')?.href || '']\n      };\n    }\n    return null;\n  }\n  // -- Network Initialization ---------------------------------------------------\n  setUnsupportedNetwork(chainId) {\n    const namespace = this.getActiveChainNamespace();\n    if (namespace) {\n      const unsupportedNetwork = CaipNetworksUtil.getUnsupportedNetwork(`${namespace}:${chainId}`);\n      ChainController.setActiveCaipNetwork(unsupportedNetwork);\n    }\n  }\n  getDefaultNetwork() {\n    return CaipNetworksUtil.getCaipNetworkFromStorage(this.defaultCaipNetwork);\n  }\n  extendCaipNetwork(network, options) {\n    const extendedNetwork = CaipNetworksUtil.extendCaipNetwork(network, {\n      customNetworkImageUrls: options.chainImages,\n      projectId: options.projectId\n    });\n    return extendedNetwork;\n  }\n  extendCaipNetworks(options) {\n    const extendedNetworks = CaipNetworksUtil.extendCaipNetworks(options.networks, {\n      customNetworkImageUrls: options.chainImages,\n      customRpcUrls: options.customRpcUrls,\n      projectId: options.projectId\n    });\n    return extendedNetworks;\n  }\n  extendDefaultCaipNetwork(options) {\n    const defaultNetwork = options.networks.find(n => n.id === options.defaultNetwork?.id);\n    const extendedNetwork = defaultNetwork ? CaipNetworksUtil.extendCaipNetwork(defaultNetwork, {\n      customNetworkImageUrls: options.chainImages,\n      customRpcUrls: options.customRpcUrls,\n      projectId: options.projectId\n    }) : undefined;\n    return extendedNetwork;\n  }\n  /**\n   * Disconnects a connector with the given namespace and id. If the connector id is not provided, disconnects the adapter (namespace).\n   * @param namespace ChainNamespace\n   * @param id string\n   * @returns\n   */\n  async disconnectConnector(namespace, id) {\n    try {\n      this.setLoading(true, namespace);\n      let disconnectResult = {\n        connections: []\n      };\n      const adapter = this.getAdapter(namespace);\n      const caipAddress = ChainController.state.chains.get(namespace)?.accountState?.caipAddress;\n      /**\n       * When the page loaded, the controller doesn't have address yet.\n       * To disconnect, we are checking enableReconnect flag to disconnect the namespace.\n       */\n      if ((caipAddress || !OptionsController.state.enableReconnect) && adapter?.disconnect) {\n        disconnectResult = await adapter.disconnect({\n          id\n        });\n      }\n      this.setLoading(false, namespace);\n      return disconnectResult;\n    } catch (error) {\n      this.setLoading(false, namespace);\n      throw new Error(`Failed to disconnect chains: ${error.message}`);\n    }\n  }\n  // -- Client Initialization ---------------------------------------------------\n  createClients() {\n    this.connectionControllerClient = {\n      connectWalletConnect: async () => {\n        const activeChain = ChainController.state.activeChain;\n        const adapter = this.getAdapter(activeChain);\n        const chainId = this.getCaipNetwork(activeChain)?.id;\n        const connections = ConnectionController.getConnections(activeChain);\n        const isMultiWallet = this.remoteFeatures.multiWallet;\n        const hasConnections = connections.length > 0;\n        if (!adapter) {\n          throw new Error('Adapter not found');\n        }\n        const result = await adapter.connectWalletConnect(chainId);\n        const shouldClose = !hasConnections || !isMultiWallet;\n        if (shouldClose) {\n          this.close();\n        }\n        this.setClientId(result?.clientId || null);\n        StorageUtil.setConnectedNamespaces([...ChainController.state.chains.keys()]);\n        await this.syncWalletConnectAccount();\n        await SIWXUtil.initializeIfEnabled();\n      },\n      connectExternal: async params => {\n        const connectResult = await this.onConnectExternal(params);\n        await this.connectInactiveNamespaces(params, connectResult);\n        return connectResult ? {\n          address: connectResult.address\n        } : undefined;\n      },\n      reconnectExternal: async ({\n        id,\n        info,\n        type,\n        provider\n      }) => {\n        const namespace = ChainController.state.activeChain;\n        const adapter = this.getAdapter(namespace);\n        if (!namespace) {\n          throw new Error('reconnectExternal: namespace not found');\n        }\n        if (!adapter) {\n          throw new Error('reconnectExternal: adapter not found');\n        }\n        if (adapter?.reconnect) {\n          await adapter?.reconnect({\n            id,\n            info,\n            type,\n            provider,\n            chainId: this.getCaipNetwork()?.id\n          });\n          StorageUtil.addConnectedNamespace(namespace);\n          this.syncConnectedWalletInfo(namespace);\n        }\n      },\n      disconnectConnector: async params => {\n        await this.disconnectConnector(params.namespace, params.id);\n      },\n      disconnect: async params => {\n        const {\n          id: connectorIdParam,\n          chainNamespace,\n          initialDisconnect\n        } = params || {};\n        const namespace = chainNamespace || ChainController.state.activeChain;\n        const namespaceConnectorId = ConnectorController.getConnectorId(namespace);\n        const isAuth = connectorIdParam === ConstantsUtil.CONNECTOR_ID.AUTH || namespaceConnectorId === ConstantsUtil.CONNECTOR_ID.AUTH;\n        const isWalletConnect = connectorIdParam === ConstantsUtil.CONNECTOR_ID.WALLET_CONNECT || namespaceConnectorId === ConstantsUtil.CONNECTOR_ID.WALLET_CONNECT;\n        try {\n          const namespaces = Array.from(ChainController.state.chains.keys());\n          let namespacesToDisconnect = chainNamespace ? [chainNamespace] : namespaces;\n          /*\n           * If the connector is WalletConnect or Auth, disconnect all namespaces\n           * since they share a single connector instance across all adapters\n           */\n          if (isWalletConnect || isAuth) {\n            namespacesToDisconnect = namespaces;\n          }\n          const disconnectPromises = namespacesToDisconnect.map(async ns => {\n            const currentConnectorId = ConnectorController.getConnectorId(ns);\n            const connectorIdToDisconnect = connectorIdParam || currentConnectorId;\n            const disconnectData = await this.disconnectConnector(ns, connectorIdToDisconnect);\n            if (disconnectData) {\n              if (isAuth) {\n                StorageUtil.deleteConnectedSocialProvider();\n              }\n              disconnectData.connections.forEach(connection => {\n                StorageUtil.addDisconnectedConnectorId(connection.connectorId, ns);\n              });\n            }\n            if (initialDisconnect) {\n              this.onDisconnectNamespace({\n                chainNamespace: ns,\n                closeModal: false\n              });\n            }\n          });\n          const disconnectResults = await Promise.allSettled(disconnectPromises);\n          SendController.resetSend();\n          ConnectionController.resetWcConnection();\n          if (SIWXUtil.getSIWX()?.signOutOnDisconnect) {\n            await SIWXUtil.clearSessions();\n          }\n          ConnectorController.setFilterByNamespace(undefined);\n          ConnectionController.syncStorageConnections();\n          const failures = disconnectResults.filter(result => result.status === 'rejected');\n          if (failures.length > 0) {\n            throw new Error(failures.map(f => f.reason.message).join(', '));\n          }\n          EventsController.sendEvent({\n            type: 'track',\n            event: 'DISCONNECT_SUCCESS',\n            properties: {\n              namespace: chainNamespace || 'all'\n            }\n          });\n        } catch (error) {\n          throw new Error(`Failed to disconnect chains: ${error.message}`);\n        }\n      },\n      checkInstalled: ids => {\n        if (!ids) {\n          return Boolean(window.ethereum);\n        }\n        return ids.some(id => Boolean(window.ethereum?.[String(id)]));\n      },\n      signMessage: async message => {\n        const namespace = ChainController.state.activeChain;\n        const adapter = this.getAdapter(ChainController.state.activeChain);\n        if (!namespace) {\n          throw new Error('signMessage: namespace not found');\n        }\n        if (!adapter) {\n          throw new Error('signMessage: adapter not found');\n        }\n        const address = this.getAddress(namespace);\n        if (!address) {\n          throw new Error('signMessage: address not found');\n        }\n        const result = await adapter?.signMessage({\n          message,\n          address,\n          provider: ProviderController.getProvider(namespace)\n        });\n        return result?.signature || '';\n      },\n      sendTransaction: async args => {\n        const namespace = args.chainNamespace;\n        if (!namespace) {\n          throw new Error('sendTransaction: namespace not found');\n        }\n        if (CoreConstantsUtil.SEND_SUPPORTED_NAMESPACES.includes(namespace)) {\n          const adapter = this.getAdapter(namespace);\n          if (!adapter) {\n            throw new Error('sendTransaction: adapter not found');\n          }\n          const provider = ProviderController.getProvider(namespace);\n          const result = await adapter?.sendTransaction({\n            ...args,\n            caipNetwork: this.getCaipNetwork(),\n            provider\n          });\n          return result?.hash || '';\n        }\n        return '';\n      },\n      estimateGas: async args => {\n        const namespace = args.chainNamespace;\n        if (namespace === ConstantsUtil.CHAIN.EVM) {\n          const adapter = this.getAdapter(namespace);\n          if (!adapter) {\n            throw new Error('estimateGas: adapter is required but got undefined');\n          }\n          const provider = ProviderController.getProvider(namespace);\n          const caipNetwork = this.getCaipNetwork();\n          if (!caipNetwork) {\n            throw new Error('estimateGas: caipNetwork is required but got undefined');\n          }\n          const result = await adapter?.estimateGas({\n            ...args,\n            provider,\n            caipNetwork\n          });\n          return result?.gas || 0n;\n        }\n        return 0n;\n      },\n      getEnsAvatar: async () => {\n        const namespace = ChainController.state.activeChain;\n        if (!namespace) {\n          throw new Error('getEnsAvatar: namespace is required but got undefined');\n        }\n        const address = this.getAddress(namespace);\n        if (!address) {\n          throw new Error('getEnsAvatar: address not found');\n        }\n        await this.syncIdentity({\n          address,\n          chainId: Number(this.getCaipNetwork()?.id),\n          chainNamespace: namespace\n        });\n        const accountData = ChainController.getAccountData();\n        return accountData?.profileImage || false;\n      },\n      getEnsAddress: async name => await WcHelpersUtil.resolveReownName(name),\n      writeContract: async args => {\n        const namespace = ChainController.state.activeChain;\n        const adapter = this.getAdapter(namespace);\n        if (!namespace) {\n          throw new Error('writeContract: namespace is required but got undefined');\n        }\n        if (!adapter) {\n          throw new Error('writeContract: adapter is required but got undefined');\n        }\n        const caipNetwork = this.getCaipNetwork();\n        const caipAddress = this.getCaipAddress();\n        const provider = ProviderController.getProvider(namespace);\n        if (!caipNetwork || !caipAddress) {\n          throw new Error('writeContract: caipNetwork or caipAddress is required but got undefined');\n        }\n        const result = await adapter?.writeContract({\n          ...args,\n          caipNetwork,\n          provider,\n          caipAddress\n        });\n        return result?.hash;\n      },\n      parseUnits: (value, decimals) => {\n        const adapter = this.getAdapter(ChainController.state.activeChain);\n        if (!adapter) {\n          throw new Error('parseUnits: adapter is required but got undefined');\n        }\n        return adapter?.parseUnits({\n          value,\n          decimals\n        }) ?? 0n;\n      },\n      formatUnits: (value, decimals) => {\n        const adapter = this.getAdapter(ChainController.state.activeChain);\n        if (!adapter) {\n          throw new Error('formatUnits: adapter is required but got undefined');\n        }\n        return adapter?.formatUnits({\n          value,\n          decimals\n        }) ?? '0';\n      },\n      getCapabilities: async params => {\n        const adapter = this.getAdapter(ChainController.state.activeChain);\n        if (!adapter) {\n          throw new Error('getCapabilities: adapter is required but got undefined');\n        }\n        return await adapter?.getCapabilities(params);\n      },\n      grantPermissions: async params => {\n        const adapter = this.getAdapter(ChainController.state.activeChain);\n        if (!adapter) {\n          throw new Error('grantPermissions: adapter is required but got undefined');\n        }\n        return await adapter?.grantPermissions(params);\n      },\n      revokePermissions: async params => {\n        const adapter = this.getAdapter(ChainController.state.activeChain);\n        if (!adapter) {\n          throw new Error('revokePermissions: adapter is required but got undefined');\n        }\n        if (adapter?.revokePermissions) {\n          return await adapter.revokePermissions(params);\n        }\n        return '0x';\n      },\n      walletGetAssets: async params => {\n        const adapter = this.getAdapter(ChainController.state.activeChain);\n        if (!adapter) {\n          throw new Error('walletGetAssets: adapter is required but got undefined');\n        }\n        return (await adapter?.walletGetAssets(params)) ?? {};\n      },\n      updateBalance: namespace => {\n        const address = this.getAddress(namespace);\n        const caipNetwork = this.getCaipNetwork(namespace);\n        if (!caipNetwork || !address) {\n          return;\n        }\n        this.updateNativeBalance(address, caipNetwork?.id, namespace);\n      }\n    };\n    this.networkControllerClient = {\n      switchCaipNetwork: async caipNetwork => await this.switchCaipNetwork(caipNetwork),\n      // eslint-disable-next-line @typescript-eslint/require-await\n      getApprovedCaipNetworksData: async () => this.getApprovedCaipNetworksData()\n    };\n    ConnectionController.setClient(this.connectionControllerClient);\n  }\n  async onConnectExternal(params) {\n    const activeChain = ChainController.state.activeChain;\n    const namespace = params.chain || activeChain;\n    const adapter = this.getAdapter(namespace);\n    let shouldUpdateNetwork = true;\n    if (params.type === UtilConstantsUtil.CONNECTOR_TYPE_AUTH) {\n      const authNamespaces = ConstantsUtil.AUTH_CONNECTOR_SUPPORTED_CHAINS;\n      const hasConnectedAuthNamespace = authNamespaces.some(namespace => ConnectorController.getConnectorId(namespace) === ConstantsUtil.CONNECTOR_ID.AUTH);\n      if (hasConnectedAuthNamespace && params.chain !== activeChain) {\n        shouldUpdateNetwork = false;\n      }\n    }\n    if (params.chain && params.chain !== activeChain && !params.caipNetwork) {\n      const toConnectNetwork = this.getCaipNetworks().find(network => network.chainNamespace === params.chain);\n      if (toConnectNetwork && shouldUpdateNetwork) {\n        this.setCaipNetwork(toConnectNetwork);\n      }\n    }\n    if (!namespace) {\n      throw new Error('connectExternal: namespace not found');\n    }\n    if (!adapter) {\n      throw new Error('connectExternal: adapter not found');\n    }\n    const fallbackCaipNetwork = this.getCaipNetwork(namespace);\n    const caipNetworkToUse = params.caipNetwork || fallbackCaipNetwork;\n    const res = await adapter.connect({\n      id: params.id,\n      address: params.address,\n      info: params.info,\n      type: params.type,\n      provider: params.provider,\n      socialUri: params.socialUri,\n      chainId: params.caipNetwork?.id || fallbackCaipNetwork?.id,\n      rpcUrl: params.caipNetwork?.rpcUrls?.default?.http?.[0] || fallbackCaipNetwork?.rpcUrls?.default?.http?.[0]\n    });\n    if (!res) {\n      return undefined;\n    }\n    StorageUtil.addConnectedNamespace(namespace);\n    this.syncProvider({\n      ...res,\n      chainNamespace: namespace\n    });\n    this.setStatus('connected', namespace);\n    this.syncConnectedWalletInfo(namespace);\n    StorageUtil.removeDisconnectedConnectorId(params.id, namespace);\n    return {\n      address: res.address,\n      connectedCaipNetwork: caipNetworkToUse\n    };\n  }\n  async connectInactiveNamespaces(params, connectResult) {\n    const isConnectingToAuth = params.type === UtilConstantsUtil.CONNECTOR_TYPE_AUTH;\n    const otherAuthNamespaces = HelpersUtil.getOtherAuthNamespaces(connectResult?.connectedCaipNetwork?.chainNamespace);\n    const activeCaipNetwork = ChainController.state.activeCaipNetwork;\n    const activeAdapter = this.getAdapter(activeCaipNetwork?.chainNamespace);\n    const activeProvider = ProviderController.getProvider(activeCaipNetwork?.chainNamespace);\n    if (isConnectingToAuth) {\n      await Promise.all(otherAuthNamespaces.map(async ns => {\n        try {\n          const provider = ProviderController.getProvider(ns);\n          const caipNetworkToUse = this.getCaipNetwork(ns);\n          const adapter = this.getAdapter(ns);\n          const res = await adapter?.connect({\n            ...params,\n            provider,\n            socialUri: undefined,\n            chainId: caipNetworkToUse?.id,\n            rpcUrl: caipNetworkToUse?.rpcUrls?.default?.http?.[0]\n          });\n          if (res) {\n            StorageUtil.addConnectedNamespace(ns);\n            StorageUtil.removeDisconnectedConnectorId(params.id, ns);\n            this.setStatus('connected', ns);\n            this.syncConnectedWalletInfo(ns);\n          }\n        } catch (error) {\n          AlertController.warn(ErrorUtil.ALERT_WARNINGS.INACTIVE_NAMESPACE_NOT_CONNECTED.displayMessage, ErrorUtil.ALERT_WARNINGS.INACTIVE_NAMESPACE_NOT_CONNECTED.debugMessage(ns, error instanceof Error ? error.message : undefined), ErrorUtil.ALERT_WARNINGS.INACTIVE_NAMESPACE_NOT_CONNECTED.code);\n        }\n      }));\n      // Make the secure site back to current network after reconnecting the other namespaces\n      if (activeCaipNetwork) {\n        await activeAdapter?.switchNetwork({\n          caipNetwork: activeCaipNetwork,\n          provider: activeProvider,\n          providerType: params.type\n        });\n      }\n    }\n  }\n  getApprovedCaipNetworksData() {\n    const providerType = ProviderController.getProviderId(ChainController.state.activeChain);\n    if (providerType === UtilConstantsUtil.CONNECTOR_TYPE_WALLET_CONNECT) {\n      const namespaces = this.universalProvider?.session?.namespaces;\n      return {\n        /*\n         * MetaMask Wallet only returns 1 namespace in the session object. This makes it imposible\n         * to switch to other networks. Setting supportsAllNetworks to true for MetaMask Wallet\n         * will make it possible to switch to other networks.\n         */\n        supportsAllNetworks: this.universalProvider?.session?.peer?.metadata.name === 'MetaMask Wallet',\n        approvedCaipNetworkIds: this.getChainsFromNamespaces(namespaces)\n      };\n    }\n    return {\n      supportsAllNetworks: true,\n      approvedCaipNetworkIds: []\n    };\n  }\n  async switchCaipNetwork(caipNetwork) {\n    const networkNamespace = caipNetwork.chainNamespace;\n    const namespaceAddress = this.getAddressByChainNamespace(caipNetwork.chainNamespace);\n    if (namespaceAddress) {\n      const provider = ProviderController.getProvider(networkNamespace);\n      const providerType = ProviderController.getProviderId(networkNamespace);\n      if (caipNetwork.chainNamespace === ChainController.state.activeChain) {\n        const adapter = this.getAdapter(networkNamespace);\n        await adapter?.switchNetwork({\n          caipNetwork,\n          provider,\n          providerType\n        });\n      } else {\n        this.setCaipNetwork(caipNetwork);\n        if (providerType === UtilConstantsUtil.CONNECTOR_TYPE_WALLET_CONNECT) {\n          this.syncWalletConnectAccount();\n        } else {\n          const address = this.getAddressByChainNamespace(networkNamespace);\n          if (address) {\n            this.syncAccount({\n              address,\n              chainId: caipNetwork.id,\n              chainNamespace: networkNamespace\n            });\n          }\n        }\n      }\n    } else {\n      this.setCaipNetwork(caipNetwork);\n    }\n  }\n  getChainsFromNamespaces(namespaces = {}) {\n    return Object.values(namespaces).flatMap(namespace => {\n      const chains = namespace.chains || [];\n      const accountsChains = namespace.accounts.map(account => {\n        const {\n          chainId,\n          chainNamespace\n        } = ParseUtil.parseCaipAddress(account);\n        return `${chainNamespace}:${chainId}`;\n      });\n      return Array.from(new Set([...chains, ...accountsChains]));\n    });\n  }\n  // -- Adapter Initialization ---------------------------------------------------\n  createAdapters(blueprints) {\n    this.createClients();\n    return this.chainNamespaces.reduce((adapters, namespace) => {\n      const blueprint = blueprints?.find(b => b.namespace === namespace);\n      if (blueprint) {\n        blueprint.construct({\n          namespace,\n          projectId: this.options?.projectId,\n          networks: this.caipNetworks?.filter(({\n            chainNamespace\n          }) => chainNamespace === namespace)\n        });\n        adapters[namespace] = blueprint;\n      } else {\n        adapters[namespace] = new UniversalAdapter({\n          namespace,\n          networks: this.getCaipNetworks()\n        });\n      }\n      return adapters;\n      // eslint-disable-next-line @typescript-eslint/prefer-reduce-type-parameter\n    }, {});\n  }\n  async initChainAdapter(namespace) {\n    this.onConnectors(namespace);\n    this.listenAdapter(namespace);\n    await this.chainAdapters?.[namespace].syncConnectors(this.options, this);\n    await this.createUniversalProviderForAdapter(namespace);\n  }\n  async initChainAdapters() {\n    await Promise.all(this.chainNamespaces.map(async namespace => {\n      await this.initChainAdapter(namespace);\n    }));\n  }\n  onConnectors(chainNamespace) {\n    const adapter = this.getAdapter(chainNamespace);\n    adapter?.on('connectors', this.setConnectors.bind(this));\n  }\n  listenAdapter(chainNamespace) {\n    const adapter = this.getAdapter(chainNamespace);\n    if (!adapter) {\n      return;\n    }\n    const connectionStatus = StorageUtil.getConnectionStatus();\n    if (OptionsController.state.enableReconnect === false) {\n      this.setStatus('disconnected', chainNamespace);\n    } else if (connectionStatus === 'connected') {\n      this.setStatus('connecting', chainNamespace);\n    } else if (connectionStatus === 'disconnected') {\n      /*\n       * Address cache is kept after disconnecting from the wallet\n       * but should be cleared if appkit is launched in disconnected state\n       */\n      StorageUtil.clearAddressCache();\n      this.setStatus(connectionStatus, chainNamespace);\n    } else {\n      this.setStatus(connectionStatus, chainNamespace);\n    }\n    adapter.on('switchNetwork', ({\n      address,\n      chainId\n    }) => {\n      const caipNetwork = this.getCaipNetworks().find(n => n.id.toString() === chainId.toString() || n.caipNetworkId.toString() === chainId.toString());\n      const isSameNamespace = ChainController.state.activeChain === chainNamespace;\n      const accountAddress = ChainController.state.chains.get(chainNamespace)?.accountState?.address;\n      if (caipNetwork) {\n        const account = isSameNamespace && address ? address : accountAddress;\n        if (account) {\n          this.syncAccount({\n            address: account,\n            chainId: caipNetwork.id,\n            chainNamespace\n          });\n        }\n      } else {\n        this.setUnsupportedNetwork(chainId);\n      }\n    });\n    adapter.on('disconnect', () => {\n      const isMultiWallet = this.remoteFeatures.multiWallet;\n      const allConnections = Array.from(ConnectionController.state.connections.values()).flat();\n      this.onDisconnectNamespace({\n        chainNamespace,\n        closeModal: !isMultiWallet || allConnections.length === 0\n      });\n    });\n    adapter.on('connections', connections => {\n      this.setConnections(connections, chainNamespace);\n    });\n    adapter.on('pendingTransactions', () => {\n      const address = this.getAddress(chainNamespace);\n      const activeCaipNetwork = ChainController.state.activeCaipNetwork;\n      if (!address || !activeCaipNetwork?.id) {\n        return;\n      }\n      this.updateNativeBalance(address, activeCaipNetwork.id, activeCaipNetwork.chainNamespace);\n    });\n    adapter.on('accountChanged', ({\n      address,\n      chainId,\n      connector\n    }) => {\n      this.handlePreviousConnectorConnection(connector);\n      const isActiveChain = ChainController.state.activeChain === chainNamespace;\n      if (connector?.provider) {\n        this.syncProvider({\n          id: connector.id,\n          type: connector.type,\n          provider: connector?.provider,\n          chainNamespace\n        });\n        this.syncConnectedWalletInfo(chainNamespace);\n      }\n      const namespaceNetworkId = ChainController.getNetworkData(chainNamespace)?.caipNetwork?.id;\n      const syncAccountChainId = chainId || namespaceNetworkId;\n      if (isActiveChain && syncAccountChainId) {\n        this.syncAccount({\n          address,\n          chainId: syncAccountChainId,\n          chainNamespace\n        });\n      } else if (!isActiveChain && syncAccountChainId) {\n        this.syncAccountInfo(address, syncAccountChainId, chainNamespace);\n        this.syncBalance({\n          address,\n          chainId: syncAccountChainId,\n          chainNamespace\n        });\n      } else {\n        this.syncAccountInfo(address, chainId, chainNamespace);\n      }\n      StorageUtil.addConnectedNamespace(chainNamespace);\n    });\n  }\n  /**\n   * Checks the incoming connector and handles the previous connection in the connector's namespace, and if necessary (i.e multi-wallet is disabled) disconnects the previous connector\n   * @param connector\n   */\n  async handlePreviousConnectorConnection(connector) {\n    const namespace = connector?.chain;\n    const newConnectorId = connector?.id;\n    const currentConnectorId = ConnectorController.getConnectorId(namespace);\n    const isMultiWalletEnabled = OptionsController.state.remoteFeatures?.multiWallet;\n    const hasNewConnectorConnected = currentConnectorId !== newConnectorId;\n    const shouldDisconnectPreviousConnector = namespace && newConnectorId && currentConnectorId && hasNewConnectorConnected && !isMultiWalletEnabled;\n    try {\n      if (shouldDisconnectPreviousConnector) {\n        await ConnectionController.disconnect({\n          id: currentConnectorId,\n          namespace\n        });\n      }\n    } catch (error) {\n      console.warn('Error disconnecting previous connector', error);\n    }\n  }\n  async createUniversalProviderForAdapter(chainNamespace) {\n    await this.getUniversalProvider();\n    if (this.universalProvider) {\n      await this.chainAdapters?.[chainNamespace]?.setUniversalProvider?.(this.universalProvider);\n    }\n  }\n  // -- Connection Sync ---------------------------------------------------\n  async syncExistingConnection() {\n    await Promise.allSettled(this.chainNamespaces.map(namespace => this.syncNamespaceConnection(namespace)));\n  }\n  async unSyncExistingConnection() {\n    try {\n      await Promise.allSettled(this.chainNamespaces.map(namespace => ConnectionController.disconnect({\n        namespace,\n        initialDisconnect: true\n      })));\n    } catch (error) {\n      // eslint-disable-next-line no-console\n      console.error('Error disconnecting existing connections:', error);\n    }\n  }\n  async reconnectWalletConnect() {\n    await this.syncWalletConnectAccount();\n    const address = this.getAddress();\n    if (!this.getCaipAddress()) {\n      StorageUtil.deleteRecentWallet();\n    }\n    const recentWallet = StorageUtil.getRecentWallet();\n    EventsController.sendEvent({\n      type: 'track',\n      event: 'CONNECT_SUCCESS',\n      address,\n      properties: {\n        method: CoreHelperUtil.isMobile() ? 'mobile' : 'qrcode',\n        name: recentWallet?.name || 'Unknown',\n        reconnect: true,\n        view: RouterController.state.view,\n        walletRank: recentWallet?.order\n      }\n    });\n  }\n  async syncNamespaceConnection(namespace) {\n    try {\n      if (namespace === ConstantsUtil.CHAIN.EVM && CoreHelperUtil.isSafeApp()) {\n        ConnectorController.setConnectorId(ConstantsUtil.CONNECTOR_ID.SAFE, namespace);\n      }\n      const connectorId = ConnectorController.getConnectorId(namespace);\n      this.setStatus('connecting', namespace);\n      switch (connectorId) {\n        case ConstantsUtil.CONNECTOR_ID.WALLET_CONNECT:\n          await this.reconnectWalletConnect();\n          break;\n        case ConstantsUtil.CONNECTOR_ID.AUTH:\n          // Handled during initialization of adapters' auth provider\n          break;\n        default:\n          await this.syncAdapterConnection(namespace);\n      }\n    } catch (err) {\n      console.warn(\"AppKit couldn't sync existing connection\", err);\n      this.setStatus('disconnected', namespace);\n    }\n  }\n  onDisconnectNamespace(options) {\n    const {\n      chainNamespace,\n      closeModal\n    } = options || {};\n    ChainController.resetAccount(chainNamespace);\n    ChainController.resetNetwork(chainNamespace);\n    StorageUtil.removeConnectedNamespace(chainNamespace);\n    const namespaces = Array.from(ChainController.state.chains.keys());\n    const namespacesToDisconnect = chainNamespace ? [chainNamespace] : namespaces;\n    namespacesToDisconnect.forEach(ns => StorageUtil.addDisconnectedConnectorId(ConnectorController.getConnectorId(ns) || '', ns));\n    ConnectorController.removeConnectorId(chainNamespace);\n    ProviderController.resetChain(chainNamespace);\n    this.setUser(null, chainNamespace);\n    this.setStatus('disconnected', chainNamespace);\n    this.setConnectedWalletInfo(null, chainNamespace);\n    if (closeModal !== false) {\n      ModalController.close();\n    }\n  }\n  async syncAdapterConnections() {\n    await Promise.allSettled(this.chainNamespaces.map(namespace => {\n      const adapter = this.getAdapter(namespace);\n      const caipAddress = this.getCaipAddress(namespace);\n      const caipNetwork = this.getCaipNetwork(namespace);\n      return adapter?.syncConnections({\n        connectToFirstConnector: !caipAddress,\n        caipNetwork\n      });\n    }));\n  }\n  async syncAdapterConnection(namespace) {\n    const adapter = this.getAdapter(namespace);\n    const caipNetwork = this.getCaipNetwork(namespace);\n    const connectorId = ConnectorController.getConnectorId(namespace);\n    const connectors = ConnectorController.getConnectors(namespace);\n    const connector = connectors.find(c => c.id === connectorId);\n    try {\n      if (!adapter || !connector) {\n        throw new Error(`Adapter or connector not found for namespace ${namespace}`);\n      }\n      if (!caipNetwork?.id) {\n        throw new Error('CaipNetwork not found');\n      }\n      const connection = await adapter?.syncConnection({\n        namespace,\n        id: connector.id,\n        chainId: caipNetwork.id,\n        rpcUrl: caipNetwork?.rpcUrls?.default?.http?.[0]\n      });\n      if (connection) {\n        this.syncProvider({\n          ...connection,\n          chainNamespace: namespace\n        });\n        await this.syncAccount({\n          ...connection,\n          chainNamespace: namespace\n        });\n        this.setStatus('connected', namespace);\n        EventsController.sendEvent({\n          type: 'track',\n          event: 'CONNECT_SUCCESS',\n          address: connection.address,\n          properties: {\n            method: 'browser',\n            name: connector.info?.name || connector.name || 'Unknown',\n            reconnect: true,\n            view: RouterController.state.view,\n            walletRank: undefined\n          }\n        });\n      } else {\n        this.setStatus('disconnected', namespace);\n      }\n    } catch (e) {\n      this.onDisconnectNamespace({\n        chainNamespace: namespace,\n        closeModal: false\n      });\n    }\n  }\n  async syncWalletConnectAccount() {\n    const sessionNamespaces = Object.keys(this.universalProvider?.session?.namespaces || {});\n    const syncTasks = this.chainNamespaces.map(async chainNamespace => {\n      const adapter = this.getAdapter(chainNamespace);\n      if (!adapter) {\n        return;\n      }\n      const namespaceAccounts = this.universalProvider?.session?.namespaces?.[chainNamespace]?.accounts || [];\n      // We try and find the address for this network in the session object.\n      const activeChainId = ChainController.state.activeCaipNetwork?.id;\n      const sessionAddress = namespaceAccounts.find(account => {\n        const {\n          chainId\n        } = ParseUtil.parseCaipAddress(account);\n        return chainId === activeChainId?.toString();\n      }) || namespaceAccounts[0];\n      if (sessionAddress) {\n        const caipAddress = ParseUtil.validateCaipAddress(sessionAddress);\n        const {\n          chainId,\n          address\n        } = ParseUtil.parseCaipAddress(caipAddress);\n        ProviderController.setProviderId(chainNamespace, UtilConstantsUtil.CONNECTOR_TYPE_WALLET_CONNECT);\n        if (this.caipNetworks && ChainController.state.activeCaipNetwork && adapter.namespace !== ConstantsUtil.CHAIN.EVM) {\n          const provider = adapter.getWalletConnectProvider({\n            caipNetworks: this.getCaipNetworks(),\n            provider: this.universalProvider,\n            activeCaipNetwork: ChainController.state.activeCaipNetwork\n          });\n          ProviderController.setProvider(chainNamespace, provider);\n        } else {\n          ProviderController.setProvider(chainNamespace, this.universalProvider);\n        }\n        ConnectorController.setConnectorId(ConstantsUtil.CONNECTOR_ID.WALLET_CONNECT, chainNamespace);\n        StorageUtil.addConnectedNamespace(chainNamespace);\n        await this.syncAccount({\n          address,\n          chainId,\n          chainNamespace\n        });\n      } else if (sessionNamespaces.includes(chainNamespace)) {\n        this.setStatus('disconnected', chainNamespace);\n      }\n      this.syncConnectedWalletInfo(chainNamespace);\n      await ChainController.setApprovedCaipNetworksData(chainNamespace);\n    });\n    await Promise.all(syncTasks);\n  }\n  syncProvider({\n    type,\n    provider,\n    id,\n    chainNamespace\n  }) {\n    ProviderController.setProviderId(chainNamespace, type);\n    ProviderController.setProvider(chainNamespace, provider);\n    ConnectorController.setConnectorId(id, chainNamespace);\n  }\n  async syncAccount(params) {\n    const isActiveNamespace = params.chainNamespace === ChainController.state.activeChain;\n    const networkOfChain = ChainController.getCaipNetworkByNamespace(params.chainNamespace, params.chainId);\n    const {\n      address,\n      chainId,\n      chainNamespace\n    } = params;\n    const {\n      chainId: activeChainId\n    } = StorageUtil.getActiveNetworkProps();\n    const chainIdToUse = chainId || activeChainId;\n    const isUnsupportedNetwork = ChainController.state.activeCaipNetwork?.name === ConstantsUtil.UNSUPPORTED_NETWORK_NAME;\n    const shouldSupportAllNetworks = ChainController.getNetworkProp('supportsAllNetworks', chainNamespace);\n    this.setStatus('connected', chainNamespace);\n    if (isUnsupportedNetwork && !shouldSupportAllNetworks) {\n      return;\n    }\n    if (chainIdToUse) {\n      let caipNetwork = this.getCaipNetworks().find(n => n.id.toString() === chainIdToUse.toString());\n      let fallbackCaipNetwork = this.getCaipNetworks().find(n => n.chainNamespace === chainNamespace);\n      // If doesn't support all networks, we need to use approved networks\n      if (!shouldSupportAllNetworks && !caipNetwork && !fallbackCaipNetwork) {\n        // Connection can be requested for a chain that is not supported by the wallet so we need to use approved networks here\n        const caipNetworkIds = this.getApprovedCaipNetworkIds() || [];\n        const caipNetworkId = caipNetworkIds.find(id => ParseUtil.parseCaipNetworkId(id)?.chainId === chainIdToUse.toString());\n        const fallBackCaipNetworkId = caipNetworkIds.find(id => ParseUtil.parseCaipNetworkId(id)?.chainNamespace === chainNamespace);\n        caipNetwork = this.getCaipNetworks().find(n => n.caipNetworkId === caipNetworkId);\n        fallbackCaipNetwork = this.getCaipNetworks().find(n => n.caipNetworkId === fallBackCaipNetworkId ||\n        // This is a workaround used in Solana network to support deprecated caipNetworkId\n        'deprecatedCaipNetworkId' in n && n.deprecatedCaipNetworkId === fallBackCaipNetworkId);\n      }\n      const network = caipNetwork || fallbackCaipNetwork;\n      if (network?.chainNamespace === ChainController.state.activeChain) {\n        // If the network is unsupported and the user doesn't allow unsupported chains, we show the unsupported chain UI\n        if (OptionsController.state.enableNetworkSwitch && !OptionsController.state.allowUnsupportedChain && ChainController.state.activeCaipNetwork?.name === ConstantsUtil.UNSUPPORTED_NETWORK_NAME) {\n          ChainController.showUnsupportedChainUI();\n        } else {\n          this.setCaipNetwork(network);\n        }\n      } else if (!isActiveNamespace) {\n        if (networkOfChain) {\n          this.setCaipNetworkOfNamespace(networkOfChain, chainNamespace);\n        }\n      }\n      this.syncConnectedWalletInfo(chainNamespace);\n      const currentAddress = this.getAddress(chainNamespace);\n      if (!HelpersUtil.isLowerCaseMatch(address, currentAddress)) {\n        this.syncAccountInfo(address, network?.id, chainNamespace);\n      }\n      if (isActiveNamespace) {\n        await this.syncBalance({\n          address,\n          chainId: network?.id,\n          chainNamespace\n        });\n      } else {\n        await this.syncBalance({\n          address,\n          chainId: networkOfChain?.id,\n          chainNamespace\n        });\n      }\n      this.syncIdentity({\n        address,\n        chainId,\n        chainNamespace\n      });\n    }\n  }\n  async syncAccountInfo(address, chainId, chainNamespace) {\n    const caipAddress = this.getCaipAddress(chainNamespace);\n    const newChainId = chainId || caipAddress?.split(':')[1];\n    if (!newChainId) {\n      return;\n    }\n    const newCaipAddress = `${chainNamespace}:${newChainId}:${address}`;\n    this.setCaipAddress(newCaipAddress, chainNamespace, true);\n    await this.syncIdentity({\n      address,\n      chainId: newChainId,\n      chainNamespace\n    });\n  }\n  async syncReownName(address, chainNamespace) {\n    try {\n      const registeredWcNames = await this.getReownName(address);\n      if (registeredWcNames[0]) {\n        const wcName = registeredWcNames[0];\n        this.setProfileName(wcName.name, chainNamespace);\n      } else {\n        this.setProfileName(null, chainNamespace);\n      }\n    } catch {\n      this.setProfileName(null, chainNamespace);\n    }\n  }\n  syncConnectedWalletInfo(chainNamespace) {\n    const connectorId = ConnectorController.getConnectorId(chainNamespace);\n    const providerType = ProviderController.getProviderId(chainNamespace);\n    if (providerType === UtilConstantsUtil.CONNECTOR_TYPE_ANNOUNCED || providerType === UtilConstantsUtil.CONNECTOR_TYPE_INJECTED) {\n      if (connectorId) {\n        const connectors = this.getConnectors();\n        const connector = connectors.find(c => {\n          const isConnectorId = c.id === connectorId;\n          const isRdns = c.info?.rdns === connectorId;\n          const hasMultiChainConnector = c.connectors?.some(_c => _c.id === connectorId || _c.info?.rdns === connectorId);\n          return isConnectorId || isRdns || Boolean(hasMultiChainConnector);\n        });\n        if (connector) {\n          const {\n            info,\n            name,\n            imageUrl\n          } = connector;\n          const icon = imageUrl || this.getConnectorImage(connector);\n          this.setConnectedWalletInfo({\n            name,\n            icon,\n            ...info\n          }, chainNamespace);\n        }\n      }\n    } else if (providerType === UtilConstantsUtil.CONNECTOR_TYPE_WALLET_CONNECT) {\n      const provider = ProviderController.getProvider(chainNamespace);\n      if (provider?.session) {\n        this.setConnectedWalletInfo({\n          ...provider.session.peer.metadata,\n          name: provider.session.peer.metadata.name,\n          icon: provider.session.peer.metadata.icons?.[0]\n        }, chainNamespace);\n      }\n    } else if (connectorId) {\n      if (connectorId === ConstantsUtil.CONNECTOR_ID.COINBASE_SDK || connectorId === ConstantsUtil.CONNECTOR_ID.COINBASE) {\n        const connector = this.getConnectors().find(c => c.id === connectorId);\n        const name = connector?.name || 'Coinbase Wallet';\n        const icon = connector?.imageUrl || this.getConnectorImage(connector);\n        const info = connector?.info;\n        this.setConnectedWalletInfo({\n          ...info,\n          name,\n          icon\n        }, chainNamespace);\n      }\n    }\n  }\n  async syncBalance(params) {\n    const caipNetwork = NetworkUtil.getNetworksByNamespace(this.getCaipNetworks(), params.chainNamespace).find(n => n.id.toString() === params.chainId?.toString());\n    if (!caipNetwork || !params.chainId) {\n      return;\n    }\n    await this.updateNativeBalance(params.address, params.chainId, params.chainNamespace);\n  }\n  async ready() {\n    await this.readyPromise;\n  }\n  async updateNativeBalance(address, chainId, namespace) {\n    const adapter = this.getAdapter(namespace);\n    const caipNetwork = ChainController.getCaipNetworkByNamespace(namespace, chainId);\n    if (adapter) {\n      const balance = await adapter.getBalance({\n        address,\n        chainId,\n        caipNetwork,\n        tokens: this.options.tokens\n      });\n      this.setBalance(balance.balance, balance.symbol, namespace);\n      return balance;\n    }\n    return undefined;\n  }\n  // -- Universal Provider ---------------------------------------------------\n  async initializeUniversalAdapter() {\n    const logger = LoggerUtil.createLogger((error, ...args) => {\n      if (error) {\n        this.handleAlertError(error);\n      }\n      // eslint-disable-next-line no-console\n      console.error(...args);\n    });\n    const universalProviderOptions = {\n      projectId: this.options?.projectId,\n      metadata: {\n        name: this.options?.metadata ? this.options?.metadata.name : '',\n        description: this.options?.metadata ? this.options?.metadata.description : '',\n        url: this.options?.metadata ? this.options?.metadata.url : '',\n        icons: this.options?.metadata ? this.options?.metadata.icons : ['']\n      },\n      logger\n    };\n    OptionsController.setManualWCControl(Boolean(this.options?.manualWCControl));\n    this.universalProvider = this.options.universalProvider ?? (await UniversalProvider.init(universalProviderOptions));\n    // Clear the session if we don't want to reconnect on init\n    if (OptionsController.state.enableReconnect === false && this.universalProvider.session) {\n      await this.universalProvider.disconnect();\n    }\n    this.listenWalletConnect();\n  }\n  listenWalletConnect() {\n    if (this.universalProvider) {\n      this.chainNamespaces.forEach(namespace => {\n        WcHelpersUtil.listenWcProvider({\n          universalProvider: this.universalProvider,\n          namespace,\n          onDisplayUri: uri => {\n            ConnectionController.setUri(uri);\n          },\n          onConnect: accounts => {\n            const {\n              address\n            } = CoreHelperUtil.getAccount(accounts[0]);\n            ConnectionController.finalizeWcConnection(address);\n          },\n          onDisconnect: () => {\n            if (ChainController.state.noAdapters) {\n              this.resetAccount(namespace);\n            }\n            ConnectionController.resetWcConnection();\n          },\n          onChainChanged: chainId => {\n            const activeNamespace = ChainController.state.activeChain;\n            const isCurrentConnectorWalletConnect = activeNamespace && ConnectorController.state.activeConnectorIds[activeNamespace] === ConstantsUtil.CONNECTOR_ID.WALLET_CONNECT;\n            if (activeNamespace === namespace && (ChainController.state.noAdapters || isCurrentConnectorWalletConnect)) {\n              const caipNetwork = this.getCaipNetworks().find(n => n.id.toString() === chainId.toString() || n.caipNetworkId.toString() === chainId.toString());\n              const currentCaipNetwork = this.getCaipNetwork();\n              if (!caipNetwork) {\n                this.setUnsupportedNetwork(chainId);\n                return;\n              }\n              if (currentCaipNetwork?.id.toString() !== caipNetwork?.id.toString() && currentCaipNetwork?.chainNamespace === caipNetwork?.chainNamespace) {\n                this.setCaipNetwork(caipNetwork);\n              }\n            }\n          },\n          onAccountsChanged: accounts => {\n            const activeNamespace = ChainController.state.activeChain;\n            const isCurrentConnectorWalletConnect = activeNamespace && ConnectorController.state.activeConnectorIds[activeNamespace] === ConstantsUtil.CONNECTOR_ID.WALLET_CONNECT;\n            if (activeNamespace === namespace && (ChainController.state.noAdapters || isCurrentConnectorWalletConnect)) {\n              const account = accounts?.[0];\n              if (account) {\n                this.syncAccount({\n                  address: account.address,\n                  chainId: account.chainId,\n                  chainNamespace: account.chainNamespace\n                });\n              }\n            }\n          }\n        });\n      });\n    }\n  }\n  createUniversalProvider() {\n    if (!this.universalProviderInitPromise && CoreHelperUtil.isClient() && this.options?.projectId) {\n      this.universalProviderInitPromise = this.initializeUniversalAdapter();\n    }\n    return this.universalProviderInitPromise;\n  }\n  async getUniversalProvider() {\n    if (!this.universalProvider) {\n      try {\n        await this.createUniversalProvider();\n      } catch (err) {\n        EventsController.sendEvent({\n          type: 'error',\n          event: 'INTERNAL_SDK_ERROR',\n          properties: {\n            errorType: 'UniversalProviderInitError',\n            errorMessage: err instanceof Error ? err.message : 'Unknown',\n            uncaught: false\n          }\n        });\n        // eslint-disable-next-line no-console\n        console.error('AppKit:getUniversalProvider - Cannot create provider', err);\n      }\n    }\n    return this.universalProvider;\n  }\n  getDisabledCaipNetworks() {\n    const approvedCaipNetworkIds = ChainController.getAllApprovedCaipNetworkIds();\n    const requestedCaipNetworks = ChainController.getAllRequestedCaipNetworks();\n    const sortedNetworks = CoreHelperUtil.sortRequestedNetworks(approvedCaipNetworkIds, requestedCaipNetworks);\n    return sortedNetworks.filter(network => ChainController.isCaipNetworkDisabled(network));\n  }\n  // - Utils -------------------------------------------------------------------\n  handleAlertError(error) {\n    const matchedUniversalProviderError = Object.entries(ErrorUtil.UniversalProviderErrors).find(([, {\n      message\n    }]) => error.message.includes(message));\n    const [errorKey, errorValue] = matchedUniversalProviderError ?? [];\n    const {\n      message,\n      alertErrorKey\n    } = errorValue ?? {};\n    if (errorKey && message && !this.reportedAlertErrors[errorKey]) {\n      const alertError = ErrorUtil.ALERT_ERRORS[alertErrorKey];\n      if (alertError) {\n        AlertController.open(alertError, 'error');\n        this.reportedAlertErrors[errorKey] = true;\n      }\n    }\n  }\n  getAdapter(namespace) {\n    if (!namespace) {\n      return undefined;\n    }\n    return this.chainAdapters?.[namespace];\n  }\n  createAdapter(blueprint) {\n    if (!blueprint) {\n      return;\n    }\n    const namespace = blueprint.namespace;\n    if (!namespace) {\n      return;\n    }\n    this.createClients();\n    const adapterBlueprint = blueprint;\n    adapterBlueprint.namespace = namespace;\n    adapterBlueprint.construct({\n      namespace,\n      projectId: this.options?.projectId,\n      networks: this.caipNetworks?.filter(({\n        chainNamespace\n      }) => chainNamespace === namespace)\n    });\n    if (!this.chainNamespaces.includes(namespace)) {\n      this.chainNamespaces.push(namespace);\n    }\n    if (this.chainAdapters) {\n      this.chainAdapters[namespace] = adapterBlueprint;\n    }\n  }\n  // -- Public -------------------------------------------------------------------\n  async open(options) {\n    await this.injectModalUi();\n    if (options?.uri) {\n      ConnectionController.setUri(options.uri);\n    }\n    const {\n      isSwap,\n      isSend\n    } = this.toModalOptions();\n    if (isSwap(options)) {\n      return ModalController.open({\n        ...options,\n        data: {\n          swap: options.arguments\n        }\n      });\n    } else if (isSend(options)) {\n      if (options.arguments) {\n        return this.openSend(options.arguments);\n      }\n    }\n    return ModalController.open(options);\n  }\n  async close() {\n    await this.injectModalUi();\n    ModalController.close();\n  }\n  setLoading(loading, namespace) {\n    ModalController.setLoading(loading, namespace);\n  }\n  async disconnect(chainNamespace) {\n    await ConnectionController.disconnect({\n      namespace: chainNamespace\n    });\n  }\n  getSIWX() {\n    return OptionsController.state.siwx;\n  }\n  // -- review these -------------------------------------------------------------------\n  getError() {\n    return '';\n  }\n  getChainId() {\n    return ChainController.state.activeCaipNetwork?.id;\n  }\n  async switchNetwork(appKitNetwork, {\n    throwOnFailure = false\n  } = {}) {\n    const network = this.getCaipNetworks().find(n => n.id === appKitNetwork.id);\n    if (!network) {\n      AlertController.open(ErrorUtil.ALERT_ERRORS.SWITCH_NETWORK_NOT_FOUND, 'error');\n      return;\n    }\n    await ChainController.switchActiveNetwork(network, {\n      throwOnFailure\n    });\n  }\n  getWalletProvider() {\n    return ChainController.state.activeChain ? ProviderController.state.providers[ChainController.state.activeChain] : null;\n  }\n  getWalletProviderType() {\n    return ProviderController.getProviderId(ChainController.state.activeChain);\n  }\n  subscribeProviders(callback) {\n    return ProviderController.subscribeProviders(callback);\n  }\n  getThemeMode() {\n    return ThemeController.state.themeMode;\n  }\n  getThemeVariables() {\n    return ThemeController.state.themeVariables;\n  }\n  setThemeMode(themeMode) {\n    ThemeController.setThemeMode(themeMode);\n    setColorTheme(ThemeController.state.themeMode);\n  }\n  setTermsConditionsUrl(termsConditionsUrl) {\n    OptionsController.setTermsConditionsUrl(termsConditionsUrl);\n  }\n  setPrivacyPolicyUrl(privacyPolicyUrl) {\n    OptionsController.setPrivacyPolicyUrl(privacyPolicyUrl);\n  }\n  setThemeVariables(themeVariables) {\n    ThemeController.setThemeVariables(themeVariables);\n    setThemeVariables(ThemeController.state.themeVariables);\n  }\n  subscribeTheme(callback) {\n    return ThemeController.subscribe(callback);\n  }\n  subscribeConnections(callback) {\n    if (!this.remoteFeatures.multiWallet) {\n      AlertController.open(ConstantsUtil.REMOTE_FEATURES_ALERTS.MULTI_WALLET_NOT_ENABLED.DEFAULT, 'info');\n      return () => undefined;\n    }\n    return ConnectionController.subscribe(callback);\n  }\n  getWalletInfo(namespace) {\n    if (namespace) {\n      return ChainController.state.chains.get(namespace)?.accountState?.connectedWalletInfo;\n    }\n    const accountData = ChainController.getAccountData();\n    return accountData?.connectedWalletInfo;\n  }\n  getAccount(_namespace) {\n    const namespace = _namespace || ChainController.state.activeChain;\n    const authConnector = ConnectorController.getAuthConnector(namespace);\n    const accountState = ChainController.getAccountData(namespace);\n    const activeConnectorId = StorageUtil.getConnectedConnectorId(ChainController.state.activeChain);\n    const connections = ConnectionController.getConnections(namespace);\n    if (!namespace) {\n      throw new Error('AppKit:getAccount - namespace is required');\n    }\n    const allAccounts = connections.flatMap(connection => connection.accounts.map(({\n      address,\n      type,\n      publicKey\n    }) => CoreHelperUtil.createAccount(namespace, address, type || 'eoa', publicKey)));\n    if (!accountState) {\n      return undefined;\n    }\n    return {\n      allAccounts,\n      caipAddress: accountState.caipAddress,\n      address: CoreHelperUtil.getPlainAddress(accountState.caipAddress),\n      isConnected: Boolean(accountState.caipAddress),\n      status: accountState.status,\n      embeddedWalletInfo: authConnector && activeConnectorId === ConstantsUtil.CONNECTOR_ID.AUTH ? {\n        user: accountState.user ? {\n          ...accountState.user,\n          /*\n           * Getting the username from the chain controller works well for social logins,\n           * but Farcaster uses a different connection flow and doesn't emit the username via events.\n           * Since the username is stored in local storage before the chain controller updates,\n           * it's safe to use the local storage value here.\n           */\n          username: StorageUtil.getConnectedSocialUsername()\n        } : undefined,\n        authProvider: accountState.socialProvider || 'email',\n        accountType: getPreferredAccountType(namespace),\n        isSmartAccountDeployed: Boolean(accountState.smartAccountDeployed)\n      } : undefined\n    };\n  }\n  subscribeAccount(callback, namespace) {\n    const updateVal = () => {\n      const account = this.getAccount(namespace);\n      if (!account) {\n        return;\n      }\n      callback(account);\n    };\n    if (namespace) {\n      ChainController.subscribeChainProp('accountState', updateVal, namespace);\n    } else {\n      ChainController.subscribe(updateVal);\n    }\n    ConnectorController.subscribe(updateVal);\n  }\n  subscribeNetwork(callback) {\n    return ChainController.subscribe(({\n      activeCaipNetwork\n    }) => {\n      callback({\n        caipNetwork: activeCaipNetwork,\n        chainId: activeCaipNetwork?.id,\n        caipNetworkId: activeCaipNetwork?.caipNetworkId\n      });\n    });\n  }\n  subscribeWalletInfo(callback, namespace) {\n    if (namespace) {\n      return ChainController.subscribeChainProp('accountState', accountState => callback(accountState?.connectedWalletInfo), namespace);\n    }\n    return ChainController.subscribeChainProp('accountState', accountState => callback(accountState?.connectedWalletInfo));\n  }\n  subscribeShouldUpdateToAddress(callback) {\n    ChainController.subscribeChainProp('accountState', accountState => callback(accountState?.shouldUpdateToAddress));\n  }\n  subscribeCaipNetworkChange(callback) {\n    ChainController.subscribeKey('activeCaipNetwork', callback);\n  }\n  getState() {\n    return PublicStateController.state;\n  }\n  getRemoteFeatures() {\n    return OptionsController.state.remoteFeatures;\n  }\n  subscribeState(callback) {\n    return PublicStateController.subscribe(callback);\n  }\n  subscribeRemoteFeatures(callback) {\n    return OptionsController.subscribeKey('remoteFeatures', callback);\n  }\n  showErrorMessage(message) {\n    SnackController.showError(message);\n  }\n  showSuccessMessage(message) {\n    SnackController.showSuccess(message);\n  }\n  getEvent() {\n    return {\n      ...EventsController.state\n    };\n  }\n  subscribeEvents(callback) {\n    return EventsController.subscribe(callback);\n  }\n  replace(route) {\n    RouterController.replace(route);\n  }\n  redirect(route) {\n    RouterController.push(route);\n  }\n  popTransactionStack(status) {\n    RouterController.popTransactionStack(status);\n  }\n  isOpen() {\n    return ModalController.state.open;\n  }\n  isTransactionStackEmpty() {\n    return RouterController.state.transactionStack.length === 0;\n  }\n  static getInstance() {\n    return this.instance;\n  }\n  updateFeatures(newFeatures) {\n    OptionsController.setFeatures(newFeatures);\n  }\n  updateRemoteFeatures(newRemoteFeatures) {\n    OptionsController.setRemoteFeatures(newRemoteFeatures);\n  }\n  updateOptions(newOptions) {\n    const currentOptions = OptionsController.state || {};\n    const updatedOptions = {\n      ...currentOptions,\n      ...newOptions\n    };\n    OptionsController.setOptions(updatedOptions);\n  }\n  setConnectMethodsOrder(connectMethodsOrder) {\n    OptionsController.setConnectMethodsOrder(connectMethodsOrder);\n  }\n  setWalletFeaturesOrder(walletFeaturesOrder) {\n    OptionsController.setWalletFeaturesOrder(walletFeaturesOrder);\n  }\n  setCollapseWallets(collapseWallets) {\n    OptionsController.setCollapseWallets(collapseWallets);\n  }\n  setSocialsOrder(socialsOrder) {\n    OptionsController.setSocialsOrder(socialsOrder);\n  }\n  getConnectMethodsOrder() {\n    return WalletUtil.getConnectOrderMethod(OptionsController.state.features, ConnectorController.getConnectors());\n  }\n  /**\n   * Adds a network to an existing adapter in AppKit.\n   * @param namespace - The chain namespace to add the network to (e.g. 'eip155', 'solana')\n   * @param network - The network configuration to add\n   * @throws Error if adapter for namespace doesn't exist\n   */\n  addNetwork(namespace, network) {\n    if (this.chainAdapters && !this.chainAdapters[namespace]) {\n      throw new Error(`Adapter for namespace ${namespace} doesn't exist`);\n    }\n    const extendedNetwork = this.extendCaipNetwork(network, this.options);\n    if (!this.getCaipNetworks().find(n => n.id === extendedNetwork.id)) {\n      ChainController.addNetwork(extendedNetwork);\n    }\n  }\n  /**\n   * Removes a network from an existing adapter in AppKit.\n   * @param namespace - The chain namespace the network belongs to\n   * @param networkId - The network ID to remove\n   * @throws Error if adapter for namespace doesn't exist or if removing last network\n   */\n  removeNetwork(namespace, networkId) {\n    if (this.chainAdapters && !this.chainAdapters[namespace]) {\n      throw new Error(`Adapter for namespace ${namespace} doesn't exist`);\n    }\n    const networkToRemove = this.getCaipNetworks().find(n => n.id === networkId);\n    if (!networkToRemove) {\n      return;\n    }\n    ChainController.removeNetwork(namespace, networkId);\n  }\n}","map":{"version":3,"names":["UniversalProvider","ConstantsUtil","NetworkUtil","ParseUtil","AlertController","ApiController","AssetUtil","BlockchainApiController","ChainController","ConnectionController","ConnectionControllerUtil","ConnectorController","CoreConstantsUtil","CoreHelperUtil","EnsController","EventsController","ModalController","OnRampController","OptionsController","ProviderController","PublicStateController","RouterController","SIWXUtil","SendController","SnackController","StorageUtil","ThemeController","getPreferredAccountType","WalletUtil","setColorTheme","setThemeVariables","CaipNetworksUtil","ErrorUtil","HelpersUtil","LoggerUtil","SemVerUtils","TokenUtil","UtilConstantsUtil","UniversalAdapter","ConfigUtil","WcConstantsUtil","WcHelpersUtil","AppKitBaseClient","constructor","options","chainNamespaces","features","remoteFeatures","reportedAlertErrors","getCaipNetwork","chainNamespace","id","caipNetworkWithId","getCaipNetworks","find","c","namespaceCaipNetwork","getNetworkData","caipNetwork","requestedCaipNetworks","getRequestedCaipNetworks","filter","state","activeCaipNetwork","defaultCaipNetwork","getCaipNetworkId","network","undefined","namespace","getActiveChainNamespace","activeChain","setRequestedCaipNetworks","chain","getApprovedCaipNetworkIds","getAllApprovedCaipNetworkIds","getCaipAddress","activeCaipAddress","chains","get","accountState","caipAddress","setClientId","clientId","getProvider","getProviderType","getProviderId","setCaipAddress","shouldRefresh","setAccountProp","getPlainAddress","setBalance","balance","balanceSymbol","setProfileName","profileName","setProfileImage","profileImage","setUser","user","resetAccount","setCaipNetwork","setActiveCaipNetwork","setCaipNetworkOfNamespace","setChainNetworkData","setStatus","status","isConnected","setConnectionStatus","getAddressByChainNamespace","getAccountData","address","setConnectors","connectors","allConnectors","setConnections","connections","fetchIdentity","request","getReownName","getNamesForAddress","getConnectors","getConnectorImage","connector","getConnections","multiWallet","open","REMOTE_FEATURES_ALERTS","MULTI_WALLET_NOT_ENABLED","DEFAULT","getConnectionsData","getRecentConnections","recentConnections","switchConnection","params","deleteConnection","deleteAddressFromConnection","syncStorageConnections","setConnectedWalletInfo","connectedWalletInfo","type","walletInfo","getIsConnectedState","Boolean","addAddressLabel","label","addressLabels","removeAddressLabel","getAddress","setApprovedCaipNetworksData","resetNetwork","addConnector","resetWcConnection","setAddressExplorerUrl","addressExplorerUrl","setSmartAccountDeployed","isDeployed","setPreferredAccountType","preferredAccountType","setEIP6963Enabled","enabled","handleUnsafeRPCRequest","isOpen","isTransactionStackEmpty","redirect","view","version","sdkVersion","caipNetworks","extendCaipNetworks","getChainNamespacesSet","adapters","extendDefaultCaipNetwork","chainAdapters","createAdapters","readyPromise","initialize","checkSDKVersion","adapterNamespaces","map","adapter","length","Set","networkNamespaces","initializeProjectSettings","initControllers","initChainAdapters","sendInitializeEvent","enableReconnect","syncExistingConnection","syncAdapterConnections","unSyncExistingConnection","fetchRemoteFeatures","setRemoteFeatures","onramp","setOnrampProviders","email","Array","isArray","socials","checkAllowedOrigins","reownAuthentication","ReownAuthentication","currentSIWX","siwx","console","warn","setSIWX","openSend","args","namespaceToUse","chainId","Error","toString","getCaipNetworkById","switchNetwork","throwOnFailure","symbol","getTokenSymbolByAddress","assetAddress","fetchTokenImages","data","send","Promise","resolve","reject","unsubscribe","subscribeKey","hash","cleanup","unsubscribeModal","subscribe","modal","createCleanupHandler","toModalOptions","isSwap","isSend","allowedOrigins","fetchAllowedOrigins","isClient","currentOrigin","window","location","origin","isOriginAllowed","DEFAULT_ALLOWED_ANCESTORS","ALERT_ERRORS","ORIGIN_NOT_ALLOWED","error","message","RATE_LIMITED_APP_CONFIGURATION","originalError","cause","displayMessage","SERVER_ERROR_APP_CONFIGURATION","debugMessage","unsubscribeFunctions","forEach","optionsCopy","universalProvider","sendEvent","event","properties","networks","n","siweConfig","initializeOptionsController","initializeChainController","initializeThemeController","initializeConnectionController","initializeConnectorController","themeMode","setThemeMode","themeVariables","connectionControllerClient","networkControllerClient","getDefaultNetwork","setWcBasic","basic","setProjectId","projectId","setSdkVersion","setDebug","debug","setEnableWalletGuide","enableWalletGuide","setEnableWallets","enableWallets","enableEIP6963","setEnableNetworkSwitch","enableNetworkSwitch","setEnableReconnect","setEnableMobileFullScreen","enableMobileFullScreen","setEnableAuthLogger","enableAuthLogger","setCustomRpcUrls","customRpcUrls","setEnableEmbedded","enableEmbedded","setAllWallets","allWallets","setIncludeWalletIds","includeWalletIds","setExcludeWalletIds","excludeWalletIds","setFeaturedWalletIds","featuredWalletIds","setTokens","tokens","setTermsConditionsUrl","termsConditionsUrl","setPrivacyPolicyUrl","privacyPolicyUrl","setCustomWallets","customWallets","setFeatures","setAllowUnsupportedChain","allowUnsupportedChain","setUniversalProviderConfigOverride","universalProviderConfigOverride","setPreferUniversalLinks","experimental_preferUniversalLinks","setDefaultAccountTypes","defaultAccountTypes","defaultMetaData","getDefaultMetaData","metadata","setMetadata","setDisableAppend","disableAppend","PROJECT_ID_NOT_CONFIGURED","evmAdapter","CHAIN","EVM","mapToSIWX","name","document","getElementsByTagName","textContent","description","querySelector","content","url","icons","href","setUnsupportedNetwork","unsupportedNetwork","getUnsupportedNetwork","getCaipNetworkFromStorage","extendCaipNetwork","extendedNetwork","customNetworkImageUrls","chainImages","extendedNetworks","defaultNetwork","disconnectConnector","setLoading","disconnectResult","getAdapter","disconnect","createClients","connectWalletConnect","isMultiWallet","hasConnections","result","shouldClose","close","setConnectedNamespaces","keys","syncWalletConnectAccount","initializeIfEnabled","connectExternal","connectResult","onConnectExternal","connectInactiveNamespaces","reconnectExternal","info","provider","reconnect","addConnectedNamespace","syncConnectedWalletInfo","connectorIdParam","initialDisconnect","namespaceConnectorId","getConnectorId","isAuth","CONNECTOR_ID","AUTH","isWalletConnect","WALLET_CONNECT","namespaces","from","namespacesToDisconnect","disconnectPromises","ns","currentConnectorId","connectorIdToDisconnect","disconnectData","deleteConnectedSocialProvider","connection","addDisconnectedConnectorId","connectorId","onDisconnectNamespace","closeModal","disconnectResults","allSettled","resetSend","getSIWX","signOutOnDisconnect","clearSessions","setFilterByNamespace","failures","f","reason","join","checkInstalled","ids","ethereum","some","String","signMessage","signature","sendTransaction","SEND_SUPPORTED_NAMESPACES","includes","estimateGas","gas","getEnsAvatar","syncIdentity","Number","accountData","getEnsAddress","resolveReownName","writeContract","parseUnits","value","decimals","formatUnits","getCapabilities","grantPermissions","revokePermissions","walletGetAssets","updateBalance","updateNativeBalance","switchCaipNetwork","getApprovedCaipNetworksData","setClient","shouldUpdateNetwork","CONNECTOR_TYPE_AUTH","authNamespaces","AUTH_CONNECTOR_SUPPORTED_CHAINS","hasConnectedAuthNamespace","toConnectNetwork","fallbackCaipNetwork","caipNetworkToUse","res","connect","socialUri","rpcUrl","rpcUrls","default","http","syncProvider","removeDisconnectedConnectorId","connectedCaipNetwork","isConnectingToAuth","otherAuthNamespaces","getOtherAuthNamespaces","activeAdapter","activeProvider","all","ALERT_WARNINGS","INACTIVE_NAMESPACE_NOT_CONNECTED","code","providerType","CONNECTOR_TYPE_WALLET_CONNECT","session","supportsAllNetworks","peer","approvedCaipNetworkIds","getChainsFromNamespaces","networkNamespace","namespaceAddress","syncAccount","Object","values","flatMap","accountsChains","accounts","account","parseCaipAddress","blueprints","reduce","blueprint","b","construct","initChainAdapter","onConnectors","listenAdapter","syncConnectors","createUniversalProviderForAdapter","on","bind","connectionStatus","getConnectionStatus","clearAddressCache","caipNetworkId","isSameNamespace","accountAddress","allConnections","flat","handlePreviousConnectorConnection","isActiveChain","namespaceNetworkId","syncAccountChainId","syncAccountInfo","syncBalance","newConnectorId","isMultiWalletEnabled","hasNewConnectorConnected","shouldDisconnectPreviousConnector","getUniversalProvider","setUniversalProvider","syncNamespaceConnection","reconnectWalletConnect","deleteRecentWallet","recentWallet","getRecentWallet","method","isMobile","walletRank","order","isSafeApp","setConnectorId","SAFE","syncAdapterConnection","err","removeConnectedNamespace","removeConnectorId","resetChain","syncConnections","connectToFirstConnector","syncConnection","e","sessionNamespaces","syncTasks","namespaceAccounts","activeChainId","sessionAddress","validateCaipAddress","setProviderId","getWalletConnectProvider","setProvider","isActiveNamespace","networkOfChain","getCaipNetworkByNamespace","getActiveNetworkProps","chainIdToUse","isUnsupportedNetwork","UNSUPPORTED_NETWORK_NAME","shouldSupportAllNetworks","getNetworkProp","caipNetworkIds","parseCaipNetworkId","fallBackCaipNetworkId","deprecatedCaipNetworkId","showUnsupportedChainUI","currentAddress","isLowerCaseMatch","newChainId","split","newCaipAddress","syncReownName","registeredWcNames","wcName","CONNECTOR_TYPE_ANNOUNCED","CONNECTOR_TYPE_INJECTED","isConnectorId","isRdns","rdns","hasMultiChainConnector","_c","imageUrl","icon","COINBASE_SDK","COINBASE","getNetworksByNamespace","ready","getBalance","initializeUniversalAdapter","logger","createLogger","handleAlertError","universalProviderOptions","setManualWCControl","manualWCControl","init","listenWalletConnect","listenWcProvider","onDisplayUri","uri","setUri","onConnect","getAccount","finalizeWcConnection","onDisconnect","noAdapters","onChainChanged","activeNamespace","isCurrentConnectorWalletConnect","activeConnectorIds","currentCaipNetwork","onAccountsChanged","createUniversalProvider","universalProviderInitPromise","errorType","errorMessage","uncaught","getDisabledCaipNetworks","getAllRequestedCaipNetworks","sortedNetworks","sortRequestedNetworks","isCaipNetworkDisabled","matchedUniversalProviderError","entries","UniversalProviderErrors","errorKey","errorValue","alertErrorKey","alertError","createAdapter","adapterBlueprint","push","injectModalUi","swap","arguments","loading","getError","getChainId","appKitNetwork","SWITCH_NETWORK_NOT_FOUND","switchActiveNetwork","getWalletProvider","providers","getWalletProviderType","subscribeProviders","callback","getThemeMode","getThemeVariables","subscribeTheme","subscribeConnections","getWalletInfo","_namespace","authConnector","getAuthConnector","activeConnectorId","getConnectedConnectorId","allAccounts","publicKey","createAccount","embeddedWalletInfo","username","getConnectedSocialUsername","authProvider","socialProvider","accountType","isSmartAccountDeployed","smartAccountDeployed","subscribeAccount","updateVal","subscribeChainProp","subscribeNetwork","subscribeWalletInfo","subscribeShouldUpdateToAddress","shouldUpdateToAddress","subscribeCaipNetworkChange","getState","getRemoteFeatures","subscribeState","subscribeRemoteFeatures","showErrorMessage","showError","showSuccessMessage","showSuccess","getEvent","subscribeEvents","replace","route","popTransactionStack","transactionStack","getInstance","instance","updateFeatures","newFeatures","updateRemoteFeatures","newRemoteFeatures","updateOptions","newOptions","currentOptions","updatedOptions","setOptions","setConnectMethodsOrder","connectMethodsOrder","setWalletFeaturesOrder","walletFeaturesOrder","setCollapseWallets","collapseWallets","setSocialsOrder","socialsOrder","getConnectMethodsOrder","getConnectOrderMethod","addNetwork","removeNetwork","networkId","networkToRemove"],"sources":["../../../../src/client/appkit-base-client.ts"],"sourcesContent":[null],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}