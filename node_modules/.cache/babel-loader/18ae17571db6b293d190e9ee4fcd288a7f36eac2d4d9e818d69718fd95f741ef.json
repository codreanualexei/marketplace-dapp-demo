{"ast":null,"code":"import UniversalProvider from '@walletconnect/universal-provider';\nimport { ConstantsUtil as CommonConstantsUtil, UserRejectedRequestError } from '@reown/appkit-common';\nimport { ChainController, ConnectorController, CoreHelperUtil, getPreferredAccountType } from '@reown/appkit-controllers';\nimport '@reown/appkit-controllers';\nimport { HelpersUtil, PresetsUtil } from '@reown/appkit-utils';\nimport { EthersHelpersUtil } from '@reown/appkit-utils/ethers';\nimport { ConnectionManager } from '../connections/ConnectionManager.js';\nimport { WalletConnectConnector } from '../connectors/WalletConnectConnector.js';\nimport { WcHelpersUtil } from '../utils/index.js';\nconst IGNORED_CONNECTOR_IDS_FOR_LISTENER = [CommonConstantsUtil.CONNECTOR_ID.AUTH, CommonConstantsUtil.CONNECTOR_ID.WALLET_CONNECT];\n/**\n * Abstract class representing a chain adapter blueprint.\n * @template Connector - The type of connector extending ChainAdapterConnector\n */\nexport class AdapterBlueprint {\n  /**\n   * Creates an instance of AdapterBlueprint.\n   * @param {AdapterBlueprint.Params} params - The parameters for initializing the adapter\n   */\n  constructor(params) {\n    this.availableConnectors = [];\n    this.availableConnections = [];\n    this.providerHandlers = {};\n    this.eventListeners = new Map();\n    this.getCaipNetworks = namespace => ChainController.getCaipNetworks(namespace);\n    this.getConnectorId = namespace => ConnectorController.getConnectorId(namespace);\n    if (params) {\n      this.construct(params);\n    }\n    if (params?.namespace) {\n      this.connectionManager = new ConnectionManager({\n        namespace: params.namespace\n      });\n    }\n  }\n  /**\n   * Initializes the adapter with the given parameters.\n   * @param {AdapterBlueprint.Params} params - The parameters for initializing the adapter\n   */\n  construct(params) {\n    this.projectId = params.projectId;\n    this.namespace = params.namespace;\n    this.adapterType = params.adapterType;\n  }\n  /**\n   * Gets the available connectors.\n   * @returns {Connector[]} An array of available connectors\n   */\n  get connectors() {\n    return this.availableConnectors;\n  }\n  /**\n   * Gets the available connections.\n   * @returns {Connection[]} An array of available connections\n   */\n  get connections() {\n    return this.availableConnections;\n  }\n  /**\n   * Gets the supported networks.\n   * @returns {CaipNetwork[]} An array of supported networks\n   */\n  get networks() {\n    return this.getCaipNetworks(this.namespace);\n  }\n  /**\n   * Handles the auth connected event.\n   * @param {W3mFrameTypes.Responses['FrameGetUserResponse']} user - The user response\n   */\n  onAuthConnected({\n    accounts,\n    chainId\n  }) {\n    const caipNetwork = this.getCaipNetworks().filter(n => n.chainNamespace === this.namespace).find(n => n.id.toString() === chainId?.toString());\n    if (accounts && caipNetwork) {\n      this.addConnection({\n        connectorId: CommonConstantsUtil.CONNECTOR_ID.AUTH,\n        accounts,\n        caipNetwork\n      });\n    }\n  }\n  /**\n   * Sets the auth provider.\n   * @param {W3mFrameProvider} authProvider - The auth provider instance\n   */\n  setAuthProvider(authProvider) {\n    authProvider.onConnect(this.onAuthConnected.bind(this));\n    authProvider.onSocialConnected(this.onAuthConnected.bind(this));\n    this.addConnector({\n      id: CommonConstantsUtil.CONNECTOR_ID.AUTH,\n      type: 'AUTH',\n      name: CommonConstantsUtil.CONNECTOR_NAMES.AUTH,\n      provider: authProvider,\n      imageId: PresetsUtil.ConnectorImageIds[CommonConstantsUtil.CONNECTOR_ID.AUTH],\n      chain: this.namespace,\n      chains: []\n    });\n  }\n  /**\n   * Adds one or more connectors to the available connectors list.\n   * @param {...Connector} connectors - The connectors to add\n   */\n  addConnector(...connectors) {\n    const connectorsAdded = new Set();\n    this.availableConnectors = [...connectors, ...this.availableConnectors].filter(connector => {\n      if (connectorsAdded.has(connector.id)) {\n        return false;\n      }\n      connectorsAdded.add(connector.id);\n      return true;\n    });\n    this.emit('connectors', this.availableConnectors);\n  }\n  /**\n   * Adds connections to the available connections list\n   * @param {...Connection} connections - The connections to add\n   */\n  addConnection(...connections) {\n    const connectionsAdded = new Set();\n    this.availableConnections = [...connections, ...this.availableConnections].filter(connection => {\n      if (connectionsAdded.has(connection.connectorId.toLowerCase())) {\n        return false;\n      }\n      connectionsAdded.add(connection.connectorId.toLowerCase());\n      return true;\n    });\n    this.emit('connections', this.availableConnections);\n  }\n  /**\n   * Deletes a connection from the available connections list\n   * @param {string} connectorId - The connector ID of the connection to delete\n   */\n  deleteConnection(connectorId) {\n    this.availableConnections = this.availableConnections.filter(c => !HelpersUtil.isLowerCaseMatch(c.connectorId, connectorId));\n    this.emit('connections', this.availableConnections);\n  }\n  /**\n   * Clears all connections from the available connections list\n   * @param {boolean} emit - Whether to emit the connections event\n   */\n  clearConnections(emit = false) {\n    this.availableConnections = [];\n    if (emit) {\n      this.emit('connections', this.availableConnections);\n    }\n  }\n  setStatus(status, chainNamespace) {\n    ChainController.setAccountProp('status', status, chainNamespace);\n  }\n  /**\n   * Adds an event listener for a specific event.\n   * @template T\n   * @param {T} eventName - The name of the event\n   * @param {EventCallback<T>} callback - The callback function to be called when the event is emitted\n   */\n  on(eventName, callback) {\n    if (!this.eventListeners.has(eventName)) {\n      this.eventListeners.set(eventName, new Set());\n    }\n    this.eventListeners.get(eventName)?.add(callback);\n  }\n  /**\n   * Removes an event listener for a specific event.\n   * @template T\n   * @param {T} eventName - The name of the event\n   * @param {EventCallback<T>} callback - The callback function to be removed\n   */\n  off(eventName, callback) {\n    const listeners = this.eventListeners.get(eventName);\n    if (listeners) {\n      listeners.delete(callback);\n    }\n  }\n  /**\n   * Removes all event listeners.\n   */\n  removeAllEventListeners() {\n    this.eventListeners.forEach(listeners => {\n      listeners.clear();\n    });\n  }\n  /**\n   * Emits an event with the given name and optional data.\n   * @template T\n   * @param {T} eventName - The name of the event to emit\n   * @param {EventData[T]} [data] - The optional data to be passed to the event listeners\n   */\n  emit(eventName, data) {\n    const listeners = this.eventListeners.get(eventName);\n    if (listeners) {\n      listeners.forEach(callback => callback(data));\n    }\n  }\n  /**\n   * Connects to WalletConnect.\n   * @param {number | string} [_chainId] - Optional chain ID to connect to\n   */\n  async connectWalletConnect(_chainId) {\n    try {\n      const connector = this.getWalletConnectConnector();\n      const result = await connector.connectWalletConnect();\n      return {\n        clientId: result.clientId\n      };\n    } catch (err) {\n      if (WcHelpersUtil.isUserRejectedRequestError(err)) {\n        throw new UserRejectedRequestError(err);\n      }\n      throw err;\n    }\n  }\n  /**\n   * Switches the network.\n   * @param {AdapterBlueprint.SwitchNetworkParams} params - Network switching parameters\n   */\n  async switchNetwork(params) {\n    const {\n      caipNetwork,\n      providerType\n    } = params;\n    if (!params.provider) {\n      return;\n    }\n    const provider = 'provider' in params.provider ? params.provider.provider : params.provider;\n    if (providerType === 'WALLET_CONNECT') {\n      ;\n      provider.setDefaultChain(caipNetwork.caipNetworkId);\n      return;\n    }\n    if (provider && providerType === 'AUTH') {\n      const authProvider = provider;\n      const preferredAccountType = getPreferredAccountType(caipNetwork.chainNamespace);\n      await authProvider.switchNetwork({\n        chainId: caipNetwork.caipNetworkId\n      });\n      const user = await authProvider.getUser({\n        chainId: caipNetwork.caipNetworkId,\n        preferredAccountType\n      });\n      this.emit('switchNetwork', user);\n    }\n  }\n  getWalletConnectConnector() {\n    const connector = this.connectors.find(c => c instanceof WalletConnectConnector);\n    if (!connector) {\n      throw new Error('WalletConnectConnector not found');\n    }\n    return connector;\n  }\n  /**\n   * Handles connect event for a specific connector.\n   * @param {string[]} accounts - The accounts that changed\n   * @param {string} connectorId - The ID of the connector\n   */\n  onConnect(accounts, connectorId) {\n    if (accounts.length > 0) {\n      const {\n        address,\n        chainId\n      } = CoreHelperUtil.getAccount(accounts[0]);\n      const caipNetwork = this.getCaipNetworks().filter(n => n.chainNamespace === this.namespace).find(n => n.id.toString() === chainId?.toString());\n      const connector = this.connectors.find(c => c.id === connectorId);\n      if (address) {\n        this.emit('accountChanged', {\n          address,\n          chainId,\n          connector\n        });\n        this.addConnection({\n          connectorId,\n          accounts: accounts.map(_account => {\n            const {\n              address\n            } = CoreHelperUtil.getAccount(_account);\n            return {\n              address: address\n            };\n          }),\n          caipNetwork\n        });\n      }\n    }\n  }\n  /**\n   * Handles accounts changed event for a specific connector.\n   * @param {string[]} accounts - The accounts that changed\n   * @param {string} connectorId - The ID of the connector\n   */\n  onAccountsChanged(accounts, connectorId, disconnectIfNoAccounts = true) {\n    if (accounts.length > 0) {\n      const {\n        address\n      } = CoreHelperUtil.getAccount(accounts[0]);\n      const connection = this.connectionManager?.getConnection({\n        connectorId,\n        connections: this.connections,\n        connectors: this.connectors\n      });\n      if (address && HelpersUtil.isLowerCaseMatch(this.getConnectorId(CommonConstantsUtil.CHAIN.EVM), connectorId)) {\n        this.emit('accountChanged', {\n          address,\n          chainId: connection?.caipNetwork?.id,\n          connector: connection?.connector\n        });\n      }\n      this.addConnection({\n        connectorId,\n        accounts: accounts.map(_account => {\n          const {\n            address\n          } = CoreHelperUtil.getAccount(_account);\n          return {\n            address: address\n          };\n        }),\n        caipNetwork: connection?.caipNetwork\n      });\n    } else if (disconnectIfNoAccounts) {\n      this.onDisconnect(connectorId);\n    }\n  }\n  /**\n   * Handles disconnect event for a specific connector.\n   * @param {string} connectorId - The ID of the connector\n   */\n  onDisconnect(connectorId) {\n    this.removeProviderListeners(connectorId);\n    this.deleteConnection(connectorId);\n    if (HelpersUtil.isLowerCaseMatch(this.getConnectorId(CommonConstantsUtil.CHAIN.EVM), connectorId)) {\n      this.emitFirstAvailableConnection();\n    }\n    if (this.connections.length === 0) {\n      this.emit('disconnect');\n    }\n  }\n  /**\n   * Handles chain changed event for a specific connector.\n   * @param {string} chainId - The ID of the chain that changed\n   * @param {string} connectorId - The ID of the connector\n   */\n  onChainChanged(chainId, connectorId) {\n    const formattedChainId = typeof chainId === 'string' && chainId.startsWith('0x') ? EthersHelpersUtil.hexStringToNumber(chainId).toString() : chainId.toString();\n    const connection = this.connectionManager?.getConnection({\n      connectorId,\n      connections: this.connections,\n      connectors: this.connectors\n    });\n    const caipNetwork = this.getCaipNetworks().filter(n => n.chainNamespace === this.namespace).find(n => n.id.toString() === formattedChainId);\n    if (connection) {\n      this.addConnection({\n        connectorId,\n        accounts: connection.accounts,\n        caipNetwork\n      });\n    }\n    if (HelpersUtil.isLowerCaseMatch(this.getConnectorId(CommonConstantsUtil.CHAIN.EVM), connectorId)) {\n      this.emit('switchNetwork', {\n        chainId: formattedChainId\n      });\n    }\n  }\n  /**\n   * Listens to provider events for a specific connector.\n   * @param {string} connectorId - The ID of the connector\n   * @param {Provider | CombinedProvider} provider - The provider to listen to\n   */\n  listenProviderEvents(connectorId, provider) {\n    if (IGNORED_CONNECTOR_IDS_FOR_LISTENER.includes(connectorId)) {\n      return;\n    }\n    const accountsChangedHandler = accounts => this.onAccountsChanged(accounts, connectorId);\n    const chainChangedHandler = chainId => this.onChainChanged(chainId, connectorId);\n    const disconnectHandler = () => this.onDisconnect(connectorId);\n    if (!this.providerHandlers[connectorId]) {\n      provider.on('disconnect', disconnectHandler);\n      provider.on('accountsChanged', accountsChangedHandler);\n      provider.on('chainChanged', chainChangedHandler);\n      this.providerHandlers[connectorId] = {\n        provider,\n        disconnect: disconnectHandler,\n        accountsChanged: accountsChangedHandler,\n        chainChanged: chainChangedHandler\n      };\n    }\n  }\n  /**\n   * Removes provider listeners for a specific connector.\n   * @param {string} connectorId - The ID of the connector\n   */\n  removeProviderListeners(connectorId) {\n    if (this.providerHandlers[connectorId]) {\n      const {\n        provider,\n        disconnect,\n        accountsChanged,\n        chainChanged\n      } = this.providerHandlers[connectorId];\n      provider.removeListener('disconnect', disconnect);\n      provider.removeListener('accountsChanged', accountsChanged);\n      provider.removeListener('chainChanged', chainChanged);\n      this.providerHandlers[connectorId] = null;\n    }\n  }\n  /**\n   * Emits the first available connection.\n   */\n  emitFirstAvailableConnection() {\n    const connection = this.connectionManager?.getConnection({\n      connections: this.connections,\n      connectors: this.connectors\n    });\n    if (connection) {\n      const [account] = connection.accounts;\n      this.emit('accountChanged', {\n        address: account?.address,\n        chainId: connection.caipNetwork?.id,\n        connector: connection.connector\n      });\n    }\n  }\n}","map":{"version":3,"names":["UniversalProvider","ConstantsUtil","CommonConstantsUtil","UserRejectedRequestError","ChainController","ConnectorController","CoreHelperUtil","getPreferredAccountType","HelpersUtil","PresetsUtil","EthersHelpersUtil","ConnectionManager","WalletConnectConnector","WcHelpersUtil","IGNORED_CONNECTOR_IDS_FOR_LISTENER","CONNECTOR_ID","AUTH","WALLET_CONNECT","AdapterBlueprint","constructor","params","availableConnectors","availableConnections","providerHandlers","eventListeners","Map","getCaipNetworks","namespace","getConnectorId","construct","connectionManager","projectId","adapterType","connectors","connections","networks","onAuthConnected","accounts","chainId","caipNetwork","filter","n","chainNamespace","find","id","toString","addConnection","connectorId","setAuthProvider","authProvider","onConnect","bind","onSocialConnected","addConnector","type","name","CONNECTOR_NAMES","provider","imageId","ConnectorImageIds","chain","chains","connectorsAdded","Set","connector","has","add","emit","connectionsAdded","connection","toLowerCase","deleteConnection","c","isLowerCaseMatch","clearConnections","setStatus","status","setAccountProp","on","eventName","callback","set","get","off","listeners","delete","removeAllEventListeners","forEach","clear","data","connectWalletConnect","_chainId","getWalletConnectConnector","result","clientId","err","isUserRejectedRequestError","switchNetwork","providerType","setDefaultChain","caipNetworkId","preferredAccountType","user","getUser","Error","length","address","getAccount","map","_account","onAccountsChanged","disconnectIfNoAccounts","getConnection","CHAIN","EVM","onDisconnect","removeProviderListeners","emitFirstAvailableConnection","onChainChanged","formattedChainId","startsWith","hexStringToNumber","listenProviderEvents","includes","accountsChangedHandler","chainChangedHandler","disconnectHandler","disconnect","accountsChanged","chainChanged","removeListener","account"],"sources":["../../../../src/adapters/ChainAdapterBlueprint.ts"],"sourcesContent":[null],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}