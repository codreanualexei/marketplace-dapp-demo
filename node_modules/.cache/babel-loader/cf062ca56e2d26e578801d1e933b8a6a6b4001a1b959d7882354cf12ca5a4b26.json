{"ast":null,"code":"import _taggedTemplateLiteral from \"/Users/alex.codreanu/Desktop/marketplace-dapp/node_modules/@babel/runtime/helpers/esm/taggedTemplateLiteral.js\";\nvar _templateObject, _templateObject2, _templateObject3;\nimport QRCodeUtil from 'qrcode';\nimport { svg } from 'lit';\nconst CONNECTING_ERROR_MARGIN = 0.1;\nconst CIRCLE_SIZE_MODIFIER = 2.5;\nconst QRCODE_MATRIX_MARGIN = 7;\nfunction isAdjecentDots(cy, otherCy, cellSize) {\n  if (cy === otherCy) {\n    return false;\n  }\n  const diff = cy - otherCy < 0 ? otherCy - cy : cy - otherCy;\n  return diff <= cellSize + CONNECTING_ERROR_MARGIN;\n}\nfunction getMatrix(value, errorCorrectionLevel) {\n  const arr = Array.prototype.slice.call(QRCodeUtil.create(value, {\n    errorCorrectionLevel\n  }).modules.data, 0);\n  const sqrt = Math.sqrt(arr.length);\n  return arr.reduce((rows, key, index) => (index % sqrt === 0 ? rows.push([key]) : rows[rows.length - 1].push(key)) && rows, []);\n}\nexport const QrCodeUtil = {\n  generate(_ref) {\n    let {\n      uri,\n      size,\n      logoSize,\n      padding = 8,\n      dotColor = 'var(--apkt-colors-black)'\n    } = _ref;\n    const strokeWidth = 10;\n    const dots = [];\n    const matrix = getMatrix(uri, 'Q');\n    const cellSize = (size - 2 * padding) / matrix.length;\n    const qrList = [{\n      x: 0,\n      y: 0\n    }, {\n      x: 1,\n      y: 0\n    }, {\n      x: 0,\n      y: 1\n    }];\n    qrList.forEach(_ref2 => {\n      let {\n        x,\n        y\n      } = _ref2;\n      const x1 = (matrix.length - QRCODE_MATRIX_MARGIN) * cellSize * x + padding;\n      const y1 = (matrix.length - QRCODE_MATRIX_MARGIN) * cellSize * y + padding;\n      const borderRadius = 0.45;\n      for (let i = 0; i < qrList.length; i += 1) {\n        const dotSize = cellSize * (QRCODE_MATRIX_MARGIN - i * 2);\n        dots.push(svg(_templateObject || (_templateObject = _taggedTemplateLiteral([\"\\n            <rect\\n              fill=\", \"\\n              width=\", \"\\n              rx= \", \"\\n              ry= \", \"\\n              stroke=\", \"\\n              stroke-width=\", \"\\n              height=\", \"\\n              x= \", \"\\n              y= \", \"\\n            />\\n          \"])), i === 2 ? 'var(--apkt-colors-black)' : 'var(--apkt-colors-white)', i === 0 ? dotSize - strokeWidth : dotSize, i === 0 ? (dotSize - strokeWidth) * borderRadius : dotSize * borderRadius, i === 0 ? (dotSize - strokeWidth) * borderRadius : dotSize * borderRadius, dotColor, i === 0 ? strokeWidth : 0, i === 0 ? dotSize - strokeWidth : dotSize, i === 0 ? y1 + cellSize * i + strokeWidth / 2 : y1 + cellSize * i, i === 0 ? x1 + cellSize * i + strokeWidth / 2 : x1 + cellSize * i));\n      }\n    });\n    const clearArenaSize = Math.floor((logoSize + 25) / cellSize);\n    const matrixMiddleStart = matrix.length / 2 - clearArenaSize / 2;\n    const matrixMiddleEnd = matrix.length / 2 + clearArenaSize / 2 - 1;\n    const circles = [];\n    matrix.forEach((row, i) => {\n      row.forEach((_, j) => {\n        if (matrix[i][j]) {\n          if (!(i < QRCODE_MATRIX_MARGIN && j < QRCODE_MATRIX_MARGIN || i > matrix.length - (QRCODE_MATRIX_MARGIN + 1) && j < QRCODE_MATRIX_MARGIN || i < QRCODE_MATRIX_MARGIN && j > matrix.length - (QRCODE_MATRIX_MARGIN + 1))) {\n            if (!(i > matrixMiddleStart && i < matrixMiddleEnd && j > matrixMiddleStart && j < matrixMiddleEnd)) {\n              const cx = i * cellSize + cellSize / 2 + padding;\n              const cy = j * cellSize + cellSize / 2 + padding;\n              circles.push([cx, cy]);\n            }\n          }\n        }\n      });\n    });\n    const circlesToConnect = {};\n    circles.forEach(_ref3 => {\n      let [cx, cy] = _ref3;\n      if (circlesToConnect[cx]) {\n        var _circlesToConnect$cx;\n        (_circlesToConnect$cx = circlesToConnect[cx]) === null || _circlesToConnect$cx === void 0 || _circlesToConnect$cx.push(cy);\n      } else {\n        circlesToConnect[cx] = [cy];\n      }\n    });\n    Object.entries(circlesToConnect).map(_ref4 => {\n      let [cx, cys] = _ref4;\n      const newCys = cys.filter(cy => cys.every(otherCy => !isAdjecentDots(cy, otherCy, cellSize)));\n      return [Number(cx), newCys];\n    }).forEach(_ref5 => {\n      let [cx, cys] = _ref5;\n      cys.forEach(cy => {\n        dots.push(svg(_templateObject2 || (_templateObject2 = _taggedTemplateLiteral([\"<circle cx=\", \" cy=\", \" fill=\", \" r=\", \" />\"])), cx, cy, dotColor, cellSize / CIRCLE_SIZE_MODIFIER));\n      });\n    });\n    Object.entries(circlesToConnect).filter(_ref6 => {\n      let [_, cys] = _ref6;\n      return cys.length > 1;\n    }).map(_ref7 => {\n      let [cx, cys] = _ref7;\n      const newCys = cys.filter(cy => cys.some(otherCy => isAdjecentDots(cy, otherCy, cellSize)));\n      return [Number(cx), newCys];\n    }).map(_ref8 => {\n      let [cx, cys] = _ref8;\n      cys.sort((a, b) => a < b ? -1 : 1);\n      const groups = [];\n      for (const cy of cys) {\n        const group = groups.find(item => item.some(otherCy => isAdjecentDots(cy, otherCy, cellSize)));\n        if (group) {\n          group.push(cy);\n        } else {\n          groups.push([cy]);\n        }\n      }\n      return [cx, groups.map(item => [item[0], item[item.length - 1]])];\n    }).forEach(_ref9 => {\n      let [cx, groups] = _ref9;\n      groups.forEach(_ref0 => {\n        let [y1, y2] = _ref0;\n        dots.push(svg(_templateObject3 || (_templateObject3 = _taggedTemplateLiteral([\"\\n              <line\\n                x1=\", \"\\n                x2=\", \"\\n                y1=\", \"\\n                y2=\", \"\\n                stroke=\", \"\\n                stroke-width=\", \"\\n                stroke-linecap=\\\"round\\\"\\n              />\\n            \"])), cx, cx, y1, y2, dotColor, cellSize / (CIRCLE_SIZE_MODIFIER / 2)));\n      });\n    });\n    return dots;\n  }\n};","map":{"version":3,"names":["QRCodeUtil","svg","CONNECTING_ERROR_MARGIN","CIRCLE_SIZE_MODIFIER","QRCODE_MATRIX_MARGIN","isAdjecentDots","cy","otherCy","cellSize","diff","getMatrix","value","errorCorrectionLevel","arr","Array","prototype","slice","call","create","modules","data","sqrt","Math","length","reduce","rows","key","index","push","QrCodeUtil","generate","_ref","uri","size","logoSize","padding","dotColor","strokeWidth","dots","matrix","qrList","x","y","forEach","_ref2","x1","y1","borderRadius","i","dotSize","_templateObject","_taggedTemplateLiteral","clearArenaSize","floor","matrixMiddleStart","matrixMiddleEnd","circles","row","_","j","cx","circlesToConnect","_ref3","_circlesToConnect$cx","Object","entries","map","_ref4","cys","newCys","filter","every","Number","_ref5","_templateObject2","_ref6","_ref7","some","_ref8","sort","a","b","groups","group","find","item","_ref9","_ref0","y2","_templateObject3"],"sources":["../../../../src/utils/QrCode.ts"],"sourcesContent":[null],"mappings":";;AAAA,OAAOA,UAAU,MAAM,QAAQ;AAG/B,SAASC,GAAG,QAAQ,KAAK;AAIzB,MAAMC,uBAAuB,GAAG,GAAG;AACnC,MAAMC,oBAAoB,GAAG,GAAG;AAChC,MAAMC,oBAAoB,GAAG,CAAC;AAE9B,SAASC,cAAcA,CAACC,EAAU,EAAEC,OAAe,EAAEC,QAAgB;EACnE,IAAIF,EAAE,KAAKC,OAAO,EAAE;IAClB,OAAO,KAAK;EACd;EACA,MAAME,IAAI,GAAGH,EAAE,GAAGC,OAAO,GAAG,CAAC,GAAGA,OAAO,GAAGD,EAAE,GAAGA,EAAE,GAAGC,OAAO;EAE3D,OAAOE,IAAI,IAAID,QAAQ,GAAGN,uBAAuB;AACnD;AAEA,SAASQ,SAASA,CAACC,KAAa,EAAEC,oBAA2D;EAC3F,MAAMC,GAAG,GAAGC,KAAK,CAACC,SAAS,CAACC,KAAK,CAACC,IAAI,CACpCjB,UAAU,CAACkB,MAAM,CAACP,KAAK,EAAE;IAAEC;EAAoB,CAAE,CAAC,CAACO,OAAO,CAACC,IAAI,EAC/D,CAAC,CACF;EACD,MAAMC,IAAI,GAAGC,IAAI,CAACD,IAAI,CAACR,GAAG,CAACU,MAAM,CAAC;EAGlC,OAAOV,GAAG,CAACW,MAAM,CACf,CAACC,IAAI,EAAEC,GAAG,EAAEC,KAAK,KAEf,CAACA,KAAK,GAAGN,IAAI,KAAK,CAAC,GAAGI,IAAI,CAACG,IAAI,CAAC,CAACF,GAAG,CAAC,CAAC,GAAGD,IAAI,CAACA,IAAI,CAACF,MAAM,GAAG,CAAC,CAAC,CAACK,IAAI,CAACF,GAAG,CAAC,KAAKD,IAAI,EACnF,EAAE,CACH;AACH;AAEA,OAAO,MAAMI,UAAU,GAAG;EACxBC,QAAQA,CAAAC,IAAA,EAYP;IAAA,IAZQ;MACPC,GAAG;MACHC,IAAI;MACJC,QAAQ;MACRC,OAAO,GAAG,CAAC;MACXC,QAAQ,GAAG;IAA0B,CAOtC,GAAAL,IAAA;IACC,MAAMM,WAAW,GAAG,EAAE;IACtB,MAAMC,IAAI,GAAqB,EAAE;IACjC,MAAMC,MAAM,GAAG7B,SAAS,CAACsB,GAAG,EAAE,GAAG,CAAC;IAClC,MAAMxB,QAAQ,GAAG,CAACyB,IAAI,GAAG,CAAC,GAAGE,OAAO,IAAII,MAAM,CAAChB,MAAM;IACrD,MAAMiB,MAAM,GAAG,CACb;MAAEC,CAAC,EAAE,CAAC;MAAEC,CAAC,EAAE;IAAC,CAAE,EACd;MAAED,CAAC,EAAE,CAAC;MAAEC,CAAC,EAAE;IAAC,CAAE,EACd;MAAED,CAAC,EAAE,CAAC;MAAEC,CAAC,EAAE;IAAC,CAAE,CACf;IAEDF,MAAM,CAACG,OAAO,CAACC,KAAA,IAAa;MAAA,IAAZ;QAAEH,CAAC;QAAEC;MAAC,CAAE,GAAAE,KAAA;MACtB,MAAMC,EAAE,GAAG,CAACN,MAAM,CAAChB,MAAM,GAAGnB,oBAAoB,IAAII,QAAQ,GAAGiC,CAAC,GAAGN,OAAO;MAC1E,MAAMW,EAAE,GAAG,CAACP,MAAM,CAAChB,MAAM,GAAGnB,oBAAoB,IAAII,QAAQ,GAAGkC,CAAC,GAAGP,OAAO;MAC1E,MAAMY,YAAY,GAAG,IAAI;MACzB,KAAK,IAAIC,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGR,MAAM,CAACjB,MAAM,EAAEyB,CAAC,IAAI,CAAC,EAAE;QACzC,MAAMC,OAAO,GAAGzC,QAAQ,IAAIJ,oBAAoB,GAAG4C,CAAC,GAAG,CAAC,CAAC;QACzDV,IAAI,CAACV,IAAI,CACP3B,GAAG,CAAAiD,eAAA,KAAAA,eAAA,GAAAC,sBAAA,gSAEQH,CAAC,KAAK,CAAC,GAAG,0BAA0B,GAAG,0BAA0B,EAChEA,CAAC,KAAK,CAAC,GAAGC,OAAO,GAAGZ,WAAW,GAAGY,OAAO,EAC3CD,CAAC,KAAK,CAAC,GAAG,CAACC,OAAO,GAAGZ,WAAW,IAAIU,YAAY,GAAGE,OAAO,GAAGF,YAAY,EACzEC,CAAC,KAAK,CAAC,GAAG,CAACC,OAAO,GAAGZ,WAAW,IAAIU,YAAY,GAAGE,OAAO,GAAGF,YAAY,EACtEX,QAAQ,EACFY,CAAC,KAAK,CAAC,GAAGX,WAAW,GAAG,CAAC,EAC/BW,CAAC,KAAK,CAAC,GAAGC,OAAO,GAAGZ,WAAW,GAAGY,OAAO,EAC7CD,CAAC,KAAK,CAAC,GAAGF,EAAE,GAAGtC,QAAQ,GAAGwC,CAAC,GAAGX,WAAW,GAAG,CAAC,GAAGS,EAAE,GAAGtC,QAAQ,GAAGwC,CAAC,EACjEA,CAAC,KAAK,CAAC,GAAGH,EAAE,GAAGrC,QAAQ,GAAGwC,CAAC,GAAGX,WAAW,GAAG,CAAC,GAAGQ,EAAE,GAAGrC,QAAQ,GAAGwC,CAAC,CAEzE,CACF;MACH;IACF,CAAC,CAAC;IAEF,MAAMI,cAAc,GAAG9B,IAAI,CAAC+B,KAAK,CAAC,CAACnB,QAAQ,GAAG,EAAE,IAAI1B,QAAQ,CAAC;IAC7D,MAAM8C,iBAAiB,GAAGf,MAAM,CAAChB,MAAM,GAAG,CAAC,GAAG6B,cAAc,GAAG,CAAC;IAChE,MAAMG,eAAe,GAAGhB,MAAM,CAAChB,MAAM,GAAG,CAAC,GAAG6B,cAAc,GAAG,CAAC,GAAG,CAAC;IAClE,MAAMI,OAAO,GAAuB,EAAE;IAGtCjB,MAAM,CAACI,OAAO,CAAC,CAACc,GAAwB,EAAET,CAAS,KAAI;MACrDS,GAAG,CAACd,OAAO,CAAC,CAACe,CAAC,EAAEC,CAAS,KAAI;QAC3B,IAAIpB,MAAM,CAACS,CAAC,CAAC,CAACW,CAAC,CAAC,EAAE;UAChB,IACE,EACGX,CAAC,GAAG5C,oBAAoB,IAAIuD,CAAC,GAAGvD,oBAAoB,IACpD4C,CAAC,GAAGT,MAAM,CAAChB,MAAM,IAAInB,oBAAoB,GAAG,CAAC,CAAC,IAAIuD,CAAC,GAAGvD,oBAAqB,IAC3E4C,CAAC,GAAG5C,oBAAoB,IAAIuD,CAAC,GAAGpB,MAAM,CAAChB,MAAM,IAAInB,oBAAoB,GAAG,CAAC,CAAE,CAC7E,EACD;YACA,IACE,EACE4C,CAAC,GAAGM,iBAAiB,IACrBN,CAAC,GAAGO,eAAe,IACnBI,CAAC,GAAGL,iBAAiB,IACrBK,CAAC,GAAGJ,eAAe,CACpB,EACD;cACA,MAAMK,EAAE,GAAGZ,CAAC,GAAGxC,QAAQ,GAAGA,QAAQ,GAAG,CAAC,GAAG2B,OAAO;cAChD,MAAM7B,EAAE,GAAGqD,CAAC,GAAGnD,QAAQ,GAAGA,QAAQ,GAAG,CAAC,GAAG2B,OAAO;cAChDqB,OAAO,CAAC5B,IAAI,CAAC,CAACgC,EAAE,EAAEtD,EAAE,CAAC,CAAC;YACxB;UACF;QACF;MACF,CAAC,CAAC;IACJ,CAAC,CAAC;IAGF,MAAMuD,gBAAgB,GAA6B,EAAE;IAGrDL,OAAO,CAACb,OAAO,CAACmB,KAAA,IAAa;MAAA,IAAZ,CAACF,EAAE,EAAEtD,EAAE,CAAC,GAAAwD,KAAA;MAEvB,IAAID,gBAAgB,CAACD,EAAE,CAAC,EAAE;QAAA,IAAAG,oBAAA;QACxB,CAAAA,oBAAA,GAAAF,gBAAgB,CAACD,EAAE,CAAC,cAAAG,oBAAA,eAApBA,oBAAA,CAAsBnC,IAAI,CAACtB,EAAE,CAAC;MAChC,CAAC,MAAM;QACLuD,gBAAgB,CAACD,EAAE,CAAC,GAAG,CAACtD,EAAE,CAAC;MAC7B;IACF,CAAC,CAAC;IAGF0D,MAAM,CAACC,OAAO,CAACJ,gBAAgB,CAAC,CAE7BK,GAAG,CAACC,KAAA,IAAc;MAAA,IAAb,CAACP,EAAE,EAAEQ,GAAG,CAAC,GAAAD,KAAA;MACb,MAAME,MAAM,GAAGD,GAAG,CAACE,MAAM,CAAChE,EAAE,IAC1B8D,GAAG,CAACG,KAAK,CAAChE,OAAO,IAAI,CAACF,cAAc,CAACC,EAAE,EAAEC,OAAO,EAAEC,QAAQ,CAAC,CAAC,CAC7D;MAED,OAAO,CAACgE,MAAM,CAACZ,EAAE,CAAC,EAAES,MAAM,CAAsB;IAClD,CAAC,CAAC,CACD1B,OAAO,CAAC8B,KAAA,IAAc;MAAA,IAAb,CAACb,EAAE,EAAEQ,GAAG,CAAC,GAAAK,KAAA;MACjBL,GAAG,CAACzB,OAAO,CAACrC,EAAE,IAAG;QACfgC,IAAI,CAACV,IAAI,CACP3B,GAAG,CAAAyE,gBAAA,KAAAA,gBAAA,GAAAvB,sBAAA,oDAAcS,EAAE,EAAOtD,EAAE,EAAS8B,QAAQ,EAAM5B,QAAQ,GAAGL,oBAAoB,CAAK,CACxF;MACH,CAAC,CAAC;IACJ,CAAC,CAAC;IAGJ6D,MAAM,CAACC,OAAO,CAACJ,gBAAgB,CAAC,CAE7BS,MAAM,CAACK,KAAA;MAAA,IAAC,CAACjB,CAAC,EAAEU,GAAG,CAAC,GAAAO,KAAA;MAAA,OAAKP,GAAG,CAAC7C,MAAM,GAAG,CAAC;IAAA,EAAC,CAEpC2C,GAAG,CAACU,KAAA,IAAc;MAAA,IAAb,CAAChB,EAAE,EAAEQ,GAAG,CAAC,GAAAQ,KAAA;MACb,MAAMP,MAAM,GAAGD,GAAG,CAACE,MAAM,CAAChE,EAAE,IAAI8D,GAAG,CAACS,IAAI,CAACtE,OAAO,IAAIF,cAAc,CAACC,EAAE,EAAEC,OAAO,EAAEC,QAAQ,CAAC,CAAC,CAAC;MAE3F,OAAO,CAACgE,MAAM,CAACZ,EAAE,CAAC,EAAES,MAAM,CAAsB;IAClD,CAAC,CAAC,CAEDH,GAAG,CAACY,KAAA,IAAc;MAAA,IAAb,CAAClB,EAAE,EAAEQ,GAAG,CAAC,GAAAU,KAAA;MACbV,GAAG,CAACW,IAAI,CAAC,CAACC,CAAC,EAAEC,CAAC,KAAMD,CAAC,GAAGC,CAAC,GAAG,CAAC,CAAC,GAAG,CAAE,CAAC;MACpC,MAAMC,MAAM,GAAe,EAAE;MAE7B,KAAK,MAAM5E,EAAE,IAAI8D,GAAG,EAAE;QACpB,MAAMe,KAAK,GAAGD,MAAM,CAACE,IAAI,CAACC,IAAI,IAC5BA,IAAI,CAACR,IAAI,CAACtE,OAAO,IAAIF,cAAc,CAACC,EAAE,EAAEC,OAAO,EAAEC,QAAQ,CAAC,CAAC,CAC5D;QACD,IAAI2E,KAAK,EAAE;UACTA,KAAK,CAACvD,IAAI,CAACtB,EAAE,CAAC;QAChB,CAAC,MAAM;UACL4E,MAAM,CAACtD,IAAI,CAAC,CAACtB,EAAE,CAAC,CAAC;QACnB;MACF;MAEA,OAAO,CAACsD,EAAE,EAAEsB,MAAM,CAAChB,GAAG,CAACmB,IAAI,IAAI,CAACA,IAAI,CAAC,CAAC,CAAC,EAAEA,IAAI,CAACA,IAAI,CAAC9D,MAAM,GAAG,CAAC,CAAC,CAAC,CAAC,CAAyB;IAC3F,CAAC,CAAC,CACDoB,OAAO,CAAC2C,KAAA,IAAiB;MAAA,IAAhB,CAAC1B,EAAE,EAAEsB,MAAM,CAAC,GAAAI,KAAA;MACpBJ,MAAM,CAACvC,OAAO,CAAC4C,KAAA,IAAa;QAAA,IAAZ,CAACzC,EAAE,EAAE0C,EAAE,CAAC,GAAAD,KAAA;QACtBjD,IAAI,CAACV,IAAI,CACP3B,GAAG,CAAAwF,gBAAA,KAAAA,gBAAA,GAAAtC,sBAAA,4QAEMS,EAAE,EACFA,EAAE,EACFd,EAAE,EACF0C,EAAE,EACEpD,QAAQ,EACF5B,QAAQ,IAAIL,oBAAoB,GAAG,CAAC,CAAC,CAGvD,CACF;MACH,CAAC,CAAC;IACJ,CAAC,CAAC;IAEJ,OAAOmC,IAAI;EACb;CACD","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}