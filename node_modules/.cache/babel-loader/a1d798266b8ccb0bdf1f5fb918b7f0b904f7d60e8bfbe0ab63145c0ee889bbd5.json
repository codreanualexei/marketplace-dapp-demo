{"ast":null,"code":"/* eslint-disable no-console */\nimport { proxy, ref, subscribe as sub } from 'valtio/vanilla';\nimport { subscribeKey as subKey } from 'valtio/vanilla/utils';\nimport { ConstantsUtil as CommonConstantsUtil, ParseUtil } from '@reown/appkit-common';\nimport { getPreferredAccountType } from '../utils/ChainControllerUtil.js';\nimport { ConnectionControllerUtil } from '../utils/ConnectionControllerUtil.js';\nimport { ConnectorControllerUtil } from '../utils/ConnectorControllerUtil.js';\nimport { CoreHelperUtil } from '../utils/CoreHelperUtil.js';\nimport { StorageUtil } from '../utils/StorageUtil.js';\nimport { AppKitError, withErrorBoundary } from '../utils/withErrorBoundary.js';\nimport { ChainController } from './ChainController.js';\nimport { ConnectorController } from './ConnectorController.js';\nimport { EventsController } from './EventsController.js';\nimport { ModalController } from './ModalController.js';\nimport { RouterController } from './RouterController.js';\nimport { TransactionsController } from './TransactionsController.js';\n// -- State --------------------------------------------- //\nconst state = proxy({\n  connections: new Map(),\n  recentConnections: new Map(),\n  isSwitchingConnection: false,\n  wcError: false,\n  buffering: false,\n  status: 'disconnected'\n});\n// eslint-disable-next-line init-declarations\nlet wcConnectionPromise;\n// -- Controller ---------------------------------------- //\nconst controller = {\n  state,\n  subscribe(callback) {\n    return sub(state, () => callback(state));\n  },\n  subscribeKey(key, callback) {\n    return subKey(state, key, callback);\n  },\n  _getClient() {\n    return state._client;\n  },\n  setClient(client) {\n    state._client = ref(client);\n  },\n  initialize(adapters) {\n    const namespaces = adapters.filter(a => Boolean(a.namespace)).map(a => a.namespace);\n    ConnectionController.syncStorageConnections(namespaces);\n  },\n  syncStorageConnections(namespaces) {\n    const storageConnections = StorageUtil.getConnections();\n    const namespacesToSync = namespaces !== null && namespaces !== void 0 ? namespaces : Array.from(ChainController.state.chains.keys());\n    for (const namespace of namespacesToSync) {\n      var _storageConnections$n;\n      const storageConnectionsByNamespace = (_storageConnections$n = storageConnections[namespace]) !== null && _storageConnections$n !== void 0 ? _storageConnections$n : [];\n      const recentConnectionsMap = new Map(state.recentConnections);\n      recentConnectionsMap.set(namespace, storageConnectionsByNamespace);\n      state.recentConnections = recentConnectionsMap;\n    }\n  },\n  getConnections(namespace) {\n    var _state$connections$ge;\n    return namespace ? (_state$connections$ge = state.connections.get(namespace)) !== null && _state$connections$ge !== void 0 ? _state$connections$ge : [] : [];\n  },\n  hasAnyConnection(connectorId) {\n    const connections = ConnectionController.state.connections;\n    return Array.from(connections.values()).flatMap(_connections => _connections).some(_ref => {\n      let {\n        connectorId: _connectorId\n      } = _ref;\n      return _connectorId === connectorId;\n    });\n  },\n  async connectWalletConnect() {\n    let {\n      cache = 'auto'\n    } = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n    const isInTelegramOrSafariIos = CoreHelperUtil.isTelegram() || CoreHelperUtil.isSafari() && CoreHelperUtil.isIos();\n    if (cache === 'always' || cache === 'auto' && isInTelegramOrSafariIos) {\n      var _ConnectionController, _ConnectionController2;\n      if (wcConnectionPromise) {\n        await wcConnectionPromise;\n        wcConnectionPromise = undefined;\n        return;\n      }\n      if (!CoreHelperUtil.isPairingExpired(state === null || state === void 0 ? void 0 : state.wcPairingExpiry)) {\n        const link = state.wcUri;\n        state.wcUri = link;\n        return;\n      }\n      wcConnectionPromise = (_ConnectionController = ConnectionController._getClient()) === null || _ConnectionController === void 0 || (_ConnectionController2 = _ConnectionController.connectWalletConnect) === null || _ConnectionController2 === void 0 ? void 0 : _ConnectionController2.call(_ConnectionController).catch(() => undefined);\n      ConnectionController.state.status = 'connecting';\n      await wcConnectionPromise;\n      wcConnectionPromise = undefined;\n      state.wcPairingExpiry = undefined;\n      ConnectionController.state.status = 'connected';\n    } else {\n      var _ConnectionController3, _ConnectionController4;\n      await ((_ConnectionController3 = ConnectionController._getClient()) === null || _ConnectionController3 === void 0 || (_ConnectionController4 = _ConnectionController3.connectWalletConnect) === null || _ConnectionController4 === void 0 ? void 0 : _ConnectionController4.call(_ConnectionController3));\n    }\n  },\n  async connectExternal(options, chain) {\n    var _ConnectionController5, _ConnectionController6;\n    let setChain = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : true;\n    const connectData = await ((_ConnectionController5 = ConnectionController._getClient()) === null || _ConnectionController5 === void 0 || (_ConnectionController6 = _ConnectionController5.connectExternal) === null || _ConnectionController6 === void 0 ? void 0 : _ConnectionController6.call(_ConnectionController5, options));\n    if (setChain) {\n      ChainController.setActiveNamespace(chain);\n    }\n    return connectData;\n  },\n  async reconnectExternal(options) {\n    var _ConnectionController7, _ConnectionController8;\n    await ((_ConnectionController7 = ConnectionController._getClient()) === null || _ConnectionController7 === void 0 || (_ConnectionController8 = _ConnectionController7.reconnectExternal) === null || _ConnectionController8 === void 0 ? void 0 : _ConnectionController8.call(_ConnectionController7, options));\n    const namespace = options.chain || ChainController.state.activeChain;\n    if (namespace) {\n      ConnectorController.setConnectorId(options.id, namespace);\n    }\n  },\n  async setPreferredAccountType(accountType, namespace) {\n    var _ChainController$stat;\n    if (!namespace) {\n      return;\n    }\n    ModalController.setLoading(true, ChainController.state.activeChain);\n    const authConnector = ConnectorController.getAuthConnector();\n    if (!authConnector) {\n      return;\n    }\n    ChainController.setAccountProp('preferredAccountType', accountType, namespace);\n    await authConnector.provider.setPreferredAccount(accountType);\n    StorageUtil.setPreferredAccountTypes(Object.entries(ChainController.state.chains).reduce((acc, _ref2) => {\n      let [key, _] = _ref2;\n      const namespace = key;\n      const accountType = getPreferredAccountType(namespace);\n      if (accountType !== undefined) {\n        ;\n        acc[namespace] = accountType;\n      }\n      return acc;\n    }, {}));\n    await ConnectionController.reconnectExternal(authConnector);\n    ModalController.setLoading(false, ChainController.state.activeChain);\n    EventsController.sendEvent({\n      type: 'track',\n      event: 'SET_PREFERRED_ACCOUNT_TYPE',\n      properties: {\n        accountType,\n        network: ((_ChainController$stat = ChainController.state.activeCaipNetwork) === null || _ChainController$stat === void 0 ? void 0 : _ChainController$stat.caipNetworkId) || ''\n      }\n    });\n  },\n  async signMessage(message) {\n    var _ConnectionController9;\n    return (_ConnectionController9 = ConnectionController._getClient()) === null || _ConnectionController9 === void 0 ? void 0 : _ConnectionController9.signMessage(message);\n  },\n  parseUnits(value, decimals) {\n    var _ConnectionController0;\n    return (_ConnectionController0 = ConnectionController._getClient()) === null || _ConnectionController0 === void 0 ? void 0 : _ConnectionController0.parseUnits(value, decimals);\n  },\n  formatUnits(value, decimals) {\n    var _ConnectionController1;\n    return (_ConnectionController1 = ConnectionController._getClient()) === null || _ConnectionController1 === void 0 ? void 0 : _ConnectionController1.formatUnits(value, decimals);\n  },\n  updateBalance(namespace) {\n    var _ConnectionController10;\n    return (_ConnectionController10 = ConnectionController._getClient()) === null || _ConnectionController10 === void 0 ? void 0 : _ConnectionController10.updateBalance(namespace);\n  },\n  async sendTransaction(args) {\n    var _ConnectionController11;\n    return (_ConnectionController11 = ConnectionController._getClient()) === null || _ConnectionController11 === void 0 ? void 0 : _ConnectionController11.sendTransaction(args);\n  },\n  async getCapabilities(params) {\n    var _ConnectionController12;\n    return (_ConnectionController12 = ConnectionController._getClient()) === null || _ConnectionController12 === void 0 ? void 0 : _ConnectionController12.getCapabilities(params);\n  },\n  async grantPermissions(params) {\n    var _ConnectionController13;\n    return (_ConnectionController13 = ConnectionController._getClient()) === null || _ConnectionController13 === void 0 ? void 0 : _ConnectionController13.grantPermissions(params);\n  },\n  async walletGetAssets(params) {\n    var _ConnectionController14, _ConnectionController15;\n    return (_ConnectionController14 = (_ConnectionController15 = ConnectionController._getClient()) === null || _ConnectionController15 === void 0 ? void 0 : _ConnectionController15.walletGetAssets(params)) !== null && _ConnectionController14 !== void 0 ? _ConnectionController14 : {};\n  },\n  async estimateGas(args) {\n    var _ConnectionController16;\n    return (_ConnectionController16 = ConnectionController._getClient()) === null || _ConnectionController16 === void 0 ? void 0 : _ConnectionController16.estimateGas(args);\n  },\n  async writeContract(args) {\n    var _ConnectionController17;\n    return (_ConnectionController17 = ConnectionController._getClient()) === null || _ConnectionController17 === void 0 ? void 0 : _ConnectionController17.writeContract(args);\n  },\n  async getEnsAddress(value) {\n    var _ConnectionController18;\n    return (_ConnectionController18 = ConnectionController._getClient()) === null || _ConnectionController18 === void 0 ? void 0 : _ConnectionController18.getEnsAddress(value);\n  },\n  async getEnsAvatar(value) {\n    var _ConnectionController19;\n    return (_ConnectionController19 = ConnectionController._getClient()) === null || _ConnectionController19 === void 0 ? void 0 : _ConnectionController19.getEnsAvatar(value);\n  },\n  checkInstalled(ids) {\n    var _ConnectionController20, _ConnectionController21;\n    return ((_ConnectionController20 = ConnectionController._getClient()) === null || _ConnectionController20 === void 0 || (_ConnectionController21 = _ConnectionController20.checkInstalled) === null || _ConnectionController21 === void 0 ? void 0 : _ConnectionController21.call(_ConnectionController20, ids)) || false;\n  },\n  resetWcConnection() {\n    state.wcUri = undefined;\n    state.wcPairingExpiry = undefined;\n    state.wcLinking = undefined;\n    state.recentWallet = undefined;\n    state.status = 'disconnected';\n    TransactionsController.resetTransactions();\n    StorageUtil.deleteWalletConnectDeepLink();\n    StorageUtil.deleteRecentWallet();\n  },\n  resetUri() {\n    state.wcUri = undefined;\n    state.wcPairingExpiry = undefined;\n    wcConnectionPromise = undefined;\n  },\n  finalizeWcConnection(address) {\n    const {\n      wcLinking,\n      recentWallet\n    } = ConnectionController.state;\n    if (wcLinking) {\n      StorageUtil.setWalletConnectDeepLink(wcLinking);\n    }\n    if (recentWallet) {\n      StorageUtil.setAppKitRecent(recentWallet);\n    }\n    if (address) {\n      var _RouterController$sta;\n      EventsController.sendEvent({\n        type: 'track',\n        event: 'CONNECT_SUCCESS',\n        address,\n        properties: {\n          method: wcLinking ? 'mobile' : 'qrcode',\n          name: ((_RouterController$sta = RouterController.state.data) === null || _RouterController$sta === void 0 || (_RouterController$sta = _RouterController$sta.wallet) === null || _RouterController$sta === void 0 ? void 0 : _RouterController$sta.name) || 'Unknown',\n          view: RouterController.state.view,\n          walletRank: recentWallet === null || recentWallet === void 0 ? void 0 : recentWallet.order\n        }\n      });\n    }\n  },\n  setWcBasic(wcBasic) {\n    state.wcBasic = wcBasic;\n  },\n  setUri(uri) {\n    state.wcUri = uri;\n    state.wcPairingExpiry = CoreHelperUtil.getPairingExpiry();\n  },\n  setWcLinking(wcLinking) {\n    state.wcLinking = wcLinking;\n  },\n  setWcError(wcError) {\n    state.wcError = wcError;\n    state.buffering = false;\n  },\n  setRecentWallet(wallet) {\n    state.recentWallet = wallet;\n  },\n  setBuffering(buffering) {\n    state.buffering = buffering;\n  },\n  setStatus(status) {\n    state.status = status;\n  },\n  setIsSwitchingConnection(isSwitchingConnection) {\n    state.isSwitchingConnection = isSwitchingConnection;\n  },\n  async disconnect() {\n    let {\n      id,\n      namespace,\n      initialDisconnect\n    } = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n    try {\n      var _ConnectionController22;\n      await ((_ConnectionController22 = ConnectionController._getClient()) === null || _ConnectionController22 === void 0 ? void 0 : _ConnectionController22.disconnect({\n        id,\n        chainNamespace: namespace,\n        initialDisconnect\n      }));\n    } catch (error) {\n      throw new AppKitError('Failed to disconnect', 'INTERNAL_SDK_ERROR', error);\n    }\n  },\n  async disconnectConnector(_ref3) {\n    let {\n      id,\n      namespace\n    } = _ref3;\n    try {\n      var _ConnectionController23;\n      await ((_ConnectionController23 = ConnectionController._getClient()) === null || _ConnectionController23 === void 0 ? void 0 : _ConnectionController23.disconnectConnector({\n        id,\n        namespace\n      }));\n    } catch (error) {\n      throw new AppKitError('Failed to disconnect connector', 'INTERNAL_SDK_ERROR', error);\n    }\n  },\n  setConnections(connections, chainNamespace) {\n    const connectionsMap = new Map(state.connections);\n    connectionsMap.set(chainNamespace, connections);\n    state.connections = connectionsMap;\n  },\n  async handleAuthAccountSwitch(_ref4) {\n    var _accountData$user;\n    let {\n      address,\n      namespace\n    } = _ref4;\n    const accountData = ChainController.getAccountData(namespace);\n    const smartAccount = accountData === null || accountData === void 0 || (_accountData$user = accountData.user) === null || _accountData$user === void 0 || (_accountData$user = _accountData$user.accounts) === null || _accountData$user === void 0 ? void 0 : _accountData$user.find(c => c.type === 'smartAccount');\n    const accountType = smartAccount && smartAccount.address.toLowerCase() === address.toLowerCase() && ConnectorControllerUtil.canSwitchToSmartAccount(namespace) ? 'smartAccount' : 'eoa';\n    await ConnectionController.setPreferredAccountType(accountType, namespace);\n  },\n  async handleActiveConnection(_ref5) {\n    let {\n      connection,\n      namespace,\n      address\n    } = _ref5;\n    const connector = ConnectorController.getConnectorById(connection.connectorId);\n    const isAuthConnector = connection.connectorId === CommonConstantsUtil.CONNECTOR_ID.AUTH;\n    if (!connector) {\n      throw new Error(\"No connector found for connection: \".concat(connection.connectorId));\n    }\n    if (!isAuthConnector) {\n      const connectData = await ConnectionController.connectExternal({\n        id: connector.id,\n        type: connector.type,\n        provider: connector.provider,\n        address,\n        chain: namespace\n      }, namespace);\n      return connectData === null || connectData === void 0 ? void 0 : connectData.address;\n    } else if (isAuthConnector && address) {\n      await ConnectionController.handleAuthAccountSwitch({\n        address,\n        namespace\n      });\n    }\n    return address;\n  },\n  async handleDisconnectedConnection(_ref6) {\n    var _connection$auth;\n    let {\n      connection,\n      namespace,\n      address,\n      closeModalOnConnect\n    } = _ref6;\n    const connector = ConnectorController.getConnectorById(connection.connectorId);\n    const authName = (_connection$auth = connection.auth) === null || _connection$auth === void 0 || (_connection$auth = _connection$auth.name) === null || _connection$auth === void 0 ? void 0 : _connection$auth.toLowerCase();\n    const isAuthConnector = connection.connectorId === CommonConstantsUtil.CONNECTOR_ID.AUTH;\n    const isWCConnector = connection.connectorId === CommonConstantsUtil.CONNECTOR_ID.WALLET_CONNECT;\n    if (!connector) {\n      throw new Error(\"No connector found for connection: \".concat(connection.connectorId));\n    }\n    let newAddress = undefined;\n    if (isAuthConnector) {\n      if (authName && ConnectorControllerUtil.isSocialProvider(authName)) {\n        const {\n          address: socialAddress\n        } = await ConnectorControllerUtil.connectSocial({\n          social: authName,\n          closeModalOnConnect,\n          onOpenFarcaster() {\n            ModalController.open({\n              view: 'ConnectingFarcaster'\n            });\n          },\n          onConnect() {\n            RouterController.replace('ProfileWallets');\n          }\n        });\n        newAddress = socialAddress;\n      } else {\n        const {\n          address: emailAddress\n        } = await ConnectorControllerUtil.connectEmail({\n          closeModalOnConnect,\n          onOpen() {\n            ModalController.open({\n              view: 'EmailLogin'\n            });\n          },\n          onConnect() {\n            RouterController.replace('ProfileWallets');\n          }\n        });\n        newAddress = emailAddress;\n      }\n    } else if (isWCConnector) {\n      const {\n        address: wcAddress\n      } = await ConnectorControllerUtil.connectWalletConnect({\n        walletConnect: true,\n        connector,\n        closeModalOnConnect,\n        onOpen(isMobile) {\n          const view = isMobile ? 'AllWallets' : 'ConnectingWalletConnect';\n          if (ModalController.state.open) {\n            RouterController.push(view);\n          } else {\n            ModalController.open({\n              view\n            });\n          }\n        },\n        onConnect() {\n          RouterController.replace('ProfileWallets');\n        }\n      });\n      newAddress = wcAddress;\n    } else {\n      const connectData = await ConnectionController.connectExternal({\n        id: connector.id,\n        type: connector.type,\n        provider: connector.provider,\n        chain: namespace\n      }, namespace);\n      if (connectData) {\n        newAddress = connectData.address;\n      }\n    }\n    if (isAuthConnector && address) {\n      await ConnectionController.handleAuthAccountSwitch({\n        address,\n        namespace\n      });\n    }\n    return newAddress;\n  },\n  async switchConnection(_ref7) {\n    var _ChainController$getA;\n    let {\n      connection,\n      address,\n      namespace,\n      closeModalOnConnect,\n      onChange\n    } = _ref7;\n    let currentAddress = undefined;\n    const caipAddress = (_ChainController$getA = ChainController.getAccountData(namespace)) === null || _ChainController$getA === void 0 ? void 0 : _ChainController$getA.caipAddress;\n    if (caipAddress) {\n      const {\n        address: currentAddressParsed\n      } = ParseUtil.parseCaipAddress(caipAddress);\n      currentAddress = currentAddressParsed;\n    }\n    const status = ConnectionControllerUtil.getConnectionStatus(connection, namespace);\n    switch (status) {\n      case 'connected':\n      case 'active':\n        {\n          const newAddress = await ConnectionController.handleActiveConnection({\n            connection,\n            namespace,\n            address\n          });\n          if (currentAddress && newAddress) {\n            const hasSwitchedAccount = newAddress.toLowerCase() !== currentAddress.toLowerCase();\n            onChange === null || onChange === void 0 || onChange({\n              address: newAddress,\n              namespace,\n              hasSwitchedAccount,\n              hasSwitchedWallet: status === 'active'\n            });\n          }\n          break;\n        }\n      case 'disconnected':\n        {\n          const newAddress = await ConnectionController.handleDisconnectedConnection({\n            connection,\n            namespace,\n            address,\n            closeModalOnConnect\n          });\n          if (newAddress) {\n            onChange === null || onChange === void 0 || onChange({\n              address: newAddress,\n              namespace,\n              hasSwitchedAccount: true,\n              hasSwitchedWallet: true\n            });\n          }\n          break;\n        }\n      default:\n        throw new Error(\"Invalid connection status: \".concat(status));\n    }\n  }\n};\n// Export the controller wrapped with our error boundary\nexport const ConnectionController = withErrorBoundary(controller);","map":{"version":3,"names":["proxy","ref","subscribe","sub","subscribeKey","subKey","ConstantsUtil","CommonConstantsUtil","ParseUtil","getPreferredAccountType","ConnectionControllerUtil","ConnectorControllerUtil","CoreHelperUtil","StorageUtil","AppKitError","withErrorBoundary","ChainController","ConnectorController","EventsController","ModalController","RouterController","TransactionsController","state","connections","Map","recentConnections","isSwitchingConnection","wcError","buffering","status","wcConnectionPromise","controller","callback","key","_getClient","_client","setClient","client","initialize","adapters","namespaces","filter","a","Boolean","namespace","map","ConnectionController","syncStorageConnections","storageConnections","getConnections","namespacesToSync","Array","from","chains","keys","_storageConnections$n","storageConnectionsByNamespace","recentConnectionsMap","set","_state$connections$ge","get","hasAnyConnection","connectorId","values","flatMap","_connections","some","_ref","_connectorId","connectWalletConnect","cache","arguments","length","undefined","isInTelegramOrSafariIos","isTelegram","isSafari","isIos","_ConnectionController","_ConnectionController2","isPairingExpired","wcPairingExpiry","link","wcUri","call","catch","_ConnectionController3","_ConnectionController4","connectExternal","options","chain","_ConnectionController5","_ConnectionController6","setChain","connectData","setActiveNamespace","reconnectExternal","_ConnectionController7","_ConnectionController8","activeChain","setConnectorId","id","setPreferredAccountType","accountType","_ChainController$stat","setLoading","authConnector","getAuthConnector","setAccountProp","provider","setPreferredAccount","setPreferredAccountTypes","Object","entries","reduce","acc","_ref2","_","sendEvent","type","event","properties","network","activeCaipNetwork","caipNetworkId","signMessage","message","_ConnectionController9","parseUnits","value","decimals","_ConnectionController0","formatUnits","_ConnectionController1","updateBalance","_ConnectionController10","sendTransaction","args","_ConnectionController11","getCapabilities","params","_ConnectionController12","grantPermissions","_ConnectionController13","walletGetAssets","_ConnectionController14","_ConnectionController15","estimateGas","_ConnectionController16","writeContract","_ConnectionController17","getEnsAddress","_ConnectionController18","getEnsAvatar","_ConnectionController19","checkInstalled","ids","_ConnectionController20","_ConnectionController21","resetWcConnection","wcLinking","recentWallet","resetTransactions","deleteWalletConnectDeepLink","deleteRecentWallet","resetUri","finalizeWcConnection","address","setWalletConnectDeepLink","setAppKitRecent","_RouterController$sta","method","name","data","wallet","view","walletRank","order","setWcBasic","wcBasic","setUri","uri","getPairingExpiry","setWcLinking","setWcError","setRecentWallet","setBuffering","setStatus","setIsSwitchingConnection","disconnect","initialDisconnect","_ConnectionController22","chainNamespace","error","disconnectConnector","_ref3","_ConnectionController23","setConnections","connectionsMap","handleAuthAccountSwitch","_ref4","_accountData$user","accountData","getAccountData","smartAccount","user","accounts","find","c","toLowerCase","canSwitchToSmartAccount","handleActiveConnection","_ref5","connection","connector","getConnectorById","isAuthConnector","CONNECTOR_ID","AUTH","Error","concat","handleDisconnectedConnection","_ref6","_connection$auth","closeModalOnConnect","authName","auth","isWCConnector","WALLET_CONNECT","newAddress","isSocialProvider","socialAddress","connectSocial","social","onOpenFarcaster","open","onConnect","replace","emailAddress","connectEmail","onOpen","wcAddress","walletConnect","isMobile","push","switchConnection","_ref7","_ChainController$getA","onChange","currentAddress","caipAddress","currentAddressParsed","parseCaipAddress","getConnectionStatus","hasSwitchedAccount","hasSwitchedWallet"],"sources":["../../../../src/controllers/ConnectionController.ts"],"sourcesContent":[null],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}