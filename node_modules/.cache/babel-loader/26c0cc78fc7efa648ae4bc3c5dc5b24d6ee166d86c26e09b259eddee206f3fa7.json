{"ast":null,"code":"import { proxy, subscribe as sub } from 'valtio/vanilla';\nimport { proxyMap, subscribeKey as subKey } from 'valtio/vanilla/utils';\nimport { ConstantsUtil as CommonConstantsUtil, NetworkUtil, ParseUtil } from '@reown/appkit-common';\nimport { BalanceUtil } from '../utils/BalanceUtil.js';\nimport { ConstantsUtil } from '../utils/ConstantsUtil.js';\nimport { CoreHelperUtil } from '../utils/CoreHelperUtil.js';\nimport { StorageUtil } from '../utils/StorageUtil.js';\nimport { withErrorBoundary } from '../utils/withErrorBoundary.js';\nimport { ConnectionController } from './ConnectionController.js';\nimport { ConnectorController } from './ConnectorController.js';\nimport { EventsController } from './EventsController.js';\nimport { ModalController } from './ModalController.js';\nimport { OptionsController } from './OptionsController.js';\nimport { PublicStateController } from './PublicStateController.js';\nimport { RouterController } from './RouterController.js';\nimport { SendController } from './SendController.js';\nimport { SnackController } from './SnackController.js';\n// -- Constants ----------------------------------------- //\nconst defaultAccountState = {\n  currentTab: 0,\n  tokenBalance: [],\n  smartAccountDeployed: false,\n  addressLabels: new Map(),\n  user: undefined,\n  preferredAccountType: undefined\n};\nconst networkState = {\n  caipNetwork: undefined,\n  supportsAllNetworks: true,\n  smartAccountEnabledNetworks: []\n};\n// -- State --------------------------------------------- //\nconst state = proxy({\n  chains: proxyMap(),\n  activeCaipAddress: undefined,\n  activeChain: undefined,\n  activeCaipNetwork: undefined,\n  noAdapters: false,\n  universalAdapter: {\n    networkControllerClient: undefined,\n    connectionControllerClient: undefined\n  },\n  isSwitchingNamespace: false\n});\n// -- Controller ---------------------------------------- //\nconst controller = {\n  state,\n  subscribe(callback) {\n    return sub(state, () => {\n      callback(state);\n    });\n  },\n  subscribeKey(key, callback) {\n    return subKey(state, key, callback);\n  },\n  subscribeAccountStateProp(property, callback, chain) {\n    const activeChain = chain || state.activeChain;\n    if (!activeChain) {\n      return () => undefined;\n    }\n    return subKey(state.chains.get(activeChain)?.accountState || {}, property, callback);\n  },\n  subscribeChainProp(property, callback, chain) {\n    let prev = undefined;\n    return sub(state.chains, () => {\n      const activeChain = chain || state.activeChain;\n      if (activeChain) {\n        const nextValue = state.chains.get(activeChain)?.[property];\n        if (prev !== nextValue) {\n          prev = nextValue;\n          callback(nextValue);\n        }\n      }\n    });\n  },\n  initialize(adapters, caipNetworks, clients) {\n    const {\n      chainId: activeChainId,\n      namespace: activeNamespace\n    } = StorageUtil.getActiveNetworkProps();\n    const activeCaipNetwork = caipNetworks?.find(network => network.id.toString() === activeChainId?.toString());\n    const defaultAdapter = adapters.find(adapter => adapter?.namespace === activeNamespace);\n    const adapterToActivate = defaultAdapter || adapters?.[0];\n    const namespacesFromAdapters = adapters.map(a => a.namespace).filter(n => n !== undefined);\n    /**\n     * If the AppKit is in embedded mode (for Demo app), we should get the available namespaces from the adapters.\n     */\n    const namespaces = OptionsController.state.enableEmbedded ? new Set([...namespacesFromAdapters]) : new Set([...(caipNetworks?.map(network => network.chainNamespace) ?? [])]);\n    if (adapters?.length === 0 || !adapterToActivate) {\n      state.noAdapters = true;\n    }\n    if (!state.noAdapters) {\n      state.activeChain = adapterToActivate?.namespace;\n      state.activeCaipNetwork = activeCaipNetwork;\n      ChainController.setChainNetworkData(adapterToActivate?.namespace, {\n        caipNetwork: activeCaipNetwork\n      });\n      if (state.activeChain) {\n        PublicStateController.set({\n          activeChain: adapterToActivate?.namespace\n        });\n      }\n    }\n    namespaces.forEach(namespace => {\n      const namespaceNetworks = caipNetworks?.filter(network => network.chainNamespace === namespace);\n      const storedAccountTypes = StorageUtil.getPreferredAccountTypes() || {};\n      const defaultTypes = {\n        ...OptionsController.state.defaultAccountTypes,\n        ...storedAccountTypes\n      };\n      ChainController.state.chains.set(namespace, {\n        namespace,\n        networkState: proxy({\n          ...networkState,\n          caipNetwork: namespaceNetworks?.[0]\n        }),\n        accountState: proxy({\n          ...defaultAccountState,\n          preferredAccountType: defaultTypes[namespace]\n        }),\n        caipNetworks: namespaceNetworks ?? [],\n        ...clients\n      });\n      ChainController.setRequestedCaipNetworks(namespaceNetworks ?? [], namespace);\n    });\n  },\n  removeAdapter(namespace) {\n    if (state.activeChain === namespace) {\n      const nextAdapter = Array.from(state.chains.entries()).find(([chainNamespace]) => chainNamespace !== namespace);\n      if (nextAdapter) {\n        const caipNetwork = nextAdapter[1]?.caipNetworks?.[0];\n        if (caipNetwork) {\n          ChainController.setActiveCaipNetwork(caipNetwork);\n        }\n      }\n    }\n    state.chains.delete(namespace);\n  },\n  addAdapter(adapter, {\n    networkControllerClient,\n    connectionControllerClient\n  }, caipNetworks) {\n    if (!adapter.namespace) {\n      throw new Error('ChainController:addAdapter - adapter must have a namespace');\n    }\n    state.chains.set(adapter.namespace, {\n      namespace: adapter.namespace,\n      networkState: {\n        ...networkState,\n        caipNetwork: caipNetworks[0]\n      },\n      accountState: {\n        ...defaultAccountState\n      },\n      caipNetworks,\n      connectionControllerClient,\n      networkControllerClient\n    });\n    ChainController.setRequestedCaipNetworks(caipNetworks?.filter(caipNetwork => caipNetwork.chainNamespace === adapter.namespace) ?? [], adapter.namespace);\n  },\n  addNetwork(network) {\n    const chainAdapter = state.chains.get(network.chainNamespace);\n    if (chainAdapter) {\n      const newNetworks = [...(chainAdapter.caipNetworks || [])];\n      if (!chainAdapter.caipNetworks?.find(caipNetwork => caipNetwork.id === network.id)) {\n        newNetworks.push(network);\n      }\n      state.chains.set(network.chainNamespace, {\n        ...chainAdapter,\n        caipNetworks: newNetworks\n      });\n      ChainController.setRequestedCaipNetworks(newNetworks, network.chainNamespace);\n      ConnectorController.filterByNamespace(network.chainNamespace, true);\n    }\n  },\n  removeNetwork(namespace, networkId) {\n    const chainAdapter = state.chains.get(namespace);\n    if (chainAdapter) {\n      // Check if network being removed is active network\n      const isActiveNetwork = state.activeCaipNetwork?.id === networkId;\n      // Filter out the network being removed\n      const newCaipNetworksOfAdapter = [...(chainAdapter.caipNetworks?.filter(network => network.id !== networkId) || [])];\n      // If active network was removed and there are other networks available, switch to first one\n      if (isActiveNetwork && chainAdapter?.caipNetworks?.[0]) {\n        ChainController.setActiveCaipNetwork(chainAdapter.caipNetworks[0]);\n      }\n      state.chains.set(namespace, {\n        ...chainAdapter,\n        caipNetworks: newCaipNetworksOfAdapter\n      });\n      ChainController.setRequestedCaipNetworks(newCaipNetworksOfAdapter || [], namespace);\n      if (newCaipNetworksOfAdapter.length === 0) {\n        ConnectorController.filterByNamespace(namespace, false);\n      }\n    }\n  },\n  setAdapterNetworkState(chain, props) {\n    const chainAdapter = state.chains.get(chain);\n    if (chainAdapter) {\n      chainAdapter.networkState = {\n        ...(chainAdapter.networkState || networkState),\n        ...props\n      };\n      state.chains.set(chain, chainAdapter);\n    }\n  },\n  setChainAccountData(chain, accountProps, _unknown = true) {\n    if (!chain) {\n      throw new Error('Chain is required to update chain account data');\n    }\n    const chainAdapter = state.chains.get(chain);\n    if (chainAdapter) {\n      const newAccountState = {\n        ...(chainAdapter.accountState || defaultAccountState),\n        ...accountProps\n      };\n      state.chains.set(chain, {\n        ...chainAdapter,\n        accountState: newAccountState\n      });\n      if (state.chains.size === 1 || state.activeChain === chain) {\n        if (accountProps.caipAddress) {\n          state.activeCaipAddress = accountProps.caipAddress;\n        }\n      }\n    }\n  },\n  setChainNetworkData(chain, networkProps) {\n    if (!chain) {\n      return;\n    }\n    const chainAdapter = state.chains.get(chain);\n    if (chainAdapter) {\n      const newNetworkState = {\n        ...(chainAdapter.networkState || networkState),\n        ...networkProps\n      };\n      state.chains.set(chain, {\n        ...chainAdapter,\n        networkState: newNetworkState\n      });\n    }\n  },\n  // eslint-disable-next-line max-params\n  setAccountProp(prop, value, chain, replaceState = true) {\n    ChainController.setChainAccountData(chain, {\n      [prop]: value\n    }, replaceState);\n  },\n  setActiveNamespace(chain) {\n    state.activeChain = chain;\n    const newAdapter = chain ? state.chains.get(chain) : undefined;\n    const caipNetwork = newAdapter?.networkState?.caipNetwork;\n    if (caipNetwork?.id && chain) {\n      state.activeCaipAddress = newAdapter?.accountState?.caipAddress;\n      state.activeCaipNetwork = caipNetwork;\n      ChainController.setChainNetworkData(chain, {\n        caipNetwork\n      });\n      StorageUtil.setActiveCaipNetworkId(caipNetwork?.caipNetworkId);\n      PublicStateController.set({\n        activeChain: chain,\n        selectedNetworkId: caipNetwork?.caipNetworkId\n      });\n    }\n  },\n  setActiveCaipNetwork(caipNetwork) {\n    if (!caipNetwork) {\n      return;\n    }\n    const isSameNamespace = state.activeChain === caipNetwork.chainNamespace;\n    if (!isSameNamespace) {\n      ChainController.setIsSwitchingNamespace(true);\n    }\n    const newAdapter = state.chains.get(caipNetwork.chainNamespace);\n    state.activeChain = caipNetwork.chainNamespace;\n    state.activeCaipNetwork = caipNetwork;\n    ChainController.setChainNetworkData(caipNetwork.chainNamespace, {\n      caipNetwork\n    });\n    let address = newAdapter?.accountState?.address;\n    if (address) {\n      state.activeCaipAddress = `${caipNetwork.chainNamespace}:${caipNetwork.id}:${address}`;\n    } else if (isSameNamespace && state.activeCaipAddress) {\n      const {\n        address: parsedAddress\n      } = ParseUtil.parseCaipAddress(state.activeCaipAddress);\n      address = parsedAddress;\n      state.activeCaipAddress = `${caipNetwork.caipNetworkId}:${address}`;\n    } else {\n      state.activeCaipAddress = undefined;\n    }\n    ChainController.setChainAccountData(caipNetwork.chainNamespace, {\n      address,\n      caipAddress: state.activeCaipAddress\n    });\n    // Reset send state when switching networks\n    SendController.resetSend();\n    PublicStateController.set({\n      activeChain: state.activeChain,\n      selectedNetworkId: state.activeCaipNetwork?.caipNetworkId\n    });\n    StorageUtil.setActiveCaipNetworkId(caipNetwork.caipNetworkId);\n    const isSupported = ChainController.checkIfSupportedNetwork(caipNetwork.chainNamespace);\n    if (!isSupported && OptionsController.state.enableNetworkSwitch && !OptionsController.state.allowUnsupportedChain && !ConnectionController.state.wcBasic) {\n      ChainController.showUnsupportedChainUI();\n    }\n  },\n  addCaipNetwork(caipNetwork) {\n    if (!caipNetwork) {\n      return;\n    }\n    const chain = state.chains.get(caipNetwork.chainNamespace);\n    if (chain) {\n      chain?.caipNetworks?.push(caipNetwork);\n    }\n  },\n  async switchActiveNamespace(namespace) {\n    if (!namespace) {\n      return;\n    }\n    const isDifferentChain = namespace !== ChainController.state.activeChain;\n    const caipNetworkOfNamespace = ChainController.getNetworkData(namespace)?.caipNetwork;\n    const firstNetworkWithChain = ChainController.getCaipNetworkByNamespace(namespace, caipNetworkOfNamespace?.id);\n    if (isDifferentChain && firstNetworkWithChain) {\n      await ChainController.switchActiveNetwork(firstNetworkWithChain);\n    }\n  },\n  async switchActiveNetwork(network, {\n    throwOnFailure = false\n  } = {}) {\n    const namespace = ChainController.state.activeChain;\n    if (!namespace) {\n      throw new Error('ChainController:switchActiveNetwork - namespace is required');\n    }\n    const activeAdapter = ChainController.state.chains.get(namespace);\n    const unsupportedNetwork = !activeAdapter?.caipNetworks?.some(caipNetwork => caipNetwork.id === state.activeCaipNetwork?.id);\n    const networkControllerClient = ChainController.getNetworkControllerClient(network.chainNamespace);\n    if (networkControllerClient) {\n      try {\n        await networkControllerClient.switchCaipNetwork(network);\n        if (unsupportedNetwork) {\n          ModalController.close();\n        }\n      } catch (error) {\n        if (throwOnFailure) {\n          throw error;\n        }\n        RouterController.goBack();\n      }\n      EventsController.sendEvent({\n        type: 'track',\n        event: 'SWITCH_NETWORK',\n        properties: {\n          network: network.caipNetworkId\n        }\n      });\n    }\n  },\n  getNetworkControllerClient(chainNamespace) {\n    const chain = chainNamespace || state.activeChain;\n    if (!chain) {\n      throw new Error('ChainController:getNetworkControllerClient - chain is required');\n    }\n    const chainAdapter = state.chains.get(chain);\n    if (!chainAdapter) {\n      throw new Error('Chain adapter not found');\n    }\n    if (!chainAdapter.networkControllerClient) {\n      throw new Error('NetworkController client not set');\n    }\n    return chainAdapter.networkControllerClient;\n  },\n  getConnectionControllerClient(_chain) {\n    const chain = _chain || state.activeChain;\n    if (!chain) {\n      throw new Error('Chain is required to get connection controller client');\n    }\n    const chainAdapter = state.chains.get(chain);\n    if (!chainAdapter?.connectionControllerClient) {\n      throw new Error('ConnectionController client not set');\n    }\n    return chainAdapter.connectionControllerClient;\n  },\n  getNetworkProp(key, namespace) {\n    const chainNetworkState = state.chains.get(namespace)?.networkState;\n    if (!chainNetworkState) {\n      return undefined;\n    }\n    return chainNetworkState[key];\n  },\n  getRequestedCaipNetworks(chainToFilter) {\n    const adapter = state.chains.get(chainToFilter);\n    const {\n      approvedCaipNetworkIds = [],\n      requestedCaipNetworks = []\n    } = adapter?.networkState || {};\n    const sortedNetworks = CoreHelperUtil.sortRequestedNetworks(approvedCaipNetworkIds, requestedCaipNetworks);\n    const filteredNetworks = sortedNetworks.filter(network => network?.id);\n    return filteredNetworks;\n  },\n  getAllRequestedCaipNetworks() {\n    const requestedCaipNetworks = [];\n    state.chains.forEach(chainAdapter => {\n      if (!chainAdapter.namespace) {\n        throw new Error('ChainController:getAllRequestedCaipNetworks - chainAdapter must have a namespace');\n      }\n      const caipNetworks = ChainController.getRequestedCaipNetworks(chainAdapter.namespace);\n      requestedCaipNetworks.push(...caipNetworks);\n    });\n    return requestedCaipNetworks;\n  },\n  setRequestedCaipNetworks(caipNetworks, chain) {\n    ChainController.setAdapterNetworkState(chain, {\n      requestedCaipNetworks: caipNetworks\n    });\n    const allRequestedCaipNetworks = ChainController.getAllRequestedCaipNetworks();\n    const namespaces = allRequestedCaipNetworks.map(network => network.chainNamespace);\n    const uniqueNamespaces = Array.from(new Set(namespaces));\n    ConnectorController.filterByNamespaces(uniqueNamespaces);\n  },\n  getAllApprovedCaipNetworkIds() {\n    const approvedCaipNetworkIds = [];\n    state.chains.forEach(chainAdapter => {\n      if (!chainAdapter.namespace) {\n        throw new Error('ChainController:getAllApprovedCaipNetworkIds - chainAdapter must have a namespace');\n      }\n      const approvedIds = ChainController.getApprovedCaipNetworkIds(chainAdapter.namespace);\n      approvedCaipNetworkIds.push(...approvedIds);\n    });\n    return approvedCaipNetworkIds;\n  },\n  getActiveCaipNetwork(chainNamespace) {\n    if (chainNamespace) {\n      return state.chains.get(chainNamespace)?.networkState?.caipNetwork;\n    }\n    return state.activeCaipNetwork;\n  },\n  getActiveCaipAddress() {\n    return state.activeCaipAddress;\n  },\n  getApprovedCaipNetworkIds(namespace) {\n    const adapter = state.chains.get(namespace);\n    const approvedCaipNetworkIds = adapter?.networkState?.approvedCaipNetworkIds || [];\n    return approvedCaipNetworkIds;\n  },\n  async setApprovedCaipNetworksData(namespace) {\n    const networkControllerClient = ChainController.getNetworkControllerClient();\n    const data = await networkControllerClient?.getApprovedCaipNetworksData();\n    ChainController.setAdapterNetworkState(namespace, {\n      approvedCaipNetworkIds: data?.approvedCaipNetworkIds,\n      supportsAllNetworks: data?.supportsAllNetworks\n    });\n  },\n  checkIfSupportedNetwork(namespace, caipNetworkId) {\n    const activeCaipNetworkId = caipNetworkId || state.activeCaipNetwork?.caipNetworkId;\n    const requestedCaipNetworks = ChainController.getRequestedCaipNetworks(namespace);\n    if (!requestedCaipNetworks.length) {\n      return true;\n    }\n    return requestedCaipNetworks?.some(network => network.caipNetworkId === activeCaipNetworkId);\n  },\n  checkIfSupportedChainId(chainId) {\n    if (!state.activeChain) {\n      return true;\n    }\n    const requestedCaipNetworks = ChainController.getRequestedCaipNetworks(state.activeChain);\n    return requestedCaipNetworks?.some(network => network.id === chainId);\n  },\n  // Smart Account Network Handlers\n  setSmartAccountEnabledNetworks(smartAccountEnabledNetworks, chain) {\n    ChainController.setAdapterNetworkState(chain, {\n      smartAccountEnabledNetworks\n    });\n  },\n  checkIfSmartAccountEnabled() {\n    const networkId = NetworkUtil.caipNetworkIdToNumber(state.activeCaipNetwork?.caipNetworkId);\n    const activeChain = state.activeChain;\n    if (!activeChain || !networkId) {\n      return false;\n    }\n    const smartAccountEnabledNetworks = ChainController.getNetworkProp('smartAccountEnabledNetworks', activeChain);\n    return Boolean(smartAccountEnabledNetworks?.includes(Number(networkId)));\n  },\n  showUnsupportedChainUI() {\n    ModalController.open({\n      view: 'UnsupportedChain'\n    });\n  },\n  checkIfNamesSupported() {\n    const activeCaipNetwork = state.activeCaipNetwork;\n    return Boolean(activeCaipNetwork?.chainNamespace && ConstantsUtil.NAMES_SUPPORTED_CHAIN_NAMESPACES.includes(activeCaipNetwork.chainNamespace));\n  },\n  resetNetwork(namespace) {\n    ChainController.setAdapterNetworkState(namespace, {\n      approvedCaipNetworkIds: undefined,\n      supportsAllNetworks: true\n    });\n  },\n  resetAccount(chain) {\n    const chainToWrite = chain;\n    if (!chainToWrite) {\n      throw new Error('Chain is required to set account prop');\n    }\n    const currentAccountType = ChainController.state.chains.get(chainToWrite)?.accountState?.preferredAccountType;\n    const optionsAccountType = OptionsController.state.defaultAccountTypes[chainToWrite];\n    state.activeCaipAddress = undefined;\n    ChainController.setChainAccountData(chainToWrite, {\n      smartAccountDeployed: false,\n      currentTab: 0,\n      caipAddress: undefined,\n      address: undefined,\n      balance: undefined,\n      balanceSymbol: undefined,\n      profileName: undefined,\n      profileImage: undefined,\n      addressExplorerUrl: undefined,\n      tokenBalance: [],\n      connectedWalletInfo: undefined,\n      preferredAccountType: optionsAccountType || currentAccountType,\n      socialProvider: undefined,\n      socialWindow: undefined,\n      farcasterUrl: undefined,\n      user: undefined,\n      status: 'disconnected'\n    });\n    ConnectorController.removeConnectorId(chainToWrite);\n  },\n  setIsSwitchingNamespace(isSwitchingNamespace) {\n    state.isSwitchingNamespace = isSwitchingNamespace;\n  },\n  getFirstCaipNetworkSupportsAuthConnector() {\n    const availableChains = [];\n    let firstCaipNetwork = undefined;\n    state.chains.forEach(chain => {\n      if (CommonConstantsUtil.AUTH_CONNECTOR_SUPPORTED_CHAINS.find(ns => ns === chain.namespace)) {\n        if (chain.namespace) {\n          availableChains.push(chain.namespace);\n        }\n      }\n    });\n    if (availableChains.length > 0) {\n      const firstAvailableChain = availableChains[0];\n      firstCaipNetwork = firstAvailableChain ? state.chains.get(firstAvailableChain)?.caipNetworks?.[0] : undefined;\n      return firstCaipNetwork;\n    }\n    return undefined;\n  },\n  getAccountData(chainNamespace) {\n    const namespace = chainNamespace || state.activeChain;\n    if (!namespace) {\n      return undefined;\n    }\n    return ChainController.state.chains.get(namespace)?.accountState;\n  },\n  getNetworkData(chainNamespace) {\n    const namespace = chainNamespace || state.activeChain;\n    if (!namespace) {\n      return undefined;\n    }\n    return ChainController.state.chains.get(namespace)?.networkState;\n  },\n  getCaipNetworkByNamespace(chainNamespace, chainId) {\n    if (!chainNamespace) {\n      return undefined;\n    }\n    const chain = ChainController.state.chains.get(chainNamespace);\n    const byChainId = chain?.caipNetworks?.find(network => network.id === chainId);\n    if (byChainId) {\n      return byChainId;\n    }\n    return chain?.networkState?.caipNetwork || chain?.caipNetworks?.[0];\n  },\n  /**\n   * Get the requested CaipNetwork IDs for a given namespace. If namespace is not provided, all requested CaipNetwork IDs will be returned\n   * @param namespace - The namespace to get the requested CaipNetwork IDs for\n   * @returns The requested CaipNetwork IDs\n   */\n  getRequestedCaipNetworkIds() {\n    const namespace = ConnectorController.state.filterByNamespace;\n    const chains = namespace ? [state.chains.get(namespace)] : Array.from(state.chains.values());\n    return chains.flatMap(chain => chain?.caipNetworks || []).map(caipNetwork => caipNetwork.caipNetworkId);\n  },\n  getCaipNetworks(namespace) {\n    if (namespace) {\n      return ChainController.getRequestedCaipNetworks(namespace);\n    }\n    return ChainController.getAllRequestedCaipNetworks();\n  },\n  getCaipNetworkById(id, namespace) {\n    return controller.getCaipNetworks(namespace).find(n => n.id.toString() === id.toString() || n.caipNetworkId.toString() === id.toString());\n  },\n  setLastConnectedSIWECaipNetwork(network) {\n    state.lastConnectedSIWECaipNetwork = network;\n  },\n  getLastConnectedSIWECaipNetwork() {\n    return state.lastConnectedSIWECaipNetwork;\n  },\n  async fetchTokenBalance(onError) {\n    const accountState = ChainController.getAccountData();\n    if (!accountState) {\n      return [];\n    }\n    const chainId = ChainController.state.activeCaipNetwork?.caipNetworkId;\n    const chain = ChainController.state.activeCaipNetwork?.chainNamespace;\n    const caipAddress = ChainController.state.activeCaipAddress;\n    const address = caipAddress ? CoreHelperUtil.getPlainAddress(caipAddress) : undefined;\n    ChainController.setAccountProp('balanceLoading', true, chain);\n    if (accountState.lastRetry && !CoreHelperUtil.isAllowedRetry(accountState.lastRetry, 30 * ConstantsUtil.ONE_SEC_MS)) {\n      ChainController.setAccountProp('balanceLoading', false, chain);\n      return [];\n    }\n    try {\n      if (address && chainId && chain) {\n        const balance = await BalanceUtil.getMyTokensWithBalance();\n        ChainController.setAccountProp('tokenBalance', balance, chain);\n        ChainController.setAccountProp('lastRetry', undefined, chain);\n        ChainController.setAccountProp('balanceLoading', false, chain);\n        return balance;\n      }\n    } catch (error) {\n      ChainController.setAccountProp('lastRetry', Date.now(), chain);\n      onError?.(error);\n      SnackController.showError('Token Balance Unavailable');\n    } finally {\n      ChainController.setAccountProp('balanceLoading', false, chain);\n    }\n    return [];\n  },\n  isCaipNetworkDisabled(network) {\n    const networkNamespace = network.chainNamespace;\n    const isNextNamespaceConnected = Boolean(ChainController.getAccountData(networkNamespace)?.caipAddress);\n    const approvedCaipNetworkIds = ChainController.getAllApprovedCaipNetworkIds();\n    const shouldSupportAllNetworks = ChainController.getNetworkProp('supportsAllNetworks', networkNamespace) !== false;\n    const connectorId = ConnectorController.getConnectorId(networkNamespace);\n    const authConnector = ConnectorController.getAuthConnector();\n    const isConnectedWithAuth = connectorId === CommonConstantsUtil.CONNECTOR_ID.AUTH && authConnector;\n    if (!isNextNamespaceConnected || shouldSupportAllNetworks || isConnectedWithAuth) {\n      return false;\n    }\n    return !approvedCaipNetworkIds?.includes(network.caipNetworkId);\n  }\n};\n// Export the controller wrapped with our error boundary\nexport const ChainController = withErrorBoundary(controller);","map":{"version":3,"names":["proxy","subscribe","sub","proxyMap","subscribeKey","subKey","ConstantsUtil","CommonConstantsUtil","NetworkUtil","ParseUtil","BalanceUtil","CoreHelperUtil","StorageUtil","withErrorBoundary","ConnectionController","ConnectorController","EventsController","ModalController","OptionsController","PublicStateController","RouterController","SendController","SnackController","defaultAccountState","currentTab","tokenBalance","smartAccountDeployed","addressLabels","Map","user","undefined","preferredAccountType","networkState","caipNetwork","supportsAllNetworks","smartAccountEnabledNetworks","state","chains","activeCaipAddress","activeChain","activeCaipNetwork","noAdapters","universalAdapter","networkControllerClient","connectionControllerClient","isSwitchingNamespace","controller","callback","key","subscribeAccountStateProp","property","chain","get","accountState","subscribeChainProp","prev","nextValue","initialize","adapters","caipNetworks","clients","chainId","activeChainId","namespace","activeNamespace","getActiveNetworkProps","find","network","id","toString","defaultAdapter","adapter","adapterToActivate","namespacesFromAdapters","map","a","filter","n","namespaces","enableEmbedded","Set","chainNamespace","length","ChainController","setChainNetworkData","set","forEach","namespaceNetworks","storedAccountTypes","getPreferredAccountTypes","defaultTypes","defaultAccountTypes","setRequestedCaipNetworks","removeAdapter","nextAdapter","Array","from","entries","setActiveCaipNetwork","delete","addAdapter","Error","addNetwork","chainAdapter","newNetworks","push","filterByNamespace","removeNetwork","networkId","isActiveNetwork","newCaipNetworksOfAdapter","setAdapterNetworkState","props","setChainAccountData","accountProps","_unknown","newAccountState","size","caipAddress","networkProps","newNetworkState","setAccountProp","prop","value","replaceState","setActiveNamespace","newAdapter","setActiveCaipNetworkId","caipNetworkId","selectedNetworkId","isSameNamespace","setIsSwitchingNamespace","address","parsedAddress","parseCaipAddress","resetSend","isSupported","checkIfSupportedNetwork","enableNetworkSwitch","allowUnsupportedChain","wcBasic","showUnsupportedChainUI","addCaipNetwork","switchActiveNamespace","isDifferentChain","caipNetworkOfNamespace","getNetworkData","firstNetworkWithChain","getCaipNetworkByNamespace","switchActiveNetwork","throwOnFailure","activeAdapter","unsupportedNetwork","some","getNetworkControllerClient","switchCaipNetwork","close","error","goBack","sendEvent","type","event","properties","getConnectionControllerClient","_chain","getNetworkProp","chainNetworkState","getRequestedCaipNetworks","chainToFilter","approvedCaipNetworkIds","requestedCaipNetworks","sortedNetworks","sortRequestedNetworks","filteredNetworks","getAllRequestedCaipNetworks","allRequestedCaipNetworks","uniqueNamespaces","filterByNamespaces","getAllApprovedCaipNetworkIds","approvedIds","getApprovedCaipNetworkIds","getActiveCaipNetwork","getActiveCaipAddress","setApprovedCaipNetworksData","data","getApprovedCaipNetworksData","activeCaipNetworkId","checkIfSupportedChainId","setSmartAccountEnabledNetworks","checkIfSmartAccountEnabled","caipNetworkIdToNumber","Boolean","includes","Number","open","view","checkIfNamesSupported","NAMES_SUPPORTED_CHAIN_NAMESPACES","resetNetwork","resetAccount","chainToWrite","currentAccountType","optionsAccountType","balance","balanceSymbol","profileName","profileImage","addressExplorerUrl","connectedWalletInfo","socialProvider","socialWindow","farcasterUrl","status","removeConnectorId","getFirstCaipNetworkSupportsAuthConnector","availableChains","firstCaipNetwork","AUTH_CONNECTOR_SUPPORTED_CHAINS","ns","firstAvailableChain","getAccountData","byChainId","getRequestedCaipNetworkIds","values","flatMap","getCaipNetworks","getCaipNetworkById","setLastConnectedSIWECaipNetwork","lastConnectedSIWECaipNetwork","getLastConnectedSIWECaipNetwork","fetchTokenBalance","onError","getPlainAddress","lastRetry","isAllowedRetry","ONE_SEC_MS","getMyTokensWithBalance","Date","now","showError","isCaipNetworkDisabled","networkNamespace","isNextNamespaceConnected","shouldSupportAllNetworks","connectorId","getConnectorId","authConnector","getAuthConnector","isConnectedWithAuth","CONNECTOR_ID","AUTH"],"sources":["../../../../src/controllers/ChainController.ts"],"sourcesContent":[null],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}