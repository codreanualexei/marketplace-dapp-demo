{"ast":null,"code":"import React,{useState,useEffect}from'react';import{useWallet}from'../contexts/WalletContext';import{useMarketplaceSDK}from'../hooks/useMarketplaceSDK';import Pagination from'../Components/Pagination';import'./Marketplace.css';import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const ITEMS_PER_PAGE=1;const Marketplace=()=>{const{account}=useWallet();const sdk=useMarketplaceSDK();const[listedDomains,setListedDomains]=useState([]);const[totalListings,setTotalListings]=useState(0);const[isLoading,setIsLoading]=useState(true);const[error,setError]=useState(null);// Marketplace shows only active listings\nconst[buyingListingId,setBuyingListingId]=useState(null);const[currentPage,setCurrentPage]=useState(1);// Load total active count first\nuseEffect(()=>{if(sdk&&account){// Only load when both SDK and account are available\nloadTotalCount();}},[sdk,account]);// Load page data when page changes\nuseEffect(()=>{if(sdk&&account&&totalListings>0){// Only load when all required data is available\nloadCurrentPage();}else if(sdk&&account){setIsLoading(false);}},[sdk,account,currentPage,totalListings]);const loadTotalCount=async()=>{if(!sdk||isLoading)return;// Prevent multiple simultaneous calls\nsetIsLoading(true);try{console.log('Loading total listing count...');// Count only active listings (scan-based)\nconst count=await sdk.getActiveListingCount();console.log('Total listings count:',count);setTotalListings(count);setCurrentPage(1);}catch(err){console.error('Error loading count:',err);setError('Failed to load listing count');}finally{setIsLoading(false);}};const loadCurrentPage=async()=>{if(!sdk||isLoading)return;// Prevent multiple simultaneous calls\nsetIsLoading(true);setError(null);try{// Calculate which listings to fetch for current page\nconst startId=(currentPage-1)*ITEMS_PER_PAGE+1;// Fetch only the active listings for this page (scan from last)\nconst domains=await sdk.getActiveListingsPage(currentPage,ITEMS_PER_PAGE);setListedDomains(domains);console.log(\"Loaded page \".concat(currentPage,\": listings \").concat(startId,\"-\").concat(startId+ITEMS_PER_PAGE-1),domains);}catch(err){console.error('Error loading marketplace:',err);setError('Failed to load marketplace listings');}finally{setIsLoading(false);}};const handleBuy=async listing=>{if(!sdk||!account){alert('Please connect your wallet first');return;}const confirmed=window.confirm(\"Buy Domain #\".concat(listing.tokenId,\" for \").concat(listing.price,\" MATIC?\"));if(!confirmed)return;setBuyingListingId(listing.listingId);try{const txHash=await sdk.buyToken(listing.listingId);if(txHash){alert(\"Purchase successful! Transaction: \".concat(txHash));// Reload current page\nawait loadCurrentPage();}else{alert('Purchase failed. Please try again.');}}catch(err){console.error('Error buying token:',err);alert(\"Error: \".concat(err.message||'Failed to buy domain'));}finally{setBuyingListingId(null);}};const formatAddress=address=>{return\"\".concat(address.slice(0,6),\"...\").concat(address.slice(-4));};const isOwnListing=seller=>{return account&&seller.toLowerCase()===account.toLowerCase();};// Pagination logic (smart - data already paginated from SDK)\nconst totalPages=Math.ceil(totalListings/ITEMS_PER_PAGE);const handlePageChange=page=>{setCurrentPage(page);window.scrollTo({top:0,behavior:'smooth'});// Data will reload via useEffect\n};if(isLoading){return/*#__PURE__*/_jsx(\"div\",{className:\"marketplace\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"loading\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"spinner\"}),/*#__PURE__*/_jsx(\"p\",{children:\"Loading marketplace...\"})]})});}if(!sdk){return/*#__PURE__*/_jsx(\"div\",{className:\"marketplace\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"empty-state\",children:[/*#__PURE__*/_jsx(\"h3\",{children:\"Marketplace unavailable\"}),/*#__PURE__*/_jsx(\"p\",{children:\"Connect your wallet or set REACT_APP_RPC_URL and contract addresses.\"})]})});}if(error){return/*#__PURE__*/_jsx(\"div\",{className:\"marketplace\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"error-message\",children:[/*#__PURE__*/_jsx(\"p\",{children:error}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>{loadTotalCount();loadCurrentPage();},children:\"Try Again\"})]})});}return/*#__PURE__*/_jsx(\"div\",{className:\"marketplace\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"marketplace-container\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"page-header\",children:[/*#__PURE__*/_jsx(\"h1\",{children:\"Domain Marketplace\"}),/*#__PURE__*/_jsx(\"p\",{children:\"Discover and buy domain NFTs\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"marketplace-controls\",children:/*#__PURE__*/_jsx(\"button\",{className:\"refresh-button\",onClick:()=>{loadTotalCount();loadCurrentPage();},children:\"\\uD83D\\uDD04 Refresh\"})}),totalListings===0?/*#__PURE__*/_jsxs(\"div\",{className:\"empty-state\",children:[/*#__PURE__*/_jsx(\"h3\",{children:\"No listings found\"}),/*#__PURE__*/_jsx(\"p\",{children:\"The marketplace is empty. Be the first to list a domain!\"}),account&&/*#__PURE__*/_jsx(\"button\",{className:\"action-button primary\",onClick:()=>window.location.hash='#my-domains',style:{marginTop:'20px'},children:\"List Your Domains\"})]}):/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"div\",{className:\"nft-grid\",children:listedDomains.map(listing=>{var _listing$tokenData;return/*#__PURE__*/_jsxs(\"div\",{className:\"nft-card\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"nft-card-image\",children:/*#__PURE__*/_jsx(\"img\",{src:((_listing$tokenData=listing.tokenData)===null||_listing$tokenData===void 0?void 0:_listing$tokenData.uri)||'https://via.placeholder.com/400x400/667eea/ffffff?text=Domain',alt:\"Domain #\".concat(listing.tokenId),onError:e=>{e.currentTarget.src='https://via.placeholder.com/400x400/667eea/ffffff?text=Domain';}})}),/*#__PURE__*/_jsxs(\"div\",{className:\"nft-card-content\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"nft-card-header\",children:[/*#__PURE__*/_jsxs(\"h3\",{className:\"nft-card-title\",children:[\"Domain #\",listing.tokenId]}),/*#__PURE__*/_jsxs(\"span\",{className:\"listing-badge\",children:[\"#\",listing.listingId]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"nft-info\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"info-row\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"label\",children:\"Seller:\"}),/*#__PURE__*/_jsx(\"span\",{className:\"value\",children:formatAddress(listing.seller)})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"info-row\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"label\",children:\"Price:\"}),/*#__PURE__*/_jsxs(\"span\",{className:\"value price\",children:[listing.price,\" MATIC\"]})]}),listing.tokenData&&/*#__PURE__*/_jsxs(\"div\",{className:\"info-row\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"label\",children:\"Creator:\"}),/*#__PURE__*/_jsx(\"span\",{className:\"value\",children:formatAddress(listing.tokenData.creator)})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"nft-card-footer\",children:isOwnListing(listing.seller)?/*#__PURE__*/_jsx(\"button\",{className:\"action-button secondary\",disabled:true,children:\"Your Listing\"}):/*#__PURE__*/_jsx(\"button\",{className:\"action-button primary\",onClick:()=>handleBuy(listing),disabled:buyingListingId===listing.listingId||!account,children:buyingListingId===listing.listingId?'Buying...':'Buy Now'})})]})]},listing.listingId);})}),/*#__PURE__*/_jsx(Pagination,{currentPage:currentPage,totalPages:totalPages,onPageChange:handlePageChange,itemsPerPage:ITEMS_PER_PAGE,totalItems:totalListings})]})]})});};export default Marketplace;","map":{"version":3,"names":["React","useState","useEffect","useWallet","useMarketplaceSDK","Pagination","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","ITEMS_PER_PAGE","Marketplace","account","sdk","listedDomains","setListedDomains","totalListings","setTotalListings","isLoading","setIsLoading","error","setError","buyingListingId","setBuyingListingId","currentPage","setCurrentPage","loadTotalCount","loadCurrentPage","console","log","count","getActiveListingCount","err","startId","domains","getActiveListingsPage","concat","handleBuy","listing","alert","confirmed","window","confirm","tokenId","price","listingId","txHash","buyToken","message","formatAddress","address","slice","isOwnListing","seller","toLowerCase","totalPages","Math","ceil","handlePageChange","page","scrollTo","top","behavior","className","children","onClick","location","hash","style","marginTop","map","_listing$tokenData","src","tokenData","uri","alt","onError","e","currentTarget","creator","disabled","onPageChange","itemsPerPage","totalItems"],"sources":["/Users/alex.codreanu/Desktop/marketplace-dapp/src/Pages/Marketplace.tsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { useWallet } from '../contexts/WalletContext';\nimport { useMarketplaceSDK } from '../hooks/useMarketplaceSDK';\nimport { ListedToken } from '../sdk/MarketplaceSDK';\nimport Pagination from '../Components/Pagination';\nimport './Marketplace.css';\n\nconst ITEMS_PER_PAGE = 1;\n\nconst Marketplace: React.FC = () => {\n  const { account } = useWallet();\n  const sdk = useMarketplaceSDK();\n  const [listedDomains, setListedDomains] = useState<ListedToken[]>([]);\n  const [totalListings, setTotalListings] = useState(0);\n  const [isLoading, setIsLoading] = useState(true);\n  const [error, setError] = useState<string | null>(null);\n  // Marketplace shows only active listings\n  const [buyingListingId, setBuyingListingId] = useState<number | null>(null);\n  const [currentPage, setCurrentPage] = useState(1);\n\n  // Load total active count first\n  useEffect(() => {\n    if (sdk && account) { // Only load when both SDK and account are available\n      loadTotalCount();\n    }\n  }, [sdk, account]);\n\n  // Load page data when page changes\n  useEffect(() => {\n    if (sdk && account && totalListings > 0) { // Only load when all required data is available\n      loadCurrentPage();\n    } else if (sdk && account) {\n      setIsLoading(false);\n    }\n  }, [sdk, account, currentPage, totalListings]);\n\n  const loadTotalCount = async () => {\n    if (!sdk || isLoading) return; // Prevent multiple simultaneous calls\n    \n    setIsLoading(true);\n    try {\n      console.log('Loading total listing count...');\n      // Count only active listings (scan-based)\n      const count = await sdk.getActiveListingCount();\n      console.log('Total listings count:', count);\n\n      setTotalListings(count);\n      setCurrentPage(1);\n    } catch (err: any) {\n      console.error('Error loading count:', err);\n      setError('Failed to load listing count');\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  const loadCurrentPage = async () => {\n    if (!sdk || isLoading) return; // Prevent multiple simultaneous calls\n\n    setIsLoading(true);\n    setError(null);\n\n    try {\n      // Calculate which listings to fetch for current page\n      const startId = (currentPage - 1) * ITEMS_PER_PAGE + 1;\n      \n      // Fetch only the active listings for this page (scan from last)\n      const domains = await sdk.getActiveListingsPage(\n        currentPage,\n        ITEMS_PER_PAGE\n      );\n      \n      setListedDomains(domains);\n      console.log(`Loaded page ${currentPage}: listings ${startId}-${startId + ITEMS_PER_PAGE - 1}`, domains);\n    } catch (err: any) {\n      console.error('Error loading marketplace:', err);\n      setError('Failed to load marketplace listings');\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  const handleBuy = async (listing: ListedToken) => {\n    if (!sdk || !account) {\n      alert('Please connect your wallet first');\n      return;\n    }\n\n    const confirmed = window.confirm(\n      `Buy Domain #${listing.tokenId} for ${listing.price} MATIC?`\n    );\n    \n    if (!confirmed) return;\n\n    setBuyingListingId(listing.listingId);\n\n    try {\n      const txHash = await sdk.buyToken(listing.listingId);\n      \n      if (txHash) {\n        alert(`Purchase successful! Transaction: ${txHash}`);\n        // Reload current page\n        await loadCurrentPage();\n      } else {\n        alert('Purchase failed. Please try again.');\n      }\n    } catch (err: any) {\n      console.error('Error buying token:', err);\n      alert(`Error: ${err.message || 'Failed to buy domain'}`);\n    } finally {\n      setBuyingListingId(null);\n    }\n  };\n\n  const formatAddress = (address: string) => {\n    return `${address.slice(0, 6)}...${address.slice(-4)}`;\n  };\n\n  const isOwnListing = (seller: string) => {\n    return account && seller.toLowerCase() === account.toLowerCase();\n  };\n\n  // Pagination logic (smart - data already paginated from SDK)\n  const totalPages = Math.ceil(totalListings / ITEMS_PER_PAGE);\n\n  const handlePageChange = (page: number) => {\n    setCurrentPage(page);\n    window.scrollTo({ top: 0, behavior: 'smooth' });\n    // Data will reload via useEffect\n  };\n\n  if (isLoading) {\n    return (\n      <div className=\"marketplace\">\n        <div className=\"loading\">\n          <div className=\"spinner\"></div>\n          <p>Loading marketplace...</p>\n        </div>\n      </div>\n    );\n  }\n\n  if (!sdk) {\n    return (\n      <div className=\"marketplace\">\n        <div className=\"empty-state\">\n          <h3>Marketplace unavailable</h3>\n          <p>Connect your wallet or set REACT_APP_RPC_URL and contract addresses.</p>\n        </div>\n      </div>\n    );\n  }\n\n  if (error) {\n    return (\n      <div className=\"marketplace\">\n        <div className=\"error-message\">\n          <p>{error}</p>\n          <button onClick={() => {\n            loadTotalCount();\n            loadCurrentPage();\n          }}>Try Again</button>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"marketplace\">\n      <div className=\"marketplace-container\">\n        <div className=\"page-header\">\n          <h1>Domain Marketplace</h1>\n          <p>Discover and buy domain NFTs</p>\n        </div>\n\n        <div className=\"marketplace-controls\">\n          <button className=\"refresh-button\" onClick={() => {\n            loadTotalCount();\n            loadCurrentPage();\n          }}>\n            ðŸ”„ Refresh\n          </button>\n        </div>\n\n        {totalListings === 0 ? (\n          <div className=\"empty-state\">\n            <h3>No listings found</h3>\n            <p>The marketplace is empty. Be the first to list a domain!</p>\n            {account && (\n              <button \n                className=\"action-button primary\"\n                onClick={() => window.location.hash = '#my-domains'}\n                style={{ marginTop: '20px' }}\n              >\n                List Your Domains\n              </button>\n            )}\n          </div>\n        ) : (\n          <>\n            <div className=\"nft-grid\">\n              {listedDomains.map((listing) => (\n              <div key={listing.listingId} className=\"nft-card\">\n                <div className=\"nft-card-image\">\n                  <img \n                    src={listing.tokenData?.uri || 'https://via.placeholder.com/400x400/667eea/ffffff?text=Domain'} \n                    alt={`Domain #${listing.tokenId}`}\n                    onError={(e) => {\n                      e.currentTarget.src = 'https://via.placeholder.com/400x400/667eea/ffffff?text=Domain';\n                    }}\n                  />\n                </div>\n                \n                <div className=\"nft-card-content\">\n                  <div className=\"nft-card-header\">\n                    <h3 className=\"nft-card-title\">Domain #{listing.tokenId}</h3>\n                    <span className=\"listing-badge\">#{listing.listingId}</span>\n                  </div>\n                  \n                  <div className=\"nft-info\">\n                    <div className=\"info-row\">\n                      <span className=\"label\">Seller:</span>\n                      <span className=\"value\">{formatAddress(listing.seller)}</span>\n                    </div>\n                    <div className=\"info-row\">\n                      <span className=\"label\">Price:</span>\n                      <span className=\"value price\">{listing.price} MATIC</span>\n                    </div>\n                    {listing.tokenData && (\n                      <div className=\"info-row\">\n                        <span className=\"label\">Creator:</span>\n                        <span className=\"value\">{formatAddress(listing.tokenData.creator)}</span>\n                      </div>\n                    )}\n                  </div>\n                  \n                  <div className=\"nft-card-footer\">\n                    {isOwnListing(listing.seller) ? (\n                      <button className=\"action-button secondary\" disabled>\n                        Your Listing\n                      </button>\n                    ) : (\n                      <button \n                        className=\"action-button primary\"\n                        onClick={() => handleBuy(listing)}\n                        disabled={buyingListingId === listing.listingId || !account}\n                      >\n                        {buyingListingId === listing.listingId ? 'Buying...' : 'Buy Now'}\n                      </button>\n                    )}\n                  </div>\n                </div>\n              </div>\n              ))}\n            </div>\n\n            <Pagination\n              currentPage={currentPage}\n              totalPages={totalPages}\n              onPageChange={handlePageChange}\n              itemsPerPage={ITEMS_PER_PAGE}\n              totalItems={totalListings}\n            />\n          </>\n        )}\n      </div>\n    </div>\n  );\n};\n\nexport default Marketplace;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}