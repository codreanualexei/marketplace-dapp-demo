{"ast":null,"code":"/* eslint-disable max-depth */\nimport { ref } from 'valtio';\nimport { ParseUtil } from '@reown/appkit-common';\nimport { ConstantsUtil as CommonConstantsUtil } from '@reown/appkit-common';\nimport { W3mFrameRpcConstants } from '@reown/appkit-wallet/utils';\nimport { ChainController } from '../controllers/ChainController.js';\nimport { ConnectionController } from '../controllers/ConnectionController.js';\nimport { ConnectorController } from '../controllers/ConnectorController.js';\nimport { EventsController } from '../controllers/EventsController.js';\nimport { ModalController } from '../controllers/ModalController.js';\nimport { RouterController } from '../controllers/RouterController.js';\nimport { getPreferredAccountType } from './ChainControllerUtil.js';\nimport { ConstantsUtil } from './ConstantsUtil.js';\nimport { CoreHelperUtil } from './CoreHelperUtil.js';\nimport { StorageUtil } from './StorageUtil.js';\n// -- Constants ------------------------------------------ //\nconst UPDATE_EMAIL_INTERVAL_MS = 1000;\nexport const ConnectorControllerUtil = {\n  checkNamespaceConnectorId(namespace, connectorId) {\n    return ConnectorController.getConnectorId(namespace) === connectorId;\n  },\n  isSocialProvider(socialProvider) {\n    return ConstantsUtil.DEFAULT_REMOTE_FEATURES.socials.includes(socialProvider);\n  },\n  connectWalletConnect(_ref) {\n    let {\n      walletConnect,\n      connector,\n      closeModalOnConnect = true,\n      redirectViewOnModalClose = 'Connect',\n      onOpen,\n      onConnect\n    } = _ref;\n    return new Promise((resolve, reject) => {\n      if (walletConnect) {\n        ConnectorController.setActiveConnector(connector);\n      }\n      onOpen === null || onOpen === void 0 || onOpen(CoreHelperUtil.isMobile() && walletConnect);\n      if (redirectViewOnModalClose) {\n        const unsubscribeModalController = ModalController.subscribeKey('open', val => {\n          if (!val) {\n            if (RouterController.state.view !== redirectViewOnModalClose) {\n              RouterController.replace(redirectViewOnModalClose);\n            }\n            unsubscribeModalController();\n            reject(new Error('Modal closed'));\n          }\n        });\n      }\n      const unsubscribeChainController = ChainController.subscribeKey('activeCaipAddress', val => {\n        if (val) {\n          onConnect === null || onConnect === void 0 || onConnect();\n          if (closeModalOnConnect) {\n            ModalController.close();\n          }\n          unsubscribeChainController();\n          resolve(ParseUtil.parseCaipAddress(val));\n        }\n      });\n    });\n  },\n  connectExternal(connector) {\n    return new Promise((resolve, reject) => {\n      const unsubscribeChainController = ChainController.subscribeKey('activeCaipAddress', val => {\n        if (val) {\n          ModalController.close();\n          unsubscribeChainController();\n          resolve(ParseUtil.parseCaipAddress(val));\n        }\n      });\n      ConnectionController.connectExternal(connector, connector.chain).catch(() => {\n        unsubscribeChainController();\n        reject(new Error('Connection rejected'));\n      });\n    });\n  },\n  connectSocial(_ref2) {\n    let {\n      social,\n      namespace,\n      closeModalOnConnect = true,\n      onOpenFarcaster,\n      onConnect\n    } = _ref2;\n    const accountData = ChainController.getAccountData(namespace);\n    let socialWindow = accountData === null || accountData === void 0 ? void 0 : accountData.socialWindow;\n    let socialProvider = accountData === null || accountData === void 0 ? void 0 : accountData.socialProvider;\n    let isConnectingSocial = false;\n    let popupWindow = null;\n    const namespaceToUse = namespace || ChainController.state.activeChain;\n    const unsubscribeChainController = ChainController.subscribeKey('activeCaipAddress', val => {\n      if (val) {\n        if (closeModalOnConnect) {\n          ModalController.close();\n        }\n        unsubscribeChainController();\n      }\n    });\n    return new Promise((resolve, reject) => {\n      async function handleSocialConnection(event) {\n        var _event$data;\n        if ((_event$data = event.data) !== null && _event$data !== void 0 && _event$data.resultUri) {\n          if (event.origin === CommonConstantsUtil.SECURE_SITE_SDK_ORIGIN) {\n            window.removeEventListener('message', handleSocialConnection, false);\n            try {\n              const authConnector = ConnectorController.getAuthConnector(namespaceToUse);\n              if (authConnector && !isConnectingSocial) {\n                const _accountData = ChainController.getAccountData(namespaceToUse);\n                if (socialWindow) {\n                  socialWindow.close();\n                  ChainController.setAccountProp('socialWindow', undefined, namespaceToUse);\n                  socialWindow = _accountData === null || _accountData === void 0 ? void 0 : _accountData.socialWindow;\n                }\n                isConnectingSocial = true;\n                const uri = event.data.resultUri;\n                if (socialProvider) {\n                  EventsController.sendEvent({\n                    type: 'track',\n                    event: 'SOCIAL_LOGIN_REQUEST_USER_DATA',\n                    properties: {\n                      provider: socialProvider\n                    }\n                  });\n                }\n                if (socialProvider) {\n                  StorageUtil.setConnectedSocialProvider(socialProvider);\n                  await ConnectionController.connectExternal({\n                    id: authConnector.id,\n                    type: authConnector.type,\n                    socialUri: uri\n                  }, authConnector.chain);\n                  const caipAddress = ChainController.state.activeCaipAddress;\n                  if (!caipAddress) {\n                    reject(new Error('Failed to connect'));\n                    return;\n                  }\n                  resolve(ParseUtil.parseCaipAddress(caipAddress));\n                  EventsController.sendEvent({\n                    type: 'track',\n                    event: 'SOCIAL_LOGIN_SUCCESS',\n                    properties: {\n                      provider: socialProvider\n                    }\n                  });\n                }\n              }\n            } catch (err) {\n              if (socialProvider) {\n                EventsController.sendEvent({\n                  type: 'track',\n                  event: 'SOCIAL_LOGIN_ERROR',\n                  properties: {\n                    provider: socialProvider,\n                    message: CoreHelperUtil.parseError(err)\n                  }\n                });\n              }\n              reject(new Error('Failed to connect'));\n            }\n          } else if (socialProvider) {\n            EventsController.sendEvent({\n              type: 'track',\n              event: 'SOCIAL_LOGIN_ERROR',\n              properties: {\n                provider: socialProvider,\n                message: 'Untrusted Origin'\n              }\n            });\n          }\n        }\n      }\n      async function connectSocial() {\n        if (social) {\n          const _accountData = ChainController.getAccountData(namespaceToUse);\n          ChainController.setAccountProp('socialProvider', social, namespaceToUse);\n          socialProvider = _accountData === null || _accountData === void 0 ? void 0 : _accountData.socialProvider;\n          EventsController.sendEvent({\n            type: 'track',\n            event: 'SOCIAL_LOGIN_STARTED',\n            properties: {\n              provider: socialProvider\n            }\n          });\n        }\n        if (socialProvider === 'farcaster') {\n          onOpenFarcaster === null || onOpenFarcaster === void 0 || onOpenFarcaster();\n          const unsubscribeModalController = ModalController.subscribeKey('open', val => {\n            if (!val && social === 'farcaster') {\n              reject(new Error('Popup closed'));\n              onConnect === null || onConnect === void 0 || onConnect();\n              unsubscribeModalController();\n            }\n          });\n          const authConnector = ConnectorController.getAuthConnector();\n          if (authConnector) {\n            const _accountData = ChainController.getAccountData(namespaceToUse);\n            if (!(_accountData !== null && _accountData !== void 0 && _accountData.farcasterUrl)) {\n              try {\n                const {\n                  url\n                } = await authConnector.provider.getFarcasterUri();\n                ChainController.setAccountProp('farcasterUrl', url, namespaceToUse);\n              } catch (_unused) {\n                reject(new Error('Failed to connect to farcaster'));\n              }\n            }\n          }\n        } else {\n          const authConnector = ConnectorController.getAuthConnector();\n          popupWindow = CoreHelperUtil.returnOpenHref(\"\".concat(CommonConstantsUtil.SECURE_SITE_SDK_ORIGIN, \"/loading\"), 'popupWindow', 'width=600,height=800,scrollbars=yes');\n          try {\n            if (authConnector && socialProvider) {\n              const {\n                uri\n              } = await authConnector.provider.getSocialRedirectUri({\n                provider: socialProvider\n              });\n              if (popupWindow && uri) {\n                ChainController.setAccountProp('socialWindow', ref(popupWindow), namespaceToUse);\n                socialWindow = accountData === null || accountData === void 0 ? void 0 : accountData.socialWindow;\n                popupWindow.location.href = uri;\n                const interval = setInterval(() => {\n                  var _socialWindow;\n                  if ((_socialWindow = socialWindow) !== null && _socialWindow !== void 0 && _socialWindow.closed && !isConnectingSocial) {\n                    reject(new Error('Popup closed'));\n                    clearInterval(interval);\n                  }\n                }, 1000);\n                window.addEventListener('message', handleSocialConnection, false);\n              } else {\n                var _popupWindow;\n                (_popupWindow = popupWindow) === null || _popupWindow === void 0 || _popupWindow.close();\n                reject(new Error('Failed to initiate social connection'));\n              }\n            }\n          } catch (_unused2) {\n            var _popupWindow2;\n            reject(new Error('Failed to initiate social connection'));\n            (_popupWindow2 = popupWindow) === null || _popupWindow2 === void 0 || _popupWindow2.close();\n          }\n        }\n      }\n      connectSocial();\n    });\n  },\n  connectEmail(_ref3) {\n    let {\n      closeModalOnConnect = true,\n      redirectViewOnModalClose = 'Connect',\n      onOpen,\n      onConnect\n    } = _ref3;\n    return new Promise((resolve, reject) => {\n      onOpen === null || onOpen === void 0 || onOpen();\n      if (redirectViewOnModalClose) {\n        const unsubscribeModalController = ModalController.subscribeKey('open', val => {\n          if (!val) {\n            if (RouterController.state.view !== redirectViewOnModalClose) {\n              RouterController.replace(redirectViewOnModalClose);\n            }\n            unsubscribeModalController();\n            reject(new Error('Modal closed'));\n          }\n        });\n      }\n      const unsubscribeChainController = ChainController.subscribeKey('activeCaipAddress', val => {\n        if (val) {\n          onConnect === null || onConnect === void 0 || onConnect();\n          if (closeModalOnConnect) {\n            ModalController.close();\n          }\n          unsubscribeChainController();\n          resolve(ParseUtil.parseCaipAddress(val));\n        }\n      });\n    });\n  },\n  async updateEmail() {\n    var _authConnector$provid;\n    const connectorId = StorageUtil.getConnectedConnectorId(ChainController.state.activeChain);\n    const authConnector = ConnectorController.getAuthConnector();\n    if (!authConnector) {\n      throw new Error('No auth connector found');\n    }\n    if (connectorId !== CommonConstantsUtil.CONNECTOR_ID.AUTH) {\n      throw new Error('Not connected to email or social');\n    }\n    const initialEmail = (_authConnector$provid = authConnector.provider.getEmail()) !== null && _authConnector$provid !== void 0 ? _authConnector$provid : '';\n    await ModalController.open({\n      view: 'UpdateEmailWallet',\n      data: {\n        email: initialEmail,\n        redirectView: undefined\n      }\n    });\n    return new Promise((resolve, reject) => {\n      const interval = setInterval(() => {\n        var _authConnector$provid2;\n        const newEmail = (_authConnector$provid2 = authConnector.provider.getEmail()) !== null && _authConnector$provid2 !== void 0 ? _authConnector$provid2 : '';\n        if (newEmail !== initialEmail) {\n          ModalController.close();\n          clearInterval(interval);\n          unsubscribeModalController();\n          resolve({\n            email: newEmail\n          });\n        }\n      }, UPDATE_EMAIL_INTERVAL_MS);\n      const unsubscribeModalController = ModalController.subscribeKey('open', val => {\n        if (!val) {\n          if (RouterController.state.view !== 'Connect') {\n            RouterController.push('Connect');\n          }\n          clearInterval(interval);\n          unsubscribeModalController();\n          reject(new Error('Modal closed'));\n        }\n      });\n    });\n  },\n  canSwitchToSmartAccount(namespace) {\n    const isSmartAccountEnabled = ChainController.checkIfSmartAccountEnabled();\n    return isSmartAccountEnabled && getPreferredAccountType(namespace) === W3mFrameRpcConstants.ACCOUNT_TYPES.EOA;\n  }\n};","map":{"version":3,"names":["ref","ParseUtil","ConstantsUtil","CommonConstantsUtil","W3mFrameRpcConstants","ChainController","ConnectionController","ConnectorController","EventsController","ModalController","RouterController","getPreferredAccountType","CoreHelperUtil","StorageUtil","UPDATE_EMAIL_INTERVAL_MS","ConnectorControllerUtil","checkNamespaceConnectorId","namespace","connectorId","getConnectorId","isSocialProvider","socialProvider","DEFAULT_REMOTE_FEATURES","socials","includes","connectWalletConnect","_ref","walletConnect","connector","closeModalOnConnect","redirectViewOnModalClose","onOpen","onConnect","Promise","resolve","reject","setActiveConnector","isMobile","unsubscribeModalController","subscribeKey","val","state","view","replace","Error","unsubscribeChainController","close","parseCaipAddress","connectExternal","chain","catch","connectSocial","_ref2","social","onOpenFarcaster","accountData","getAccountData","socialWindow","isConnectingSocial","popupWindow","namespaceToUse","activeChain","handleSocialConnection","event","_event$data","data","resultUri","origin","SECURE_SITE_SDK_ORIGIN","window","removeEventListener","authConnector","getAuthConnector","_accountData","setAccountProp","undefined","uri","sendEvent","type","properties","provider","setConnectedSocialProvider","id","socialUri","caipAddress","activeCaipAddress","err","message","parseError","farcasterUrl","url","getFarcasterUri","_unused","returnOpenHref","concat","getSocialRedirectUri","location","href","interval","setInterval","_socialWindow","closed","clearInterval","addEventListener","_popupWindow","_unused2","_popupWindow2","connectEmail","_ref3","updateEmail","_authConnector$provid","getConnectedConnectorId","CONNECTOR_ID","AUTH","initialEmail","getEmail","open","email","redirectView","_authConnector$provid2","newEmail","push","canSwitchToSmartAccount","isSmartAccountEnabled","checkIfSmartAccountEnabled","ACCOUNT_TYPES","EOA"],"sources":["../../../../src/utils/ConnectorControllerUtil.ts"],"sourcesContent":[null],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}