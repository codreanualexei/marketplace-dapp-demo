{"ast":null,"code":"import { ConstantsUtil as CommonConstantsUtil } from '@reown/appkit-common';\nimport { ChainController, ConnectorController, StorageUtil } from '@reown/appkit-controllers';\nimport { ConstantsUtil } from './ConstantsUtil.js';\nexport const HelpersUtil = {\n  getCaipTokens(tokens) {\n    if (!tokens) {\n      return undefined;\n    }\n    const caipTokens = {};\n    Object.entries(tokens).forEach(([id, token]) => {\n      caipTokens[`${ConstantsUtil.EIP155}:${id}`] = token;\n    });\n    return caipTokens;\n  },\n  isLowerCaseMatch(str1, str2) {\n    return str1?.toLowerCase() === str2?.toLowerCase();\n  },\n  /**\n   * Iterates the Auth connector supported chains and returns the namespace that is last connected to the active chain.\n   * @returns ChainNamespace | undefined\n   */\n  getActiveNamespaceConnectedToAuth() {\n    const activeChain = ChainController.state.activeChain;\n    return CommonConstantsUtil.AUTH_CONNECTOR_SUPPORTED_CHAINS.find(chain => ConnectorController.getConnectorId(chain) === CommonConstantsUtil.CONNECTOR_ID.AUTH && chain === activeChain);\n  },\n  /**\n   * Runs a condition function again and again until it returns true or the max number of tries is reached.\n   *\n   * @param conditionFn - A function (can be async) that returns true when the condition is met.\n   * @param intervalMs - Time to wait between tries, in milliseconds.\n   * @param maxRetries - Maximum number of times to try before stopping.\n   * @returns A Promise that resolves to true if the condition becomes true in time, or false if it doesn't.\n   */\n  withRetry({\n    conditionFn,\n    intervalMs,\n    maxRetries\n  }) {\n    let attempts = 0;\n    return new Promise(resolve => {\n      async function tryCheck() {\n        attempts += 1;\n        const result = await conditionFn();\n        if (result) {\n          return resolve(true);\n        }\n        if (attempts >= maxRetries) {\n          return resolve(false);\n        }\n        setTimeout(tryCheck, intervalMs);\n        return null;\n      }\n      tryCheck();\n    });\n  },\n  /**\n   * Returns the chain namespace from user's chainId which is returned from Auth provider.\n   * @param chainId - The chainId to parse.\n   * @returns The chain namespace.\n   */\n  userChainIdToChainNamespace(chainId) {\n    if (typeof chainId === 'number') {\n      return CommonConstantsUtil.CHAIN.EVM;\n    }\n    const [namespace] = chainId.split(':');\n    return namespace;\n  },\n  /**\n   * Get all auth namespaces except the active one\n   * @param activeNamespace - The active namespace\n   * @returns All auth namespaces except the active one\n   */\n  getOtherAuthNamespaces(activeNamespace) {\n    if (!activeNamespace) {\n      return [];\n    }\n    const authNamespaces = CommonConstantsUtil.AUTH_CONNECTOR_SUPPORTED_CHAINS;\n    const otherAuthNamespaces = authNamespaces.filter(ns => ns !== activeNamespace);\n    return otherAuthNamespaces;\n  },\n  /**\n   * Gets the storage info for a connector\n   * @param connectorId - The ID of the connector\n   * @param namespace - The namespace of the connector\n   * @returns\n   */\n  getConnectorStorageInfo(connectorId, namespace) {\n    const storageConnectionsByNamespace = StorageUtil.getConnections();\n    const storageConnections = storageConnectionsByNamespace[namespace] ?? [];\n    return {\n      hasDisconnected: StorageUtil.isConnectorDisconnected(connectorId, namespace),\n      hasConnected: storageConnections.some(c => HelpersUtil.isLowerCaseMatch(c.connectorId, connectorId))\n    };\n  }\n};","map":{"version":3,"names":["ConstantsUtil","CommonConstantsUtil","ChainController","ConnectorController","StorageUtil","HelpersUtil","getCaipTokens","tokens","undefined","caipTokens","Object","entries","forEach","id","token","EIP155","isLowerCaseMatch","str1","str2","toLowerCase","getActiveNamespaceConnectedToAuth","activeChain","state","AUTH_CONNECTOR_SUPPORTED_CHAINS","find","chain","getConnectorId","CONNECTOR_ID","AUTH","withRetry","conditionFn","intervalMs","maxRetries","attempts","Promise","resolve","tryCheck","result","setTimeout","userChainIdToChainNamespace","chainId","CHAIN","EVM","namespace","split","getOtherAuthNamespaces","activeNamespace","authNamespaces","otherAuthNamespaces","filter","ns","getConnectorStorageInfo","connectorId","storageConnectionsByNamespace","getConnections","storageConnections","hasDisconnected","isConnectorDisconnected","hasConnected","some","c"],"sources":["../../../src/HelpersUtil.ts"],"sourcesContent":[null],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}