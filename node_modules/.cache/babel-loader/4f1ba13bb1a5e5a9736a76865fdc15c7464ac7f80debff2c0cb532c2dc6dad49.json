{"ast":null,"code":"import { proxy, ref, subscribe as sub } from 'valtio/vanilla';\nimport { subscribeKey as subKey } from 'valtio/vanilla/utils';\nimport { ConstantsUtil as CommonConstantsUtil, ErrorUtil, NumberUtil, UserRejectedRequestError } from '@reown/appkit-common';\nimport { ContractUtil } from '@reown/appkit-common';\nimport { W3mFrameRpcConstants } from '@reown/appkit-wallet/utils';\nimport { BalanceUtil } from '../utils/BalanceUtil.js';\nimport { getActiveNetworkTokenAddress, getPreferredAccountType } from '../utils/ChainControllerUtil.js';\nimport { ConstantsUtil } from '../utils/ConstantsUtil.js';\nimport { CoreHelperUtil } from '../utils/CoreHelperUtil.js';\nimport { SwapApiUtil } from '../utils/SwapApiUtil.js';\nimport { withErrorBoundary } from '../utils/withErrorBoundary.js';\nimport { ChainController } from './ChainController.js';\nimport { ConnectionController } from './ConnectionController.js';\nimport { EventsController } from './EventsController.js';\nimport { RouterController } from './RouterController.js';\nimport { SnackController } from './SnackController.js';\n// -- State --------------------------------------------- //\nconst state = proxy({\n  tokenBalances: [],\n  loading: false\n});\n// -- Controller ---------------------------------------- //\nconst controller = {\n  state,\n  subscribe(callback) {\n    return sub(state, () => callback(state));\n  },\n  subscribeKey(key, callback) {\n    return subKey(state, key, callback);\n  },\n  setToken(token) {\n    if (token) {\n      state.token = ref(token);\n    }\n  },\n  setTokenAmount(sendTokenAmount) {\n    state.sendTokenAmount = sendTokenAmount;\n  },\n  setReceiverAddress(receiverAddress) {\n    state.receiverAddress = receiverAddress;\n  },\n  setReceiverProfileImageUrl(receiverProfileImageUrl) {\n    state.receiverProfileImageUrl = receiverProfileImageUrl;\n  },\n  setReceiverProfileName(receiverProfileName) {\n    state.receiverProfileName = receiverProfileName;\n  },\n  setNetworkBalanceInUsd(networkBalanceInUSD) {\n    state.networkBalanceInUSD = networkBalanceInUSD;\n  },\n  setLoading(loading) {\n    state.loading = loading;\n  },\n  getSdkEventProperties(error) {\n    return {\n      message: CoreHelperUtil.parseError(error),\n      isSmartAccount: getPreferredAccountType(ChainController.state.activeChain) === W3mFrameRpcConstants.ACCOUNT_TYPES.SMART_ACCOUNT,\n      token: state.token?.symbol || '',\n      amount: state.sendTokenAmount ?? 0,\n      network: ChainController.state.activeCaipNetwork?.caipNetworkId || ''\n    };\n  },\n  async sendToken() {\n    try {\n      SendController.setLoading(true);\n      switch (ChainController.state.activeCaipNetwork?.chainNamespace) {\n        case 'eip155':\n          await SendController.sendEvmToken();\n          return;\n        case 'solana':\n          await SendController.sendSolanaToken();\n          return;\n        default:\n          throw new Error('Unsupported chain');\n      }\n    } catch (err) {\n      if (ErrorUtil.isUserRejectedRequestError(err)) {\n        throw new UserRejectedRequestError(err);\n      }\n      throw err;\n    } finally {\n      SendController.setLoading(false);\n    }\n  },\n  async sendEvmToken() {\n    const activeChainNamespace = ChainController.state.activeChain;\n    if (!activeChainNamespace) {\n      throw new Error('SendController:sendEvmToken - activeChainNamespace is required');\n    }\n    const activeAccountType = getPreferredAccountType(activeChainNamespace);\n    if (!SendController.state.sendTokenAmount || !SendController.state.receiverAddress) {\n      throw new Error('An amount and receiver address are required');\n    }\n    if (!SendController.state.token) {\n      throw new Error('A token is required');\n    }\n    if (SendController.state.token?.address) {\n      EventsController.sendEvent({\n        type: 'track',\n        event: 'SEND_INITIATED',\n        properties: {\n          isSmartAccount: activeAccountType === W3mFrameRpcConstants.ACCOUNT_TYPES.SMART_ACCOUNT,\n          token: SendController.state.token.address,\n          amount: SendController.state.sendTokenAmount,\n          network: ChainController.state.activeCaipNetwork?.caipNetworkId || ''\n        }\n      });\n      const {\n        hash\n      } = await SendController.sendERC20Token({\n        receiverAddress: SendController.state.receiverAddress,\n        tokenAddress: SendController.state.token.address,\n        sendTokenAmount: SendController.state.sendTokenAmount,\n        decimals: SendController.state.token.quantity.decimals\n      });\n      if (hash) {\n        state.hash = hash;\n      }\n    } else {\n      EventsController.sendEvent({\n        type: 'track',\n        event: 'SEND_INITIATED',\n        properties: {\n          isSmartAccount: activeAccountType === W3mFrameRpcConstants.ACCOUNT_TYPES.SMART_ACCOUNT,\n          token: SendController.state.token.symbol || '',\n          amount: SendController.state.sendTokenAmount,\n          network: ChainController.state.activeCaipNetwork?.caipNetworkId || ''\n        }\n      });\n      const {\n        hash\n      } = await SendController.sendNativeToken({\n        receiverAddress: SendController.state.receiverAddress,\n        sendTokenAmount: SendController.state.sendTokenAmount,\n        decimals: SendController.state.token.quantity.decimals\n      });\n      if (hash) {\n        state.hash = hash;\n      }\n    }\n  },\n  async fetchTokenBalance(onError) {\n    state.loading = true;\n    const namespace = ChainController.state.activeChain;\n    const chainId = ChainController.state.activeCaipNetwork?.caipNetworkId;\n    const chain = ChainController.state.activeCaipNetwork?.chainNamespace;\n    const caipAddress = ChainController.getAccountData(namespace)?.caipAddress ?? ChainController.state.activeCaipAddress;\n    const address = caipAddress ? CoreHelperUtil.getPlainAddress(caipAddress) : undefined;\n    if (state.lastRetry && !CoreHelperUtil.isAllowedRetry(state.lastRetry, 30 * ConstantsUtil.ONE_SEC_MS)) {\n      state.loading = false;\n      return [];\n    }\n    try {\n      if (address && chainId && chain) {\n        const balances = await BalanceUtil.getMyTokensWithBalance();\n        state.tokenBalances = balances;\n        state.lastRetry = undefined;\n        return balances;\n      }\n    } catch (error) {\n      state.lastRetry = Date.now();\n      onError?.(error);\n      SnackController.showError('Token Balance Unavailable');\n    } finally {\n      state.loading = false;\n    }\n    return [];\n  },\n  fetchNetworkBalance() {\n    if (state.tokenBalances.length === 0) {\n      return;\n    }\n    const networkTokenBalances = SwapApiUtil.mapBalancesToSwapTokens(state.tokenBalances);\n    if (!networkTokenBalances) {\n      return;\n    }\n    const networkToken = networkTokenBalances.find(token => token.address === getActiveNetworkTokenAddress());\n    if (!networkToken) {\n      return;\n    }\n    state.networkBalanceInUSD = networkToken ? NumberUtil.multiply(networkToken.quantity.numeric, networkToken.price).toString() : '0';\n  },\n  async sendNativeToken(params) {\n    RouterController.pushTransactionStack({});\n    const to = params.receiverAddress;\n    const address = ChainController.getAccountData()?.address;\n    const value = ConnectionController.parseUnits(params.sendTokenAmount.toString(), Number(params.decimals));\n    const data = '0x';\n    const hash = await ConnectionController.sendTransaction({\n      chainNamespace: CommonConstantsUtil.CHAIN.EVM,\n      to,\n      address,\n      data,\n      value: value ?? BigInt(0)\n    });\n    EventsController.sendEvent({\n      type: 'track',\n      event: 'SEND_SUCCESS',\n      properties: {\n        isSmartAccount: getPreferredAccountType('eip155') === W3mFrameRpcConstants.ACCOUNT_TYPES.SMART_ACCOUNT,\n        token: SendController.state.token?.symbol || '',\n        amount: params.sendTokenAmount,\n        network: ChainController.state.activeCaipNetwork?.caipNetworkId || '',\n        hash: hash || ''\n      }\n    });\n    ConnectionController._getClient()?.updateBalance('eip155');\n    SendController.resetSend();\n    return {\n      hash\n    };\n  },\n  async sendERC20Token(params) {\n    RouterController.pushTransactionStack({\n      onSuccess() {\n        RouterController.replace('Account');\n      }\n    });\n    const amount = ConnectionController.parseUnits(params.sendTokenAmount.toString(), Number(params.decimals));\n    const address = ChainController.getAccountData()?.address;\n    if (address && params.sendTokenAmount && params.receiverAddress && params.tokenAddress) {\n      const tokenAddress = CoreHelperUtil.getPlainAddress(params.tokenAddress);\n      if (!tokenAddress) {\n        throw new Error('SendController:sendERC20Token - tokenAddress is required');\n      }\n      const hash = await ConnectionController.writeContract({\n        fromAddress: address,\n        tokenAddress,\n        args: [params.receiverAddress, amount ?? BigInt(0)],\n        method: 'transfer',\n        abi: ContractUtil.getERC20Abi(tokenAddress),\n        chainNamespace: CommonConstantsUtil.CHAIN.EVM\n      });\n      EventsController.sendEvent({\n        type: 'track',\n        event: 'SEND_SUCCESS',\n        properties: {\n          isSmartAccount: getPreferredAccountType('eip155') === W3mFrameRpcConstants.ACCOUNT_TYPES.SMART_ACCOUNT,\n          token: SendController.state.token?.symbol || '',\n          amount: params.sendTokenAmount,\n          network: ChainController.state.activeCaipNetwork?.caipNetworkId || '',\n          hash: hash || ''\n        }\n      });\n      SendController.resetSend();\n      return {\n        hash\n      };\n    }\n    return {\n      hash: undefined\n    };\n  },\n  async sendSolanaToken() {\n    if (!SendController.state.sendTokenAmount || !SendController.state.receiverAddress) {\n      throw new Error('An amount and receiver address are required');\n    }\n    RouterController.pushTransactionStack({\n      onSuccess() {\n        RouterController.replace('Account');\n      }\n    });\n    let tokenMint = undefined;\n    if (SendController.state.token && SendController.state.token.address !== ConstantsUtil.SOLANA_NATIVE_TOKEN_ADDRESS) {\n      if (CoreHelperUtil.isCaipAddress(SendController.state.token.address)) {\n        tokenMint = CoreHelperUtil.getPlainAddress(SendController.state.token.address);\n      } else {\n        tokenMint = SendController.state.token.address;\n      }\n    }\n    const hash = await ConnectionController.sendTransaction({\n      chainNamespace: 'solana',\n      tokenMint,\n      to: SendController.state.receiverAddress,\n      value: SendController.state.sendTokenAmount\n    });\n    if (hash) {\n      state.hash = hash;\n    }\n    ConnectionController._getClient()?.updateBalance('solana');\n    SendController.resetSend();\n  },\n  resetSend() {\n    state.token = undefined;\n    state.sendTokenAmount = undefined;\n    state.receiverAddress = undefined;\n    state.receiverProfileImageUrl = undefined;\n    state.receiverProfileName = undefined;\n    state.loading = false;\n    state.tokenBalances = [];\n  }\n};\n// Export the controller wrapped with our error boundary\nexport const SendController = withErrorBoundary(controller);","map":{"version":3,"names":["proxy","ref","subscribe","sub","subscribeKey","subKey","ConstantsUtil","CommonConstantsUtil","ErrorUtil","NumberUtil","UserRejectedRequestError","ContractUtil","W3mFrameRpcConstants","BalanceUtil","getActiveNetworkTokenAddress","getPreferredAccountType","CoreHelperUtil","SwapApiUtil","withErrorBoundary","ChainController","ConnectionController","EventsController","RouterController","SnackController","state","tokenBalances","loading","controller","callback","key","setToken","token","setTokenAmount","sendTokenAmount","setReceiverAddress","receiverAddress","setReceiverProfileImageUrl","receiverProfileImageUrl","setReceiverProfileName","receiverProfileName","setNetworkBalanceInUsd","networkBalanceInUSD","setLoading","getSdkEventProperties","error","message","parseError","isSmartAccount","activeChain","ACCOUNT_TYPES","SMART_ACCOUNT","symbol","amount","network","activeCaipNetwork","caipNetworkId","sendToken","SendController","chainNamespace","sendEvmToken","sendSolanaToken","Error","err","isUserRejectedRequestError","activeChainNamespace","activeAccountType","address","sendEvent","type","event","properties","hash","sendERC20Token","tokenAddress","decimals","quantity","sendNativeToken","fetchTokenBalance","onError","namespace","chainId","chain","caipAddress","getAccountData","activeCaipAddress","getPlainAddress","undefined","lastRetry","isAllowedRetry","ONE_SEC_MS","balances","getMyTokensWithBalance","Date","now","showError","fetchNetworkBalance","length","networkTokenBalances","mapBalancesToSwapTokens","networkToken","find","multiply","numeric","price","toString","params","pushTransactionStack","to","value","parseUnits","Number","data","sendTransaction","CHAIN","EVM","BigInt","_getClient","updateBalance","resetSend","onSuccess","replace","writeContract","fromAddress","args","method","abi","getERC20Abi","tokenMint","SOLANA_NATIVE_TOKEN_ADDRESS","isCaipAddress"],"sources":["../../../../src/controllers/SendController.ts"],"sourcesContent":[null],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}