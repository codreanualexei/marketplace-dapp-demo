{"ast":null,"code":"import { ConstantsUtil as CommonConstantsUtil } from '@reown/appkit-common';\nimport { ChainController, ConnectorController, StorageUtil } from '@reown/appkit-controllers';\nimport { ConstantsUtil } from './ConstantsUtil.js';\nexport const HelpersUtil = {\n  getCaipTokens(tokens) {\n    if (!tokens) {\n      return undefined;\n    }\n    const caipTokens = {};\n    Object.entries(tokens).forEach(_ref => {\n      let [id, token] = _ref;\n      caipTokens[\"\".concat(ConstantsUtil.EIP155, \":\").concat(id)] = token;\n    });\n    return caipTokens;\n  },\n  isLowerCaseMatch(str1, str2) {\n    return (str1 === null || str1 === void 0 ? void 0 : str1.toLowerCase()) === (str2 === null || str2 === void 0 ? void 0 : str2.toLowerCase());\n  },\n  /**\n   * Iterates the Auth connector supported chains and returns the namespace that is last connected to the active chain.\n   * @returns ChainNamespace | undefined\n   */\n  getActiveNamespaceConnectedToAuth() {\n    const activeChain = ChainController.state.activeChain;\n    return CommonConstantsUtil.AUTH_CONNECTOR_SUPPORTED_CHAINS.find(chain => ConnectorController.getConnectorId(chain) === CommonConstantsUtil.CONNECTOR_ID.AUTH && chain === activeChain);\n  },\n  /**\n   * Runs a condition function again and again until it returns true or the max number of tries is reached.\n   *\n   * @param conditionFn - A function (can be async) that returns true when the condition is met.\n   * @param intervalMs - Time to wait between tries, in milliseconds.\n   * @param maxRetries - Maximum number of times to try before stopping.\n   * @returns A Promise that resolves to true if the condition becomes true in time, or false if it doesn't.\n   */\n  withRetry(_ref2) {\n    let {\n      conditionFn,\n      intervalMs,\n      maxRetries\n    } = _ref2;\n    let attempts = 0;\n    return new Promise(resolve => {\n      async function tryCheck() {\n        attempts += 1;\n        const result = await conditionFn();\n        if (result) {\n          return resolve(true);\n        }\n        if (attempts >= maxRetries) {\n          return resolve(false);\n        }\n        setTimeout(tryCheck, intervalMs);\n        return null;\n      }\n      tryCheck();\n    });\n  },\n  /**\n   * Returns the chain namespace from user's chainId which is returned from Auth provider.\n   * @param chainId - The chainId to parse.\n   * @returns The chain namespace.\n   */\n  userChainIdToChainNamespace(chainId) {\n    if (typeof chainId === 'number') {\n      return CommonConstantsUtil.CHAIN.EVM;\n    }\n    const [namespace] = chainId.split(':');\n    return namespace;\n  },\n  /**\n   * Get all auth namespaces except the active one\n   * @param activeNamespace - The active namespace\n   * @returns All auth namespaces except the active one\n   */\n  getOtherAuthNamespaces(activeNamespace) {\n    if (!activeNamespace) {\n      return [];\n    }\n    const authNamespaces = CommonConstantsUtil.AUTH_CONNECTOR_SUPPORTED_CHAINS;\n    const otherAuthNamespaces = authNamespaces.filter(ns => ns !== activeNamespace);\n    return otherAuthNamespaces;\n  },\n  /**\n   * Gets the storage info for a connector\n   * @param connectorId - The ID of the connector\n   * @param namespace - The namespace of the connector\n   * @returns\n   */\n  getConnectorStorageInfo(connectorId, namespace) {\n    var _storageConnectionsBy;\n    const storageConnectionsByNamespace = StorageUtil.getConnections();\n    const storageConnections = (_storageConnectionsBy = storageConnectionsByNamespace[namespace]) !== null && _storageConnectionsBy !== void 0 ? _storageConnectionsBy : [];\n    return {\n      hasDisconnected: StorageUtil.isConnectorDisconnected(connectorId, namespace),\n      hasConnected: storageConnections.some(c => HelpersUtil.isLowerCaseMatch(c.connectorId, connectorId))\n    };\n  }\n};","map":{"version":3,"names":["ConstantsUtil","CommonConstantsUtil","ChainController","ConnectorController","StorageUtil","HelpersUtil","getCaipTokens","tokens","undefined","caipTokens","Object","entries","forEach","_ref","id","token","concat","EIP155","isLowerCaseMatch","str1","str2","toLowerCase","getActiveNamespaceConnectedToAuth","activeChain","state","AUTH_CONNECTOR_SUPPORTED_CHAINS","find","chain","getConnectorId","CONNECTOR_ID","AUTH","withRetry","_ref2","conditionFn","intervalMs","maxRetries","attempts","Promise","resolve","tryCheck","result","setTimeout","userChainIdToChainNamespace","chainId","CHAIN","EVM","namespace","split","getOtherAuthNamespaces","activeNamespace","authNamespaces","otherAuthNamespaces","filter","ns","getConnectorStorageInfo","connectorId","_storageConnectionsBy","storageConnectionsByNamespace","getConnections","storageConnections","hasDisconnected","isConnectorDisconnected","hasConnected","some","c"],"sources":["../../../src/HelpersUtil.ts"],"sourcesContent":[null],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}