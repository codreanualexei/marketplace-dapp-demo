{"ast":null,"code":"import { ConstantsUtil } from '@reown/appkit-common';\nimport { ChainController } from '../controllers/ChainController.js';\n/*\n * Exclude wallets that do not support relay connections but have custom deeplink mechanisms\n * Excludes:\n * - Phantom\n * - Coinbase\n */\nexport const CUSTOM_DEEPLINK_WALLETS = {\n  PHANTOM: {\n    id: 'a797aa35c0fadbfc1a53e7f675162ed5226968b44a19ee3d24385c64d1d3c393',\n    url: 'https://phantom.app'\n  },\n  SOLFLARE: {\n    id: '1ca0bdd4747578705b1939af023d120677c64fe6ca76add81fda36e350605e79',\n    url: 'https://solflare.com'\n  },\n  COINBASE: {\n    id: 'fd20dc426fb37566d803205b19bbc1d4096b248ac04548e3cfb6b3a38bd033aa',\n    url: 'https://go.cb-w.com'\n  },\n  /*\n   * Got details from their npm package:\n   * https://www.npmjs.com/package/@binance/w3w-utils?activeTab=code\n   * https://developers.binance.com/docs/binance-w3w/evm-compatible-provider#getdeeplink\n   */\n  BINANCE: {\n    id: '2fafea35bb471d22889ccb49c08d99dd0a18a37982602c33f696a5723934ba25',\n    appId: 'yFK5FCqYprrXDiVFbhyRx7',\n    deeplink: 'bnc://app.binance.com/mp/app',\n    url: 'https://app.binance.com/en/download'\n  }\n};\nexport const MobileWalletUtil = {\n  /**\n   * Handles mobile wallet redirection for wallets that have Universal Links and doesn't support WalletConnect Deep Links.\n   *\n   * @param {string} id - The id of the wallet.\n   * @param {ChainNamespace} namespace - The namespace of the chain.\n   */\n  handleMobileDeeplinkRedirect(id, namespace) {\n    /**\n     * Universal Links requires explicit user interaction to open the wallet app.\n     * Previously we've been calling this with the life-cycle methods in the Solana clients by listening the SELECT_WALLET event of EventController.\n     * But this breaks the UL functionality for some wallets like Phantom.\n     */\n    const href = window.location.href;\n    const encodedHref = encodeURIComponent(href);\n    if (id === CUSTOM_DEEPLINK_WALLETS.PHANTOM.id && !('phantom' in window)) {\n      const protocol = href.startsWith('https') ? 'https' : 'http';\n      const host = href.split('/')[2];\n      const encodedRef = encodeURIComponent(`${protocol}://${host}`);\n      window.location.href = `${CUSTOM_DEEPLINK_WALLETS.PHANTOM.url}/ul/browse/${encodedHref}?ref=${encodedRef}`;\n    }\n    if (id === CUSTOM_DEEPLINK_WALLETS.SOLFLARE.id && !('solflare' in window)) {\n      window.location.href = `${CUSTOM_DEEPLINK_WALLETS.SOLFLARE.url}/ul/v1/browse/${encodedHref}?ref=${encodedHref}`;\n    }\n    if (namespace === ConstantsUtil.CHAIN.SOLANA) {\n      if (id === CUSTOM_DEEPLINK_WALLETS.COINBASE.id && !('coinbaseSolana' in window)) {\n        window.location.href = `${CUSTOM_DEEPLINK_WALLETS.COINBASE.url}/dapp?cb_url=${encodedHref}`;\n      }\n    }\n    /*\n     * Binance Web3 Wallet doesn't support WalletConnect for Bitcoin.\n     * For now we use their deeplink to open the in-app browser instead.\n     */\n    if (namespace === ConstantsUtil.CHAIN.BITCOIN) {\n      if (id === CUSTOM_DEEPLINK_WALLETS.BINANCE.id && !('binancew3w' in window)) {\n        const activeCaipNetwork = ChainController.state.activeCaipNetwork;\n        const startPagePath = window.btoa('/pages/browser/index');\n        const startPageQuery = window.btoa(`url=${encodedHref}&defaultChainId=${activeCaipNetwork?.id ?? 1}`);\n        const deeplink = new URL(CUSTOM_DEEPLINK_WALLETS.BINANCE.deeplink);\n        deeplink.searchParams.set('appId', CUSTOM_DEEPLINK_WALLETS.BINANCE.appId);\n        deeplink.searchParams.set('startPagePath', startPagePath);\n        deeplink.searchParams.set('startPageQuery', startPageQuery);\n        const universalLink = new URL(CUSTOM_DEEPLINK_WALLETS.BINANCE.url);\n        universalLink.searchParams.set('_dp', window.btoa(deeplink.toString()));\n        window.location.href = universalLink.toString();\n      }\n    }\n  }\n};","map":{"version":3,"names":["ConstantsUtil","ChainController","CUSTOM_DEEPLINK_WALLETS","PHANTOM","id","url","SOLFLARE","COINBASE","BINANCE","appId","deeplink","MobileWalletUtil","handleMobileDeeplinkRedirect","namespace","href","window","location","encodedHref","encodeURIComponent","protocol","startsWith","host","split","encodedRef","CHAIN","SOLANA","BITCOIN","activeCaipNetwork","state","startPagePath","btoa","startPageQuery","URL","searchParams","set","universalLink","toString"],"sources":["../../../../src/utils/MobileWallet.ts"],"sourcesContent":[null],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}