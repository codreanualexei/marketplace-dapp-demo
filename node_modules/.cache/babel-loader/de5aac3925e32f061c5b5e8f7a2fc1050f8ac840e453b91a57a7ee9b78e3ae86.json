{"ast":null,"code":"var _jsxFileName = \"/Users/alex.codreanu/Desktop/marketplace-dapp/src/contexts/WalletContext.tsx\",\n  _s = $RefreshSig$(),\n  _s2 = $RefreshSig$();\nimport React, { createContext, useContext, useState, useEffect } from 'react';\nimport { ethers } from 'ethers';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst WalletContext = /*#__PURE__*/createContext(undefined);\nexport const useWallet = () => {\n  _s();\n  const context = useContext(WalletContext);\n  if (!context) {\n    throw new Error('useWallet must be used within a WalletProvider');\n  }\n  return context;\n};\n_s(useWallet, \"b9L3QQ+jgeyIrH0NfHrJ8nn7VMU=\");\nexport const WalletProvider = ({\n  children\n}) => {\n  _s2();\n  const [account, setAccount] = useState(null);\n  const [balance, setBalance] = useState(null);\n  const [chainId, setChainId] = useState(null);\n  const [provider, setProvider] = useState(null);\n  const [signer, setSigner] = useState(null);\n  const [isConnecting, setIsConnecting] = useState(false);\n  const [error, setError] = useState(null);\n  const updateBalance = async (address, provider) => {\n    try {\n      const balanceWei = await provider.getBalance(address);\n      const balanceEth = ethers.formatEther(balanceWei);\n      setBalance(parseFloat(balanceEth).toFixed(4));\n    } catch (err) {\n      console.error('Error fetching balance:', err);\n    }\n  };\n  const connectWallet = async () => {\n    if (typeof window.ethereum === 'undefined') {\n      setError('Please install MetaMask to use this dApp');\n      return;\n    }\n    setIsConnecting(true);\n    setError(null);\n    try {\n      const browserProvider = new ethers.BrowserProvider(window.ethereum);\n      const accounts = await browserProvider.send('eth_requestAccounts', []);\n      if (accounts.length === 0) {\n        throw new Error('No accounts found');\n      }\n      const userSigner = await browserProvider.getSigner();\n      const network = await browserProvider.getNetwork();\n      setProvider(browserProvider);\n      setSigner(userSigner);\n      setAccount(accounts[0]);\n      setChainId(Number(network.chainId));\n      await updateBalance(accounts[0], browserProvider);\n    } catch (err) {\n      console.error('Error connecting wallet:', err);\n      setError(err.message || 'Failed to connect wallet');\n    } finally {\n      setIsConnecting(false);\n    }\n  };\n  const disconnectWallet = () => {\n    setAccount(null);\n    setBalance(null);\n    setChainId(null);\n    setProvider(null);\n    setSigner(null);\n    setError(null);\n  };\n\n  // Listen for account changes\n  useEffect(() => {\n    if (typeof window.ethereum !== 'undefined') {\n      var _window$ethereum$on, _window$ethereum, _window$ethereum$on2, _window$ethereum2;\n      const handleAccountsChanged = accounts => {\n        if (accounts.length === 0) {\n          disconnectWallet();\n        } else if (accounts[0] !== account) {\n          setAccount(accounts[0]);\n          if (provider) {\n            updateBalance(accounts[0], provider);\n          }\n        }\n      };\n      const handleChainChanged = chainIdHex => {\n        setChainId(parseInt(chainIdHex, 16));\n        window.location.reload();\n      };\n      (_window$ethereum$on = (_window$ethereum = window.ethereum).on) === null || _window$ethereum$on === void 0 ? void 0 : _window$ethereum$on.call(_window$ethereum, 'accountsChanged', handleAccountsChanged);\n      (_window$ethereum$on2 = (_window$ethereum2 = window.ethereum).on) === null || _window$ethereum$on2 === void 0 ? void 0 : _window$ethereum$on2.call(_window$ethereum2, 'chainChanged', handleChainChanged);\n      return () => {\n        // Cleanup listeners if needed\n      };\n    }\n  }, [account, provider]);\n\n  // Auto-connect if previously connected\n  useEffect(() => {\n    const checkConnection = async () => {\n      if (typeof window.ethereum !== 'undefined') {\n        try {\n          const browserProvider = new ethers.BrowserProvider(window.ethereum);\n          const accounts = await browserProvider.send('eth_accounts', []);\n          if (accounts.length > 0) {\n            const userSigner = await browserProvider.getSigner();\n            const network = await browserProvider.getNetwork();\n            setProvider(browserProvider);\n            setSigner(userSigner);\n            setAccount(accounts[0]);\n            setChainId(Number(network.chainId));\n            await updateBalance(accounts[0], browserProvider);\n          }\n        } catch (err) {\n          console.error('Error checking connection:', err);\n        }\n      }\n    };\n    checkConnection();\n  }, []);\n  const value = {\n    account,\n    balance,\n    chainId,\n    provider,\n    signer,\n    connectWallet,\n    disconnectWallet,\n    isConnecting,\n    error\n  };\n  return /*#__PURE__*/_jsxDEV(WalletContext.Provider, {\n    value: value,\n    children: children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 160,\n    columnNumber: 10\n  }, this);\n};\n_s2(WalletProvider, \"knCu0tW9CXEPIegcXxI+jP/7dOk=\");\n_c = WalletProvider;\nvar _c;\n$RefreshReg$(_c, \"WalletProvider\");","map":{"version":3,"names":["React","createContext","useContext","useState","useEffect","ethers","jsxDEV","_jsxDEV","WalletContext","undefined","useWallet","_s","context","Error","WalletProvider","children","_s2","account","setAccount","balance","setBalance","chainId","setChainId","provider","setProvider","signer","setSigner","isConnecting","setIsConnecting","error","setError","updateBalance","address","balanceWei","getBalance","balanceEth","formatEther","parseFloat","toFixed","err","console","connectWallet","window","ethereum","browserProvider","BrowserProvider","accounts","send","length","userSigner","getSigner","network","getNetwork","Number","message","disconnectWallet","_window$ethereum$on","_window$ethereum","_window$ethereum$on2","_window$ethereum2","handleAccountsChanged","handleChainChanged","chainIdHex","parseInt","location","reload","on","call","checkConnection","value","Provider","fileName","_jsxFileName","lineNumber","columnNumber","_c","$RefreshReg$"],"sources":["/Users/alex.codreanu/Desktop/marketplace-dapp/src/contexts/WalletContext.tsx"],"sourcesContent":["import React, { createContext, useContext, useState, useEffect, ReactNode } from 'react';\nimport { ethers } from 'ethers';\n\ninterface WalletContextType {\n  account: string | null;\n  balance: string | null;\n  chainId: number | null;\n  provider: ethers.BrowserProvider | null;\n  signer: ethers.JsonRpcSigner | null;\n  connectWallet: () => Promise<void>;\n  disconnectWallet: () => void;\n  isConnecting: boolean;\n  error: string | null;\n}\n\nconst WalletContext = createContext<WalletContextType | undefined>(undefined);\n\nexport const useWallet = () => {\n  const context = useContext(WalletContext);\n  if (!context) {\n    throw new Error('useWallet must be used within a WalletProvider');\n  }\n  return context;\n};\n\ninterface WalletProviderProps {\n  children: ReactNode;\n}\n\nexport const WalletProvider: React.FC<WalletProviderProps> = ({ children }) => {\n  const [account, setAccount] = useState<string | null>(null);\n  const [balance, setBalance] = useState<string | null>(null);\n  const [chainId, setChainId] = useState<number | null>(null);\n  const [provider, setProvider] = useState<ethers.BrowserProvider | null>(null);\n  const [signer, setSigner] = useState<ethers.JsonRpcSigner | null>(null);\n  const [isConnecting, setIsConnecting] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n\n  const updateBalance = async (address: string, provider: ethers.BrowserProvider) => {\n    try {\n      const balanceWei = await provider.getBalance(address);\n      const balanceEth = ethers.formatEther(balanceWei);\n      setBalance(parseFloat(balanceEth).toFixed(4));\n    } catch (err) {\n      console.error('Error fetching balance:', err);\n    }\n  };\n\n  const connectWallet = async () => {\n    if (typeof window.ethereum === 'undefined') {\n      setError('Please install MetaMask to use this dApp');\n      return;\n    }\n\n    setIsConnecting(true);\n    setError(null);\n\n    try {\n      const browserProvider = new ethers.BrowserProvider(window.ethereum);\n      const accounts = await browserProvider.send('eth_requestAccounts', []);\n      \n      if (accounts.length === 0) {\n        throw new Error('No accounts found');\n      }\n\n      const userSigner = await browserProvider.getSigner();\n      const network = await browserProvider.getNetwork();\n      \n      setProvider(browserProvider);\n      setSigner(userSigner);\n      setAccount(accounts[0]);\n      setChainId(Number(network.chainId));\n      \n      await updateBalance(accounts[0], browserProvider);\n    } catch (err: any) {\n      console.error('Error connecting wallet:', err);\n      setError(err.message || 'Failed to connect wallet');\n    } finally {\n      setIsConnecting(false);\n    }\n  };\n\n  const disconnectWallet = () => {\n    setAccount(null);\n    setBalance(null);\n    setChainId(null);\n    setProvider(null);\n    setSigner(null);\n    setError(null);\n  };\n\n  // Listen for account changes\n  useEffect(() => {\n    if (typeof window.ethereum !== 'undefined') {\n      const handleAccountsChanged = (accounts: string[]) => {\n        if (accounts.length === 0) {\n          disconnectWallet();\n        } else if (accounts[0] !== account) {\n          setAccount(accounts[0]);\n          if (provider) {\n            updateBalance(accounts[0], provider);\n          }\n        }\n      };\n\n      const handleChainChanged = (chainIdHex: string) => {\n        setChainId(parseInt(chainIdHex, 16));\n        window.location.reload();\n      };\n\n      window.ethereum.on?.('accountsChanged', handleAccountsChanged);\n      window.ethereum.on?.('chainChanged', handleChainChanged);\n\n      return () => {\n        // Cleanup listeners if needed\n      };\n    }\n  }, [account, provider]);\n\n  // Auto-connect if previously connected\n  useEffect(() => {\n    const checkConnection = async () => {\n      if (typeof window.ethereum !== 'undefined') {\n        try {\n          const browserProvider = new ethers.BrowserProvider(window.ethereum);\n          const accounts = await browserProvider.send('eth_accounts', []);\n          \n          if (accounts.length > 0) {\n            const userSigner = await browserProvider.getSigner();\n            const network = await browserProvider.getNetwork();\n            \n            setProvider(browserProvider);\n            setSigner(userSigner);\n            setAccount(accounts[0]);\n            setChainId(Number(network.chainId));\n            \n            await updateBalance(accounts[0], browserProvider);\n          }\n        } catch (err) {\n          console.error('Error checking connection:', err);\n        }\n      }\n    };\n\n    checkConnection();\n  }, []);\n\n  const value: WalletContextType = {\n    account,\n    balance,\n    chainId,\n    provider,\n    signer,\n    connectWallet,\n    disconnectWallet,\n    isConnecting,\n    error,\n  };\n\n  return <WalletContext.Provider value={value}>{children}</WalletContext.Provider>;\n};\n\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}