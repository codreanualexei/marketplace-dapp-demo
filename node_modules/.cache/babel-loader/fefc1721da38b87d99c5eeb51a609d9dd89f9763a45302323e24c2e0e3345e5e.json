{"ast":null,"code":"import { TelemetryController } from '../controllers/TelemetryController.js';\nexport class AppKitError extends Error {\n  constructor(message, category, originalError) {\n    super(message);\n    this.originalName = 'AppKitError';\n    this.name = 'AppKitError';\n    this.category = category;\n    this.originalError = originalError;\n    if (originalError && originalError instanceof Error) {\n      this.originalName = originalError.name;\n    }\n    // Ensure `this instanceof AppKitError` is true, important for custom errors.\n    Object.setPrototypeOf(this, AppKitError.prototype);\n    let isStackConstructedFromOriginal = false;\n    if (originalError instanceof Error && typeof originalError.stack === 'string' && originalError.stack) {\n      const originalErrorStack = originalError.stack;\n      /**\n       * Most error stacks start with \"ErrorName: ErrorMessage\\n...frames...\"\n       * We want to take the \"...frames...\" part.\n       */\n      const firstNewlineIndex = originalErrorStack.indexOf('\\n');\n      if (firstNewlineIndex > -1) {\n        const originalFrames = originalErrorStack.substring(firstNewlineIndex + 1);\n        this.stack = `${this.name}: ${this.message}\\n${originalFrames}`;\n        isStackConstructedFromOriginal = true;\n      }\n    }\n    if (!isStackConstructedFromOriginal) {\n      /**\n       * If stack was not (or could not be) constructed from originalError,\n       * generate a standard stack trace for this AppKitError instance.\n       * This will point to where `new AppKitError()` was called.\n       */\n      if (Error.captureStackTrace) {\n        Error.captureStackTrace(this, AppKitError);\n      } else if (!this.stack) {\n        /**\n         * Fallback for environments without Error.captureStackTrace.\n         * `super(message)` might have set a stack.\n         * If `this.stack` is still undefined/empty, provide a minimal one.\n         * Node.js and modern browsers typically set `this.stack` from `super(message)`.\n         */\n        this.stack = `${this.name}: ${this.message}`;\n      }\n    }\n  }\n}\n// eslint-disable-next-line @typescript-eslint/no-explicit-any\nfunction errorHandler(err, defaultCategory) {\n  let errMessage = '';\n  try {\n    if (err instanceof Error) {\n      errMessage = err.message;\n    } else if (typeof err === 'string') {\n      errMessage = err;\n    } else if (typeof err === 'object' && err !== null) {\n      if (Object.keys(err).length === 0) {\n        errMessage = 'Unknown error';\n      } else {\n        errMessage = err?.message || JSON.stringify(err);\n      }\n    } else {\n      errMessage = String(err);\n    }\n  } catch (_error) {\n    errMessage = 'Unknown error';\n    // eslint-disable-next-line no-console\n    console.error('Error parsing error message', _error);\n  }\n  const error = err instanceof AppKitError ? err : new AppKitError(errMessage, defaultCategory, err);\n  TelemetryController.sendError(error, error.category);\n  throw error;\n}\nexport function withErrorBoundary(controller, defaultCategory = 'INTERNAL_SDK_ERROR') {\n  const newController = {};\n  Object.keys(controller).forEach(key => {\n    const original = controller[key];\n    if (typeof original === 'function') {\n      let wrapped = original;\n      if (original.constructor.name === 'AsyncFunction') {\n        wrapped = async (...args) => {\n          try {\n            return await original(...args);\n          } catch (err) {\n            return errorHandler(err, defaultCategory);\n          }\n        };\n      } else {\n        wrapped = (...args) => {\n          try {\n            return original(...args);\n          } catch (err) {\n            return errorHandler(err, defaultCategory);\n          }\n        };\n      }\n      newController[key] = wrapped;\n    } else {\n      newController[key] = original;\n    }\n  });\n  return newController;\n}","map":{"version":3,"names":["TelemetryController","AppKitError","Error","constructor","message","category","originalError","originalName","name","Object","setPrototypeOf","prototype","isStackConstructedFromOriginal","stack","originalErrorStack","firstNewlineIndex","indexOf","originalFrames","substring","captureStackTrace","errorHandler","err","defaultCategory","errMessage","keys","length","JSON","stringify","String","_error","console","error","sendError","withErrorBoundary","controller","newController","forEach","key","original","wrapped","args"],"sources":["../../../../src/utils/withErrorBoundary.ts"],"sourcesContent":[null],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}