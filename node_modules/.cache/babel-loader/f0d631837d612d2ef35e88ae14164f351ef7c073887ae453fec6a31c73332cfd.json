{"ast":null,"code":"var _s = $RefreshSig$();\nimport { useMemo } from 'react';\nimport { ethers } from 'ethers';\nimport { useWallet } from '../contexts/WalletContext';\nimport { MarketplaceSDK } from '../sdk/MarketplaceSDK';\n\n// CRA exposes only env vars prefixed with REACT_APP_\nconst MARKETPLACE_ADDRESS = process.env.REACT_APP_MARKETPLACE_ADDRESS || '';\n// Support both naming variants found in env/example\nconst NFT_ADDRESS = process.env.REACT_APP_STR_DOMAIN_NFT_COLLECTION || process.env.REACT_APP_NFT_COLLECTION_ADDRESS || '';\nconst IS_DEV = process.env.NODE_ENV === 'development';\n\n/**\n * Custom hook to access the Marketplace SDK\n * Returns null if wallet is not connected\n */\nexport const useMarketplaceSDK = () => {\n  _s();\n  const {\n    signer,\n    provider,\n    account,\n    walletType\n  } = useWallet();\n  const sdk = useMemo(() => {\n    if (!MARKETPLACE_ADDRESS || !NFT_ADDRESS) {\n      if (process.env.NODE_ENV === 'development') {\n        console.warn('Missing marketplace/NFT env addresses', {\n          REACT_APP_MARKETPLACE_ADDRESS: process.env.REACT_APP_MARKETPLACE_ADDRESS,\n          REACT_APP_STR_DOMAIN_NFT_COLLECTION: process.env.REACT_APP_STR_DOMAIN_NFT_COLLECTION,\n          REACT_APP_NFT_COLLECTION_ADDRESS: process.env.REACT_APP_NFT_COLLECTION_ADDRESS\n        });\n      }\n      return null;\n    }\n    try {\n      // Only create SDK if we have a valid signer and account\n      if (signer && account && provider) {\n        console.log('Creating Marketplace SDK with:', {\n          walletType,\n          account,\n          hasSigner: !!signer,\n          hasProvider: !!provider\n        });\n        return new MarketplaceSDK(signer, MARKETPLACE_ADDRESS, NFT_ADDRESS, IS_DEV);\n      }\n\n      // Read-only fallback using RPC URL if available (for when wallet is not connected)\n      const rpcUrl = process.env.REACT_APP_RPC_URL;\n      if (rpcUrl) {\n        console.log('Creating read-only Marketplace SDK with RPC provider');\n        const provider = new ethers.JsonRpcProvider(rpcUrl);\n        // Create a dummy wallet connected to provider; avoids provider.getSigner() which throws on public RPC\n        const readOnlySigner = ethers.Wallet.createRandom().connect(provider);\n        const sdk = new MarketplaceSDK(readOnlySigner, MARKETPLACE_ADDRESS, NFT_ADDRESS, IS_DEV);\n        // Disable develop mode for read-only SDK to reduce console spam\n        sdk.setDevelopMode(false);\n        return sdk;\n      }\n      console.log('No valid signer or RPC URL available for Marketplace SDK');\n      return null;\n    } catch (error) {\n      console.error('Error creating Marketplace SDK:', error);\n      return null;\n    }\n  }, [signer, provider, account, walletType]);\n  return sdk;\n};\n_s(useMarketplaceSDK, \"kYgRmNNgH8VAhUWvUgd6Dj6rvgs=\", false, function () {\n  return [useWallet];\n});\nexport default useMarketplaceSDK;","map":{"version":3,"names":["useMemo","ethers","useWallet","MarketplaceSDK","MARKETPLACE_ADDRESS","process","env","REACT_APP_MARKETPLACE_ADDRESS","NFT_ADDRESS","REACT_APP_STR_DOMAIN_NFT_COLLECTION","REACT_APP_NFT_COLLECTION_ADDRESS","IS_DEV","NODE_ENV","useMarketplaceSDK","_s","signer","provider","account","walletType","sdk","console","warn","log","hasSigner","hasProvider","rpcUrl","REACT_APP_RPC_URL","JsonRpcProvider","readOnlySigner","Wallet","createRandom","connect","setDevelopMode","error"],"sources":["/Users/alex.codreanu/Desktop/marketplace-dapp/src/hooks/useMarketplaceSDK.ts"],"sourcesContent":["import { useMemo } from 'react';\nimport { ethers } from 'ethers';\nimport { useWallet } from '../contexts/WalletContext';\nimport { MarketplaceSDK } from '../sdk/MarketplaceSDK';\n\n// CRA exposes only env vars prefixed with REACT_APP_\nconst MARKETPLACE_ADDRESS = process.env.REACT_APP_MARKETPLACE_ADDRESS || '';\n// Support both naming variants found in env/example\nconst NFT_ADDRESS =\n  process.env.REACT_APP_STR_DOMAIN_NFT_COLLECTION ||\n  process.env.REACT_APP_NFT_COLLECTION_ADDRESS ||\n  '';\nconst IS_DEV = process.env.NODE_ENV === 'development';\n\n\n\n/**\n * Custom hook to access the Marketplace SDK\n * Returns null if wallet is not connected\n */\nexport const useMarketplaceSDK = (): MarketplaceSDK | null => {\n  const { signer, provider, account, walletType } = useWallet();\n\n  const sdk = useMemo(() => {\n    if (!MARKETPLACE_ADDRESS || !NFT_ADDRESS) {\n      if (process.env.NODE_ENV === 'development') {\n        console.warn(\n          'Missing marketplace/NFT env addresses',\n          {\n            REACT_APP_MARKETPLACE_ADDRESS: process.env.REACT_APP_MARKETPLACE_ADDRESS,\n            REACT_APP_STR_DOMAIN_NFT_COLLECTION: process.env.REACT_APP_STR_DOMAIN_NFT_COLLECTION,\n            REACT_APP_NFT_COLLECTION_ADDRESS: process.env.REACT_APP_NFT_COLLECTION_ADDRESS,\n          }\n        );\n      }\n      return null;\n    }\n\n    try {\n      // Only create SDK if we have a valid signer and account\n      if (signer && account && provider) {\n        console.log('Creating Marketplace SDK with:', {\n          walletType,\n          account,\n          hasSigner: !!signer,\n          hasProvider: !!provider\n        });\n        return new MarketplaceSDK(signer, MARKETPLACE_ADDRESS, NFT_ADDRESS, IS_DEV);\n      }\n\n      // Read-only fallback using RPC URL if available (for when wallet is not connected)\n      const rpcUrl = process.env.REACT_APP_RPC_URL;\n      if (rpcUrl) {\n        console.log('Creating read-only Marketplace SDK with RPC provider');\n        const provider = new ethers.JsonRpcProvider(rpcUrl);\n        // Create a dummy wallet connected to provider; avoids provider.getSigner() which throws on public RPC\n        const readOnlySigner = ethers.Wallet.createRandom().connect(provider);\n        const sdk = new MarketplaceSDK(readOnlySigner, MARKETPLACE_ADDRESS, NFT_ADDRESS, IS_DEV);\n        // Disable develop mode for read-only SDK to reduce console spam\n        sdk.setDevelopMode(false);\n        return sdk;\n      }\n\n      console.log('No valid signer or RPC URL available for Marketplace SDK');\n      return null;\n    } catch (error) {\n      console.error('Error creating Marketplace SDK:', error);\n      return null;\n    }\n  }, [signer, provider, account, walletType]);\n\n  return sdk;\n};\n\nexport default useMarketplaceSDK;\n\n"],"mappings":";AAAA,SAASA,OAAO,QAAQ,OAAO;AAC/B,SAASC,MAAM,QAAQ,QAAQ;AAC/B,SAASC,SAAS,QAAQ,2BAA2B;AACrD,SAASC,cAAc,QAAQ,uBAAuB;;AAEtD;AACA,MAAMC,mBAAmB,GAAGC,OAAO,CAACC,GAAG,CAACC,6BAA6B,IAAI,EAAE;AAC3E;AACA,MAAMC,WAAW,GACfH,OAAO,CAACC,GAAG,CAACG,mCAAmC,IAC/CJ,OAAO,CAACC,GAAG,CAACI,gCAAgC,IAC5C,EAAE;AACJ,MAAMC,MAAM,GAAGN,OAAO,CAACC,GAAG,CAACM,QAAQ,KAAK,aAAa;;AAIrD;AACA;AACA;AACA;AACA,OAAO,MAAMC,iBAAiB,GAAGA,CAAA,KAA6B;EAAAC,EAAA;EAC5D,MAAM;IAAEC,MAAM;IAAEC,QAAQ;IAAEC,OAAO;IAAEC;EAAW,CAAC,GAAGhB,SAAS,CAAC,CAAC;EAE7D,MAAMiB,GAAG,GAAGnB,OAAO,CAAC,MAAM;IACxB,IAAI,CAACI,mBAAmB,IAAI,CAACI,WAAW,EAAE;MACxC,IAAIH,OAAO,CAACC,GAAG,CAACM,QAAQ,KAAK,aAAa,EAAE;QAC1CQ,OAAO,CAACC,IAAI,CACV,uCAAuC,EACvC;UACEd,6BAA6B,EAAEF,OAAO,CAACC,GAAG,CAACC,6BAA6B;UACxEE,mCAAmC,EAAEJ,OAAO,CAACC,GAAG,CAACG,mCAAmC;UACpFC,gCAAgC,EAAEL,OAAO,CAACC,GAAG,CAACI;QAChD,CACF,CAAC;MACH;MACA,OAAO,IAAI;IACb;IAEA,IAAI;MACF;MACA,IAAIK,MAAM,IAAIE,OAAO,IAAID,QAAQ,EAAE;QACjCI,OAAO,CAACE,GAAG,CAAC,gCAAgC,EAAE;UAC5CJ,UAAU;UACVD,OAAO;UACPM,SAAS,EAAE,CAAC,CAACR,MAAM;UACnBS,WAAW,EAAE,CAAC,CAACR;QACjB,CAAC,CAAC;QACF,OAAO,IAAIb,cAAc,CAACY,MAAM,EAAEX,mBAAmB,EAAEI,WAAW,EAAEG,MAAM,CAAC;MAC7E;;MAEA;MACA,MAAMc,MAAM,GAAGpB,OAAO,CAACC,GAAG,CAACoB,iBAAiB;MAC5C,IAAID,MAAM,EAAE;QACVL,OAAO,CAACE,GAAG,CAAC,sDAAsD,CAAC;QACnE,MAAMN,QAAQ,GAAG,IAAIf,MAAM,CAAC0B,eAAe,CAACF,MAAM,CAAC;QACnD;QACA,MAAMG,cAAc,GAAG3B,MAAM,CAAC4B,MAAM,CAACC,YAAY,CAAC,CAAC,CAACC,OAAO,CAACf,QAAQ,CAAC;QACrE,MAAMG,GAAG,GAAG,IAAIhB,cAAc,CAACyB,cAAc,EAAExB,mBAAmB,EAAEI,WAAW,EAAEG,MAAM,CAAC;QACxF;QACAQ,GAAG,CAACa,cAAc,CAAC,KAAK,CAAC;QACzB,OAAOb,GAAG;MACZ;MAEAC,OAAO,CAACE,GAAG,CAAC,0DAA0D,CAAC;MACvE,OAAO,IAAI;IACb,CAAC,CAAC,OAAOW,KAAK,EAAE;MACdb,OAAO,CAACa,KAAK,CAAC,iCAAiC,EAAEA,KAAK,CAAC;MACvD,OAAO,IAAI;IACb;EACF,CAAC,EAAE,CAAClB,MAAM,EAAEC,QAAQ,EAAEC,OAAO,EAAEC,UAAU,CAAC,CAAC;EAE3C,OAAOC,GAAG;AACZ,CAAC;AAACL,EAAA,CApDWD,iBAAiB;EAAA,QACsBX,SAAS;AAAA;AAqD7D,eAAeW,iBAAiB","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}