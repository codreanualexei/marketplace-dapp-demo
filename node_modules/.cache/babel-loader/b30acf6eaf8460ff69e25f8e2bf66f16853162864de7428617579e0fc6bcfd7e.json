{"ast":null,"code":"//\nimport { ConstantsUtil, SafeLocalStorage, SafeLocalStorageKeys } from '@reown/appkit-common';\nimport { ApiController } from '../../controllers/ApiController.js';\nimport { BlockchainApiController } from '../../controllers/BlockchainApiController.js';\nimport { ChainController } from '../../controllers/ChainController.js';\nimport { getActiveCaipNetwork } from '../../utils/ChainControllerUtil.js';\nimport { ReownAuthenticationMessenger } from './ReownAuthenticationMessenger.js';\n/**\n * This is the configuration for using SIWX with Reown Authentication service.\n * It allows you to authenticate and capture user sessions through the Cloud Dashboard.\n */\nexport class ReownAuthentication {\n  constructor(params = {}) {\n    this.otpUuid = null;\n    this.listeners = {\n      sessionChanged: []\n    };\n    this.localAuthStorageKey = params.localAuthStorageKey || SafeLocalStorageKeys.SIWX_AUTH_TOKEN;\n    this.localNonceStorageKey = params.localNonceStorageKey || SafeLocalStorageKeys.SIWX_NONCE_TOKEN;\n    this.required = params.required ?? true;\n    this.messenger = new ReownAuthenticationMessenger({\n      getNonce: this.getNonce.bind(this)\n    });\n  }\n  async createMessage(input) {\n    return this.messenger.createMessage(input);\n  }\n  async addSession(session) {\n    const response = await this.request({\n      method: 'POST',\n      key: 'authenticate',\n      body: {\n        data: session.data,\n        message: session.message,\n        signature: session.signature,\n        clientId: this.getClientId(),\n        walletInfo: this.getWalletInfo()\n      },\n      headers: ['nonce', 'otp']\n    });\n    this.setStorageToken(response.token, this.localAuthStorageKey);\n    this.emit('sessionChanged', session);\n    this.setAppKitAccountUser(jwtDecode(response.token));\n    this.otpUuid = null;\n  }\n  async getSessions(chainId, address) {\n    try {\n      if (!this.getStorageToken(this.localAuthStorageKey)) {\n        return [];\n      }\n      const account = await this.request({\n        method: 'GET',\n        key: 'me',\n        query: {},\n        headers: ['auth']\n      });\n      if (!account) {\n        return [];\n      }\n      const isSameAddress = account.address.toLowerCase() === address.toLowerCase();\n      const isSameNetwork = account.caip2Network === chainId;\n      if (!isSameAddress || !isSameNetwork) {\n        return [];\n      }\n      const session = {\n        data: {\n          accountAddress: account.address,\n          chainId: account.caip2Network\n        },\n        message: '',\n        signature: ''\n      };\n      this.emit('sessionChanged', session);\n      this.setAppKitAccountUser(account);\n      return [session];\n    } catch {\n      return [];\n    }\n  }\n  async revokeSession(_chainId, _address) {\n    return Promise.resolve(this.clearStorageTokens());\n  }\n  async setSessions(sessions) {\n    if (sessions.length === 0) {\n      this.clearStorageTokens();\n    } else {\n      const session = sessions.find(s => s.data.chainId === getActiveCaipNetwork()?.caipNetworkId) || sessions[0];\n      await this.addSession(session);\n    }\n  }\n  getRequired() {\n    return this.required;\n  }\n  async getSessionAccount() {\n    if (!this.getStorageToken(this.localAuthStorageKey)) {\n      throw new Error('Not authenticated');\n    }\n    return this.request({\n      method: 'GET',\n      key: 'me',\n      body: undefined,\n      query: {\n        includeAppKitAccount: true\n      },\n      headers: ['auth']\n    });\n  }\n  async setSessionAccountMetadata(metadata = null) {\n    if (!this.getStorageToken(this.localAuthStorageKey)) {\n      throw new Error('Not authenticated');\n    }\n    return this.request({\n      method: 'PUT',\n      key: 'account-metadata',\n      body: {\n        metadata\n      },\n      headers: ['auth']\n    });\n  }\n  on(event, callback) {\n    this.listeners[event].push(callback);\n    return () => {\n      this.listeners[event] = this.listeners[event].filter(cb => cb !== callback);\n    };\n  }\n  removeAllListeners() {\n    const keys = Object.keys(this.listeners);\n    keys.forEach(key => {\n      this.listeners[key] = [];\n    });\n  }\n  async requestEmailOtp({\n    email,\n    account\n  }) {\n    const otp = await this.request({\n      method: 'POST',\n      key: 'otp',\n      body: {\n        email,\n        account\n      }\n    });\n    this.otpUuid = otp.uuid;\n    this.messenger.resources = [`email:${email}`];\n    return otp;\n  }\n  confirmEmailOtp({\n    code\n  }) {\n    return this.request({\n      method: 'PUT',\n      key: 'otp',\n      body: {\n        code\n      },\n      headers: ['otp']\n    });\n  }\n  async request({\n    method,\n    key,\n    query,\n    body,\n    headers\n  }) {\n    const {\n      projectId,\n      st,\n      sv\n    } = this.getSDKProperties();\n    const url = new URL(`${ConstantsUtil.W3M_API_URL}/auth/v1/${String(key)}`);\n    url.searchParams.set('projectId', projectId);\n    url.searchParams.set('st', st);\n    url.searchParams.set('sv', sv);\n    if (query) {\n      Object.entries(query).forEach(([queryKey, queryValue]) => url.searchParams.set(queryKey, String(queryValue)));\n    }\n    const response = await fetch(url, {\n      method,\n      body: body ? JSON.stringify(body) : undefined,\n      headers: Array.isArray(headers) ? headers.reduce((acc, header) => {\n        switch (header) {\n          case 'nonce':\n            acc['x-nonce-jwt'] = `Bearer ${this.getStorageToken(this.localNonceStorageKey)}`;\n            break;\n          case 'auth':\n            acc['Authorization'] = `Bearer ${this.getStorageToken(this.localAuthStorageKey)}`;\n            break;\n          case 'otp':\n            if (this.otpUuid) {\n              acc['x-otp'] = this.otpUuid;\n            }\n            break;\n          default:\n            break;\n        }\n        return acc;\n      }, {}) : undefined\n    });\n    if (!response.ok) {\n      throw new Error(await response.text());\n    }\n    if (response.headers.get('content-type')?.includes('application/json')) {\n      return response.json();\n    }\n    return null;\n  }\n  getStorageToken(key) {\n    return SafeLocalStorage.getItem(key);\n  }\n  setStorageToken(token, key) {\n    SafeLocalStorage.setItem(key, token);\n  }\n  clearStorageTokens() {\n    this.otpUuid = null;\n    SafeLocalStorage.removeItem(this.localAuthStorageKey);\n    SafeLocalStorage.removeItem(this.localNonceStorageKey);\n    this.emit('sessionChanged', undefined);\n  }\n  async getNonce() {\n    const {\n      nonce,\n      token\n    } = await this.request({\n      method: 'GET',\n      key: 'nonce'\n    });\n    this.setStorageToken(token, this.localNonceStorageKey);\n    return nonce;\n  }\n  getClientId() {\n    return BlockchainApiController.state.clientId;\n  }\n  getWalletInfo() {\n    const walletInfo = ChainController.getAccountData()?.connectedWalletInfo;\n    if (!walletInfo) {\n      return undefined;\n    }\n    if ('social' in walletInfo && 'identifier' in walletInfo) {\n      const social = walletInfo['social'];\n      const identifier = walletInfo['identifier'];\n      return {\n        type: 'social',\n        social,\n        identifier\n      };\n    }\n    const {\n      name,\n      icon\n    } = walletInfo;\n    let type = 'unknown';\n    switch (walletInfo.type) {\n      case 'EXTERNAL':\n      case 'INJECTED':\n      case 'ANNOUNCED':\n        type = 'extension';\n        break;\n      case 'WALLET_CONNECT':\n        type = 'walletconnect';\n        break;\n      default:\n        type = 'unknown';\n    }\n    return {\n      type,\n      name,\n      icon\n    };\n  }\n  getSDKProperties() {\n    return ApiController._getSdkProperties();\n  }\n  emit(event, data) {\n    this.listeners[event].forEach(listener => listener(data));\n  }\n  setAppKitAccountUser(session) {\n    const {\n      email\n    } = session;\n    if (email) {\n      Object.values(ConstantsUtil.CHAIN).forEach(chainNamespace => {\n        ChainController.setAccountProp('user', {\n          email\n        }, chainNamespace);\n      });\n    }\n  }\n}\n/**\n * Decodes a JWT token and returns its payload\n * @param token - The JWT token to decode\n * @returns The decoded payload or null if invalid\n */\nfunction jwtDecode(token) {\n  // Split the token into parts\n  const parts = token.split('.');\n  // Check if the token has the correct format (header.payload.signature)\n  if (parts.length !== 3) {\n    throw new Error('Invalid token');\n  }\n  // Decode the payload (second part)\n  const payload = parts[1];\n  if (typeof payload !== 'string') {\n    throw new Error('Invalid token');\n  }\n  // Convert base64url to base64\n  const base64 = payload.replace(/-/gu, '+').replace(/_/gu, '/');\n  // Add padding if needed\n  const padded = base64.padEnd(base64.length + (4 - base64.length % 4) % 4, '=');\n  // Decode and parse the JSON\n  const decoded = JSON.parse(atob(padded));\n  return decoded;\n}","map":{"version":3,"names":["ConstantsUtil","SafeLocalStorage","SafeLocalStorageKeys","ApiController","BlockchainApiController","ChainController","getActiveCaipNetwork","ReownAuthenticationMessenger","ReownAuthentication","constructor","params","otpUuid","listeners","sessionChanged","localAuthStorageKey","SIWX_AUTH_TOKEN","localNonceStorageKey","SIWX_NONCE_TOKEN","required","messenger","getNonce","bind","createMessage","input","addSession","session","response","request","method","key","body","data","message","signature","clientId","getClientId","walletInfo","getWalletInfo","headers","setStorageToken","token","emit","setAppKitAccountUser","jwtDecode","getSessions","chainId","address","getStorageToken","account","query","isSameAddress","toLowerCase","isSameNetwork","caip2Network","accountAddress","revokeSession","_chainId","_address","Promise","resolve","clearStorageTokens","setSessions","sessions","length","find","s","caipNetworkId","getRequired","getSessionAccount","Error","undefined","includeAppKitAccount","setSessionAccountMetadata","metadata","on","event","callback","push","filter","cb","removeAllListeners","keys","Object","forEach","requestEmailOtp","email","otp","uuid","resources","confirmEmailOtp","code","projectId","st","sv","getSDKProperties","url","URL","W3M_API_URL","String","searchParams","set","entries","queryKey","queryValue","fetch","JSON","stringify","Array","isArray","reduce","acc","header","ok","text","get","includes","json","getItem","setItem","removeItem","nonce","state","getAccountData","connectedWalletInfo","social","identifier","type","name","icon","_getSdkProperties","listener","values","CHAIN","chainNamespace","setAccountProp","parts","split","payload","base64","replace","padded","padEnd","decoded","parse","atob"],"sources":["../../../../../src/features/reown-authentication/ReownAuthentication.ts"],"sourcesContent":[null],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}